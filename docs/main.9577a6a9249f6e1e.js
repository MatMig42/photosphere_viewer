"use strict";(self.webpackChunksandbox=self.webpackChunksandbox||[]).push([[179],{988:()=>{function vt(n){return"function"==typeof n}function Xl(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const Mh=Xl(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function ja(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class ni{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(vt(i))try{i()}catch(s){e=s instanceof Mh?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{Kx(s)}catch(o){e=e??[],o instanceof Mh?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Mh(e)}}add(e){var t;if(e&&e!==this)if(this.closed)Kx(e);else{if(e instanceof ni){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&ja(t,e)}remove(e){const{_finalizers:t}=this;t&&ja(t,e),e instanceof ni&&e._removeParent(this)}}ni.EMPTY=(()=>{const n=new ni;return n.closed=!0,n})();const Yx=ni.EMPTY;function Zx(n){return n instanceof ni||n&&"closed"in n&&vt(n.remove)&&vt(n.add)&&vt(n.unsubscribe)}function Kx(n){vt(n)?n():n.unsubscribe()}const Vo={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Eh={setTimeout(n,e,...t){const{delegate:i}=Eh;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=Eh;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Jx(n){Eh.setTimeout(()=>{const{onUnhandledError:e}=Vo;if(!e)throw n;e(n)})}function qg(){}const ak=Xg("C",void 0,void 0);function Xg(n,e,t){return{kind:n,value:e,error:t}}let zo=null;function Sh(n){if(Vo.useDeprecatedSynchronousErrorHandling){const e=!zo;if(e&&(zo={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=zo;if(zo=null,t)throw i}}else n()}class Yg extends ni{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Zx(e)&&e.add(this)):this.destination=pk}static create(e,t,i){return new Yl(e,t,i)}next(e){this.isStopped?Kg(function lk(n){return Xg("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?Kg(function ck(n){return Xg("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Kg(ak,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const dk=Function.prototype.bind;function Zg(n,e){return dk.call(n,e)}class hk{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Th(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Th(i)}else Th(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Th(t)}}}class Yl extends Yg{constructor(e,t,i){let r;if(super(),vt(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&Vo.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&Zg(e.next,s),error:e.error&&Zg(e.error,s),complete:e.complete&&Zg(e.complete,s)}):r=e}this.destination=new hk(r)}}function Th(n){Vo.useDeprecatedSynchronousErrorHandling?function uk(n){Vo.useDeprecatedSynchronousErrorHandling&&zo&&(zo.errorThrown=!0,zo.error=n)}(n):Jx(n)}function Kg(n,e){const{onStoppedNotification:t}=Vo;t&&Eh.setTimeout(()=>t(n,e))}const pk={closed:!0,next:qg,error:function fk(n){throw n},complete:qg},Jg="function"==typeof Symbol&&Symbol.observable||"@@observable";function Js(n){return n}function Qx(n){return 0===n.length?Js:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let Nt=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function _k(n){return n&&n instanceof Yg||function gk(n){return n&&vt(n.next)&&vt(n.error)&&vt(n.complete)}(n)&&Zx(n)}(t)?t:new Yl(t,i,r);return Sh(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=eM(i))((r,s)=>{const o=new Yl({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[Jg](){return this}pipe(...t){return Qx(t)(this)}toPromise(t){return new(t=eM(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function eM(n){var e;return null!==(e=n??Vo.Promise)&&void 0!==e?e:Promise}const vk=Xl(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Kt=(()=>{class n extends Nt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new tM(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new vk}next(t){Sh(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){Sh(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Sh(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?Yx:(this.currentObservers=null,s.push(t),new ni(()=>{this.currentObservers=null,ja(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new Nt;return t.source=this,t}}return n.create=(e,t)=>new tM(e,t),n})();class tM extends Kt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:Yx}}function nM(n){return vt(n?.lift)}function sn(n){return e=>{if(nM(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Gt(n,e,t,i,r){return new yk(n,e,t,i,r)}class yk extends Yg{constructor(e,t,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=r?function(a){try{r(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function ut(n,e){return sn((t,i)=>{let r=0;t.subscribe(Gt(i,s=>{i.next(n.call(e,s,r++))}))})}function Qs(n){return this instanceof Qs?(this.v=n,this):new Qs(n)}function oM(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function n_(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){!function r(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}(a,c,(o=n[s](o)).done,o.value)})}}}const i_=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function aM(n){return vt(n?.then)}function cM(n){return vt(n[Jg])}function lM(n){return Symbol.asyncIterator&&vt(n?.[Symbol.asyncIterator])}function uM(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const dM=function Uk(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function hM(n){return vt(n?.[dM])}function fM(n){return function sM(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(h){i[h]&&(r[h]=function(f){return new Promise(function(p,_){s.push([h,f,p,_])>1||a(h,f)})})}function a(h,f){try{!function c(h){h.value instanceof Qs?Promise.resolve(h.value.v).then(l,u):d(s[0][2],h)}(i[h](f))}catch(p){d(s[0][3],p)}}function l(h){a("next",h)}function u(h){a("throw",h)}function d(h,f){h(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield Qs(t.read());if(r)return yield Qs(void 0);yield yield Qs(i)}}finally{t.releaseLock()}})}function pM(n){return vt(n?.getReader)}function ii(n){if(n instanceof Nt)return n;if(null!=n){if(cM(n))return function Bk(n){return new Nt(e=>{const t=n[Jg]();if(vt(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(i_(n))return function Vk(n){return new Nt(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(aM(n))return function zk(n){return new Nt(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Jx)})}(n);if(lM(n))return mM(n);if(hM(n))return function Hk(n){return new Nt(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(pM(n))return function Gk(n){return mM(fM(n))}(n)}throw uM(n)}function mM(n){return new Nt(e=>{(function Wk(n,e){var t,i,r,s;return function iM(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{l(i.next(u))}catch(d){o(d)}}function c(u){try{l(i.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,c)}l((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=oM(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function us(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function Rn(n,e,t=1/0){return vt(e)?Rn((i,r)=>ut((s,o)=>e(i,s,r,o))(ii(n(i,r))),t):("number"==typeof e&&(t=e),sn((i,r)=>function jk(n,e,t,i,r,s,o,a){const c=[];let l=0,u=0,d=!1;const h=()=>{d&&!c.length&&!l&&e.complete()},f=_=>l<i?p(_):c.push(_),p=_=>{s&&e.next(_),l++;let g=!1;ii(t(_,u++)).subscribe(Gt(e,m=>{r?.(m),s?f(m):e.next(m)},()=>{g=!0},void 0,()=>{if(g)try{for(l--;c.length&&l<i;){const m=c.shift();o?us(e,o,()=>p(m)):p(m)}h()}catch(m){e.error(m)}}))};return n.subscribe(Gt(e,f,()=>{d=!0,h()})),()=>{a?.()}}(i,r,n,t)))}function $a(n=1/0){return Rn(Js,n)}const Nr=new Nt(n=>n.complete());function gM(n){return n&&vt(n.schedule)}function r_(n){return n[n.length-1]}function _M(n){return vt(r_(n))?n.pop():void 0}function Zl(n){return gM(r_(n))?n.pop():void 0}function vM(n,e=0){return sn((t,i)=>{t.subscribe(Gt(i,r=>us(i,n,()=>i.next(r),e),()=>us(i,n,()=>i.complete(),e),r=>us(i,n,()=>i.error(r),e)))})}function yM(n,e=0){return sn((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function bM(n,e){if(!n)throw new Error("Iterable cannot be null");return new Nt(t=>{us(t,e,()=>{const i=n[Symbol.asyncIterator]();us(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function Pn(n,e){return e?function Qk(n,e){if(null!=n){if(cM(n))return function Xk(n,e){return ii(n).pipe(yM(e),vM(e))}(n,e);if(i_(n))return function Zk(n,e){return new Nt(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(aM(n))return function Yk(n,e){return ii(n).pipe(yM(e),vM(e))}(n,e);if(lM(n))return bM(n,e);if(hM(n))return function Kk(n,e){return new Nt(t=>{let i;return us(t,e,()=>{i=n[dM](),us(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>vt(i?.return)&&i.return()})}(n,e);if(pM(n))return function Jk(n,e){return bM(fM(n),e)}(n,e)}throw uM(n)}(n,e):ii(n)}function wM(...n){const e=Zl(n),t=function qk(n,e){return"number"==typeof r_(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?ii(i[0]):$a(t)(Pn(i,e)):Nr}function xM(n={}){const{connector:e=(()=>new Kt),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let o,a,c,l=0,u=!1,d=!1;const h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=c=void 0,u=d=!1},p=()=>{const _=o;f(),_?.unsubscribe()};return sn((_,g)=>{l++,!d&&!u&&h();const m=c=c??e();g.add(()=>{l--,0===l&&!d&&!u&&(a=s_(p,r))}),m.subscribe(g),!o&&l>0&&(o=new Yl({next:y=>m.next(y),error:y=>{d=!0,h(),a=s_(f,t,y),m.error(y)},complete:()=>{u=!0,h(),a=s_(f,i),m.complete()}}),ii(_).subscribe(o))})(s)}}function s_(n,e,...t){if(!0===e)return void n();if(!1===e)return;const i=new Yl({next:()=>{i.unsubscribe(),n()}});return ii(e(...t)).subscribe(i)}function At(n){for(let e in n)if(n[e]===At)return e;throw Error("Could not find renamed property on target object.")}function o_(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function xn(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(xn).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function a_(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const eU=At({__forward_ref__:At});function Kl(n){return n.__forward_ref__=Kl,n.toString=function(){return xn(this())},n}function qe(n){return c_(n)?n():n}function c_(n){return"function"==typeof n&&n.hasOwnProperty(eU)&&n.__forward_ref__===Kl}function l_(n){return n&&!!n.\u0275providers}const MM="https://g.co/ng/security#xss";class J extends Error{constructor(e,t){super(function Ch(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function Ye(n){return"string"==typeof n?n:null==n?"":String(n)}function Ah(n,e){throw new J(-201,!1)}function Ki(n,e){null==n&&function Tt(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function xe(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function zn(n){return{providers:n.providers||[],imports:n.imports||[]}}function Dh(n){return EM(n,Ih)||EM(n,TM)}function EM(n,e){return n.hasOwnProperty(e)?n[e]:null}function SM(n){return n&&(n.hasOwnProperty(u_)||n.hasOwnProperty(cU))?n[u_]:null}const Ih=At({\u0275prov:At}),u_=At({\u0275inj:At}),TM=At({ngInjectableDef:At}),cU=At({ngInjectorDef:At});var Ge=(()=>((Ge=Ge||{})[Ge.Default=0]="Default",Ge[Ge.Host=1]="Host",Ge[Ge.Self=2]="Self",Ge[Ge.SkipSelf=4]="SkipSelf",Ge[Ge.Optional=8]="Optional",Ge))();let d_;function pi(n){const e=d_;return d_=n,e}function AM(n,e,t){const i=Dh(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&Ge.Optional?null:void 0!==e?e:void Ah(xn(n))}const Ot=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Jl={},h_="__NG_DI_FLAG__",Rh="ngTempTokenPath",uU=/\n/gm,DM="__source";let qa;function to(n){const e=qa;return qa=n,e}function fU(n,e=Ge.Default){if(void 0===qa)throw new J(-203,!1);return null===qa?AM(n,void 0,e):qa.get(n,e&Ge.Optional?null:void 0,e)}function re(n,e=Ge.Default){return(function CM(){return d_}()||fU)(qe(n),e)}function _e(n,e=Ge.Default){return re(n,Ph(e))}function Ph(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function f_(n){const e=[];for(let t=0;t<n.length;t++){const i=qe(n[t]);if(Array.isArray(i)){if(0===i.length)throw new J(900,!1);let r,s=Ge.Default;for(let o=0;o<i.length;o++){const a=i[o],c=pU(a);"number"==typeof c?-1===c?r=a.token:s|=c:r=a}e.push(re(r,s))}else e.push(re(i))}return e}function Ql(n,e){return n[h_]=e,n.prototype[h_]=e,n}function pU(n){return n[h_]}function ds(n){return{toString:n}.toString()}var Or=(()=>((Or=Or||{})[Or.OnPush=0]="OnPush",Or[Or.Default=1]="Default",Or))(),mi=(()=>{return(n=mi||(mi={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",mi;var n})();const hs={},wt=[],Lh=At({\u0275cmp:At}),p_=At({\u0275dir:At}),m_=At({\u0275pipe:At}),RM=At({\u0275mod:At}),fs=At({\u0275fac:At}),eu=At({__NG_ELEMENT_ID__:At}),PM=At({__NG_ENV_ID__:At});function LM(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}function g_(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],o=t[i++],a=t[i++];n.setAttribute(e,o,a,s)}else{const s=r,o=t[++i];OM(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),i++}}return i}function NM(n){return 3===n||4===n||6===n}function OM(n){return 64===n.charCodeAt(0)}function tu(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||FM(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function FM(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}const kM="ng-template";function _U(n,e,t){let i=0,r=!0;for(;i<n.length;){let s=n[i++];if("string"==typeof s&&r){const o=n[i++];if(t&&"class"===s&&-1!==LM(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;i<n.length&&"string"==typeof(s=n[i++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(r=!1)}}return!1}function UM(n){return 4===n.type&&n.value!==kM}function vU(n,e,t){return e===(4!==n.type||t?n.value:kM)}function yU(n,e,t){let i=4;const r=n.attrs||[],s=function xU(n){for(let e=0;e<n.length;e++)if(NM(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const c=e[a];if("number"!=typeof c){if(!o)if(4&i){if(i=2|1&i,""!==c&&!vU(n,c,t)||""===c&&1===e.length){if(fr(i))return!1;o=!0}}else{const l=8&i?c:e[++a];if(8&i&&null!==n.attrs){if(!_U(n.attrs,l,t)){if(fr(i))return!1;o=!0}continue}const d=bU(8&i?"class":c,r,UM(n),t);if(-1===d){if(fr(i))return!1;o=!0;continue}if(""!==l){let h;h=d>s?"":r[d+1].toLowerCase();const f=8&i?h:null;if(f&&-1!==LM(f,l,0)||2&i&&l!==h){if(fr(i))return!1;o=!0}}}}else{if(!o&&!fr(i)&&!fr(c))return!1;if(o&&fr(c))continue;o=!1,i=c|1&i}}return fr(i)||o}function fr(n){return 0==(1&n)}function bU(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function MU(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function BM(n,e,t=!1){for(let i=0;i<e.length;i++)if(yU(n,e[i],t))return!0;return!1}function EU(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function VM(n,e){return n?":not("+e.trim()+")":e}function SU(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!fr(o)&&(e+=VM(s,r),r=""),i=o,s=s||!fr(i);t++}return""!==r&&(e+=VM(s,r)),e}function Pi(n){return ds(()=>{const e=HM(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===Or.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,data:n.data||{},encapsulation:n.encapsulation||mi.Emulated,styles:n.styles||wt,_:null,schemas:n.schemas||null,tView:null,id:""};GM(t);const i=n.dependencies;return t.directiveDefs=Nh(i,!1),t.pipeDefs=Nh(i,!0),t.id=function LU(n){let e=0;const t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const r of t)e=Math.imul(31,e)+r.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(t),t})}function DU(n){return Mt(n)||Zn(n)}function IU(n){return null!==n}function Yn(n){return ds(()=>({type:n.type,bootstrap:n.bootstrap||wt,declarations:n.declarations||wt,imports:n.imports||wt,exports:n.exports||wt,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function zM(n,e){if(null==n)return hs;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}function Ln(n){return ds(()=>{const e=HM(n);return GM(e),e})}function gi(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function Mt(n){return n[Lh]||null}function Zn(n){return n[p_]||null}function _i(n){return n[m_]||null}function Li(n,e){const t=n[RM]||null;if(!t&&!0===e)throw new Error(`Type ${xn(n)} does not have '\u0275mod' property.`);return t}function HM(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,exportAs:n.exportAs||null,standalone:!0===n.standalone,selectors:n.selectors||wt,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:zM(n.inputs,e),outputs:zM(n.outputs)}}function GM(n){n.features?.forEach(e=>e(n))}function Nh(n,e){if(!n)return null;const t=e?_i:DU;return()=>("function"==typeof n?n():n).map(i=>t(i)).filter(IU)}const Mn=0,be=1,tt=2,Wt=3,pr=4,Ho=5,Kn=6,Ya=7,Jt=8,Za=9,Go=10,Qe=11,nu=12,WM=13,Ka=14,hn=15,iu=16,Ja=17,Fr=18,ru=19,jM=20,no=21,ps=22,Oh=23,Fh=24,gt=25,__=1,$M=2,kr=7,kh=8,Qa=9,Hn=11;function Ni(n){return Array.isArray(n)&&"object"==typeof n[__]}function vi(n){return Array.isArray(n)&&!0===n[__]}function v_(n){return 0!=(4&n.flags)}function Wo(n){return n.componentOffset>-1}function Uh(n){return 1==(1&n.flags)}function mr(n){return!!n.template}function y_(n){return 0!=(512&n[tt])}function jo(n,e){return n.hasOwnProperty(fs)?n[fs]:null}let UU=Ot.WeakRef??class kU{constructor(e){this.ref=e}deref(){return this.ref}},VU=0,Ur=null,Bh=!1;function Nn(n){const e=Ur;return Ur=n,e}class KM{constructor(){this.id=VU++,this.ref=function BU(n){return new UU(n)}(this),this.producers=new Map,this.consumers=new Map,this.trackingVersion=0,this.valueVersion=0}consumerPollProducersForChange(){for(const[e,t]of this.producers){const i=t.producerNode.deref();if(void 0!==i&&t.atTrackingVersion===this.trackingVersion){if(i.producerPollStatus(t.seenValueVersion))return!0}else this.producers.delete(e),i?.consumers.delete(this.id)}return!1}producerMayHaveChanged(){const e=Bh;Bh=!0;try{for(const[t,i]of this.consumers){const r=i.consumerNode.deref();void 0!==r&&r.trackingVersion===i.atTrackingVersion?r.onConsumerDependencyMayHaveChanged():(this.consumers.delete(t),r?.producers.delete(this.id))}}finally{Bh=e}}producerAccessed(){if(Bh)throw new Error("");if(null===Ur)return;let e=Ur.producers.get(this.id);void 0===e?(e={consumerNode:Ur.ref,producerNode:this.ref,seenValueVersion:this.valueVersion,atTrackingVersion:Ur.trackingVersion},Ur.producers.set(this.id,e),this.consumers.set(Ur.id,e)):(e.seenValueVersion=this.valueVersion,e.atTrackingVersion=Ur.trackingVersion)}get hasProducers(){return this.producers.size>0}get producerUpdatesAllowed(){return!1!==Ur?.consumerAllowSignalWrites}producerPollStatus(e){return this.valueVersion!==e||(this.onProducerUpdateValueVersion(),this.valueVersion!==e)}}let JM=null;const QM=()=>{};class WU extends KM{constructor(e,t,i){super(),this.watch=e,this.schedule=t,this.dirty=!1,this.cleanupFn=QM,this.registerOnCleanup=r=>{this.cleanupFn=r},this.consumerAllowSignalWrites=i}notify(){this.dirty||this.schedule(this),this.dirty=!0}onConsumerDependencyMayHaveChanged(){this.notify()}onProducerUpdateValueVersion(){}run(){if(this.dirty=!1,0!==this.trackingVersion&&!this.consumerPollProducersForChange())return;const e=Nn(this);this.trackingVersion++;try{this.cleanupFn(),this.cleanupFn=QM,this.watch(this.registerOnCleanup)}finally{Nn(e)}}cleanup(){this.cleanupFn()}}class jU{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function io(){return eE}function eE(n){return n.type.prototype.ngOnChanges&&(n.setInput=qU),$U}function $U(){const n=nE(this),e=n?.current;if(e){const t=n.previous;if(t===hs)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function qU(n,e,t,i){const r=this.declaredInputs[t],s=nE(n)||function XU(n,e){return n[tE]=e}(n,{previous:hs,current:null}),o=s.current||(s.current={}),a=s.previous,c=a[r];o[r]=new jU(c&&c.currentValue,e,a===hs),n[i]=e}io.ngInherit=!0;const tE="__ngSimpleChanges__";function nE(n){return n[tE]||null}const Br=function(n,e,t){};function Ut(n){for(;Array.isArray(n);)n=n[Mn];return n}function Hh(n,e){return Ut(e[n])}function yi(n,e){return Ut(e[n.index])}function sE(n,e){return n.data[e]}function ec(n,e){return n[e]}function bi(n,e){const t=e[n];return Ni(t)?t:t[Mn]}function Gh(n){return 128==(128&n[tt])}function ro(n,e){return null==e?null:n[e]}function oE(n){n[Ja]=0}function e3(n){1024&n[tt]||(n[tt]|=1024,cE(n,1))}function aE(n){1024&n[tt]&&(n[tt]&=-1025,cE(n,-1))}function cE(n,e){let t=n[Wt];if(null===t)return;t[Ho]+=e;let i=t;for(t=t[Wt];null!==t&&(1===e&&1===i[Ho]||-1===e&&0===i[Ho]);)t[Ho]+=e,i=t,t=t[Wt]}const $e={lFrame:yE(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function dE(){return $e.bindingsEnabled}function tc(){return null!==$e.skipHydrationRootTNode}function ne(){return $e.lFrame.lView}function bt(){return $e.lFrame.tView}function nc(n){return $e.lFrame.contextLView=n,n[Jt]}function ic(n){return $e.lFrame.contextLView=null,n}function Gn(){let n=hE();for(;null!==n&&64===n.type;)n=n.parent;return n}function hE(){return $e.lFrame.currentTNode}function Vr(n,e){const t=$e.lFrame;t.currentTNode=n,t.isParent=e}function S_(){return $e.lFrame.isParent}function T_(){$e.lFrame.isParent=!1}function rc(){return $e.lFrame.bindingIndex++}function f3(n,e){const t=$e.lFrame;t.bindingIndex=t.bindingRootIndex=n,C_(e)}function C_(n){$e.lFrame.currentDirectiveIndex=n}function A_(n){const e=$e.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}function gE(){return $e.lFrame.currentQueryIndex}function D_(n){$e.lFrame.currentQueryIndex=n}function m3(n){const e=n[be];return 2===e.type?e.declTNode:1===e.type?n[Kn]:null}function _E(n,e,t){if(t&Ge.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&Ge.Host||(r=m3(s),null===r||(s=s[Ka],10&r.type))););if(null===r)return!1;e=r,n=s}const i=$e.lFrame=vE();return i.currentTNode=e,i.lView=n,!0}function I_(n){const e=vE(),t=n[be];$e.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function vE(){const n=$e.lFrame,e=null===n?null:n.child;return null===e?yE(n):e}function yE(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function bE(){const n=$e.lFrame;return $e.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const wE=bE;function R_(){const n=bE();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function si(){return $e.lFrame.selectedIndex}function $o(n){$e.lFrame.selectedIndex=n}function jt(){const n=$e.lFrame;return sE(n.tView,n.selectedIndex)}let ME=!0;function Wh(){return ME}function so(n){ME=n}function jh(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),null!=u&&(n.destroyHooks??=[]).push(t,u)}}function $h(n,e,t){EE(n,e,3,t)}function qh(n,e,t,i){(3&n[tt])===t&&EE(n,e,t,i)}function P_(n,e){let t=n[tt];(3&t)===e&&(t&=4095,t+=1,n[tt]=t)}function EE(n,e,t,i){const s=i??-1,o=e.length-1;let a=0;for(let c=void 0!==i?65535&n[Ja]:0;c<o;c++)if("number"==typeof e[c+1]){if(a=e[c],null!=i&&a>=i)break}else e[c]<0&&(n[Ja]+=65536),(a<s||-1==s)&&(M3(n,t,e,c),n[Ja]=(4294901760&n[Ja])+c+2),c++}function SE(n,e){Br(4,n,e);const t=Nn(null);try{e.call(n)}finally{Nn(t),Br(5,n,e)}}function M3(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];r?n[tt]>>12<n[Ja]>>16&&(3&n[tt])===e&&(n[tt]+=4096,SE(a,s)):SE(a,s)}const sc=-1;class au{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function TE(n){return n!==sc}function Xh(n){return 32767&n}function Yh(n,e){let t=function C3(n){return n>>16}(n),i=e;for(;t>0;)i=i[Ka],t--;return i}let N_=!0;function Zh(n){const e=N_;return N_=n,e}const CE=255,AE=5;let A3=0;const zr={};function Kh(n,e){const t=DE(n,e);if(-1!==t)return t;const i=e[be];i.firstCreatePass&&(n.injectorIndex=e.length,O_(i.data,n),O_(e,null),O_(i.blueprint,null));const r=F_(n,e),s=n.injectorIndex;if(TE(r)){const o=Xh(r),a=Yh(r,e),c=a[be].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=r,s}function O_(n,e){n.push(0,0,0,0,0,0,0,0,e)}function DE(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function F_(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=FE(r),null===i)return sc;if(t++,r=r[Ka],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return sc}function k_(n,e,t){!function D3(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(eu)&&(i=t[eu]),null==i&&(i=t[eu]=A3++);const r=i&CE;e.data[n+(r>>AE)]|=1<<r}(n,e,t)}function IE(n,e,t){if(t&Ge.Optional||void 0!==n)return n;Ah()}function RE(n,e,t,i){if(t&Ge.Optional&&void 0===i&&(i=null),!(t&(Ge.Self|Ge.Host))){const r=n[Za],s=pi(void 0);try{return r?r.get(e,i,t&Ge.Optional):AM(e,i,t&Ge.Optional)}finally{pi(s)}}return IE(i,0,t)}function PE(n,e,t,i=Ge.Default,r){if(null!==n){if(2048&e[tt]){const o=function N3(n,e,t,i,r){let s=n,o=e;for(;null!==s&&null!==o&&2048&o[tt]&&!(512&o[tt]);){const a=LE(s,o,t,i|Ge.Self,zr);if(a!==zr)return a;let c=s.parent;if(!c){const l=o[jM];if(l){const u=l.get(t,zr,i);if(u!==zr)return u}c=FE(o),o=o[Ka]}s=c}return r}(n,e,t,i,zr);if(o!==zr)return o}const s=LE(n,e,t,i,zr);if(s!==zr)return s}return RE(e,t,i,r)}function LE(n,e,t,i,r){const s=function P3(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(eu)?n[eu]:void 0;return"number"==typeof e?e>=0?e&CE:L3:e}(t);if("function"==typeof s){if(!_E(e,n,i))return i&Ge.Host?IE(r,0,i):RE(e,t,i,r);try{const o=s(i);if(null!=o||i&Ge.Optional)return o;Ah()}finally{wE()}}else if("number"==typeof s){let o=null,a=DE(n,e),c=sc,l=i&Ge.Host?e[hn][Kn]:null;for((-1===a||i&Ge.SkipSelf)&&(c=-1===a?F_(n,e):e[a+8],c!==sc&&OE(i,!1)?(o=e[be],a=Xh(c),e=Yh(c,e)):a=-1);-1!==a;){const u=e[be];if(NE(s,a,u.data)){const d=R3(a,e,t,o,i,l);if(d!==zr)return d}c=e[a+8],c!==sc&&OE(i,e[be].data[a+8]===l)&&NE(s,a,e)?(o=u,a=Xh(c),e=Yh(c,e)):a=-1}}return r}function R3(n,e,t,i,r,s){const o=e[be],a=o.data[n+8],u=Jh(a,o,t,null==i?Wo(a)&&N_:i!=o&&0!=(3&a.type),r&Ge.Host&&s===a);return null!==u?qo(e,o,u,a):zr}function Jh(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,c=n.directiveStart,u=s>>20,h=r?a+u:n.directiveEnd;for(let f=i?a:a+u;f<h;f++){const p=o[f];if(f<c&&t===p||f>=c&&p.type===t)return f}if(r){const f=o[c];if(f&&mr(f)&&f.type===t)return c}return null}function qo(n,e,t,i){let r=n[t];const s=e.data;if(function E3(n){return n instanceof au}(r)){const o=r;o.resolving&&function tU(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new J(-200,`Circular dependency in DI detected for ${n}${t}`)}(function St(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Ye(n)}(s[t]));const a=Zh(o.canSeeViewProviders);o.resolving=!0;const c=o.injectImpl?pi(o.injectImpl):null;_E(n,i,Ge.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function x3(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=eE(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}r&&(t.preOrderHooks??=[]).push(0-n,r),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}(t,s[t],e)}finally{null!==c&&pi(c),Zh(a),o.resolving=!1,wE()}}return r}function NE(n,e,t){return!!(t[e+(n>>AE)]&1<<n)}function OE(n,e){return!(n&Ge.Self||n&Ge.Host&&e)}class oc{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return PE(this._tNode,this._lView,e,Ph(i),t)}}function L3(){return new oc(Gn(),ne())}function Qh(n){return ds(()=>{const e=n.prototype.constructor,t=e[fs]||U_(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[fs]||U_(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function U_(n){return c_(n)?()=>{const e=U_(qe(n));return e&&e()}:jo(n)}function FE(n){const e=n[be],t=e.type;return 2===t?e.declTNode:1===t?n[Kn]:null}const cc="__parameters__";function uc(n,e,t){return ds(()=>{const i=function B_(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(c,l,u){const d=c.hasOwnProperty(cc)?c[cc]:Object.defineProperty(c,cc,{value:[]})[cc];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),c}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}function du(n,e){n.forEach(t=>Array.isArray(t)?du(t,e):e(t))}function UE(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function ef(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function hu(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}function Oi(n,e,t){let i=dc(n,e);return i>=0?n[1|i]=t:(i=~i,function B3(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function V_(n,e){const t=dc(n,e);if(t>=0)return n[1|t]}function dc(n,e){return function BE(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const Xo=Ql(uc("Optional"),8),fu=Ql(uc("SkipSelf"),4);function af(n){return 128==(128&n.flags)}var wi=(()=>((wi=wi||{})[wi.Important=1]="Important",wi[wi.DashCase=2]="DashCase",wi))();const $_=new Map;let lB=0;const X_="__ngContext__";function Jn(n,e){Ni(e)?(n[X_]=e[ru],function dB(n){$_.set(n[ru],n)}(e)):n[X_]=e}let Y_;function Z_(n,e){return Y_(n,e)}function gu(n){const e=n[Wt];return vi(e)?e[Wt]:e}function K_(n){return rS(n[nu])}function J_(n){return rS(n[pr])}function rS(n){for(;null!==n&&!vi(n);)n=n[pr];return n}function pc(n,e,t,i,r){if(null!=i){let s,o=!1;vi(i)?s=i:Ni(i)&&(o=!0,i=i[Mn]);const a=Ut(i);0===n&&null!==t?null==r?lS(e,t,a):Yo(e,t,a,r||null,!0):1===n&&null!==t?Yo(e,t,a,r||null,!0):2===n?function ff(n,e,t){const i=df(n,e);i&&function IB(n,e,t,i){n.removeChild(e,t,i)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function LB(n,e,t,i,r){const s=t[kr];s!==Ut(t)&&pc(e,n,i,s,r);for(let a=Hn;a<t.length;a++){const c=t[a];vu(c[be],c,n,e,i,s)}}(e,n,s,t,r)}}function uf(n,e,t){return n.createElement(e,t)}function oS(n,e){const t=n[Qa],i=t.indexOf(e);aE(e),t.splice(i,1)}function ev(n,e){if(n.length<=Hn)return;const t=Hn+e,i=n[t];if(i){const r=i[iu];null!==r&&r!==n&&oS(r,i),e>0&&(n[t-1][pr]=i[pr]);const s=ef(n,Hn+e);!function xB(n,e){vu(n,e,e[Qe],2,null,null),e[Mn]=null,e[Kn]=null}(i[be],i);const o=s[Fr];null!==o&&o.detachView(s[be]),i[Wt]=null,i[pr]=null,i[tt]&=-129}return i}function aS(n,e){if(!(256&e[tt])){const t=e[Qe];e[Oh]?.destroy(),e[Fh]?.destroy(),t.destroyNode&&vu(n,e,t,3,null,null),function SB(n){let e=n[nu];if(!e)return tv(n[be],n);for(;e;){let t=null;if(Ni(e))t=e[nu];else{const i=e[Hn];i&&(t=i)}if(!t){for(;e&&!e[pr]&&e!==n;)Ni(e)&&tv(e[be],e),e=e[Wt];null===e&&(e=n),Ni(e)&&tv(e[be],e),t=e&&e[pr]}e=t}}(e)}}function tv(n,e){if(!(256&e[tt])){e[tt]&=-129,e[tt]|=256,function DB(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof au)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],c=s[o+1];Br(4,a,c);try{c.call(a)}finally{Br(5,a,c)}}else{Br(4,r,s);try{s.call(r)}finally{Br(5,r,s)}}}}}(n,e),function AB(n,e){const t=n.cleanup,i=e[Ya];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?i[o]():i[-o].unsubscribe(),s+=2}else t[s].call(i[t[s+1]]);null!==i&&(e[Ya]=null);const r=e[no];if(null!==r){e[no]=null;for(let s=0;s<r.length;s++)(0,r[s])()}}(n,e),1===e[be].type&&e[Qe].destroy();const t=e[iu];if(null!==t&&vi(e[Wt])){t!==e[Wt]&&oS(t,e);const i=e[Fr];null!==i&&i.detachView(n)}!function hB(n){$_.delete(n[ru])}(e)}}function nv(n,e,t){return function cS(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[Mn];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===mi.None||s===mi.Emulated)return null}return yi(i,t)}}(n,e.parent,t)}function Yo(n,e,t,i,r){n.insertBefore(e,t,i,r)}function lS(n,e,t){n.appendChild(e,t)}function uS(n,e,t,i,r){null!==i?Yo(n,e,t,i,r):lS(n,e,t)}function df(n,e){return n.parentNode(e)}function dS(n,e,t){return fS(n,e,t)}let iv,pf,av,fS=function hS(n,e,t){return 40&n.type?yi(n,t):null};function hf(n,e,t,i){const r=nv(n,i,e),s=e[Qe],a=dS(i.parent||e[Kn],i,e);if(null!=r)if(Array.isArray(t))for(let c=0;c<t.length;c++)uS(s,r,t[c],a,!1);else uS(s,r,t,a,!1);void 0!==iv&&iv(s,i,e,t,r)}function _u(n,e){if(null!==e){const t=e.type;if(3&t)return yi(e,n);if(4&t)return rv(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return _u(n,i);{const r=n[e.index];return vi(r)?rv(-1,r):Ut(r)}}if(32&t)return Z_(e,n)()||Ut(n[e.index]);{const i=mS(n,e);return null!==i?Array.isArray(i)?i[0]:_u(gu(n[hn]),i):_u(n,e.next)}}return null}function mS(n,e){return null!==e?n[hn][Kn].projection[e.projection]:null}function rv(n,e){const t=Hn+n+1;if(t<e.length){const i=e[t],r=i[be].firstChild;if(null!==r)return _u(i,r)}return e[kr]}function sv(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],c=t.type;if(o&&0===e&&(a&&Jn(Ut(a),i),t.flags|=2),32!=(32&t.flags))if(8&c)sv(n,e,t.child,i,r,s,!1),pc(e,n,r,a,s);else if(32&c){const l=Z_(t,i);let u;for(;u=l();)pc(e,n,r,u,s);pc(e,n,r,a,s)}else 16&c?_S(n,e,i,t,r,s):pc(e,n,r,a,s);t=o?t.projectionNext:t.next}}function vu(n,e,t,i,r,s){sv(t,i,n.firstChild,e,r,s,!1)}function _S(n,e,t,i,r,s){const o=t[hn],c=o[Kn].projection[i.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++)pc(e,n,r,c[l],s);else{let l=c;const u=o[Wt];af(i)&&(l.flags|=128),sv(n,e,l,u,r,s,!0)}}function vS(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function yS(n,e,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&g_(n,e,i),null!==r&&vS(n,e,r),null!==s&&function OB(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}function mc(n){return function ov(){if(void 0===pf&&(pf=null,Ot.trustedTypes))try{pf=Ot.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return pf}()?.createHTML(n)||n}class Zo{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${MM})`}}class VB extends Zo{getTypeName(){return"HTML"}}class zB extends Zo{getTypeName(){return"Style"}}class HB extends Zo{getTypeName(){return"Script"}}class GB extends Zo{getTypeName(){return"URL"}}class WB extends Zo{getTypeName(){return"ResourceURL"}}function Fi(n){return n instanceof Zo?n.changingThisBreaksApplicationSecurity:n}function Hr(n,e){const t=function jB(n){return n instanceof Zo&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${MM})`)}return t===e}class KB{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(mc(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch{return null}}}class JB{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){const t=this.inertDocument.createElement("template");return t.innerHTML=mc(e),t}}const eV=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function gf(n){return(n=String(n)).match(eV)?n:"unsafe:"+n}function _s(n){const e={};for(const t of n.split(","))e[t]=!0;return e}function bu(...n){const e={};for(const t of n)for(const i in t)t.hasOwnProperty(i)&&(e[i]=!0);return e}const ES=_s("area,br,col,hr,img,wbr"),SS=_s("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),TS=_s("rp,rt"),lv=bu(ES,bu(SS,_s("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),bu(TS,_s("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),bu(TS,SS)),uv=_s("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),CS=bu(uv,_s("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),_s("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),tV=_s("script,style,template");class nV{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,i=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?i=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,i&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!lv.hasOwnProperty(t))return this.sanitizedSomething=!0,!tV.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const i=e.attributes;for(let r=0;r<i.length;r++){const s=i.item(r),o=s.name,a=o.toLowerCase();if(!CS.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let c=s.value;uv[a]&&(c=gf(c)),this.buf.push(" ",o,'="',AS(c),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();lv.hasOwnProperty(t)&&!ES.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(AS(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const iV=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,rV=/([^\#-~ |!])/g;function AS(n){return n.replace(/&/g,"&amp;").replace(iV,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(rV,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let _f;function DS(n,e){let t=null;try{_f=_f||function MS(n){const e=new JB(n);return function QB(){try{return!!(new window.DOMParser).parseFromString(mc(""),"text/html")}catch{return!1}}()?new KB(e):e}(n);let i=e?String(e):"";t=_f.getInertBodyElement(i);let r=5,s=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=s,s=t.innerHTML,t=_f.getInertBodyElement(i)}while(i!==s);return mc((new nV).sanitizeChildren(dv(t)||t))}finally{if(t){const i=dv(t)||t;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function dv(n){return"content"in n&&function sV(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var Et=(()=>((Et=Et||{})[Et.NONE=0]="NONE",Et[Et.HTML=1]="HTML",Et[Et.STYLE=2]="STYLE",Et[Et.SCRIPT=3]="SCRIPT",Et[Et.URL=4]="URL",Et[Et.RESOURCE_URL=5]="RESOURCE_URL",Et))();class pe{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=xe({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const xu=new pe("ENVIRONMENT_INITIALIZER"),LS=new pe("INJECTOR",-1),NS=new pe("INJECTOR_DEF_TYPES");class OS{get(e,t=Jl){if(t===Jl){const i=new Error(`NullInjectorError: No provider for ${xn(e)}!`);throw i.name="NullInjectorError",i}return t}}function vf(n){return{\u0275providers:n}}function hV(...n){return{\u0275providers:FS(0,n),\u0275fromNgModule:!0}}function FS(n,...e){const t=[],i=new Set;let r;return du(e,s=>{const o=s;hv(o,t,[],i)&&(r||=[],r.push(o))}),void 0!==r&&kS(r,t),t}function kS(n,e){for(let t=0;t<n.length;t++){const{providers:r}=n[t];fv(r,s=>{e.push(s)})}}function hv(n,e,t,i){if(!(n=qe(n)))return!1;let r=null,s=SM(n);const o=!s&&Mt(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const c=n.ngModule;if(s=SM(c),!s)return!1;r=c}const a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){const c="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const l of c)hv(l,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let l;i.add(r);try{du(s.imports,u=>{hv(u,e,t,i)&&(l||=[],l.push(u))})}finally{}void 0!==l&&kS(l,e)}if(!a){const l=jo(r)||(()=>new r);e.push({provide:r,useFactory:l,deps:wt},{provide:NS,useValue:r,multi:!0},{provide:xu,useValue:()=>re(r),multi:!0})}const c=s.providers;null==c||a||fv(c,u=>{e.push(u)})}}return r!==n&&void 0!==n.providers}function fv(n,e){for(let t of n)l_(t)&&(t=t.\u0275providers),Array.isArray(t)?fv(t,e):e(t)}const fV=At({provide:String,useValue:At});function pv(n){return null!==n&&"object"==typeof n&&fV in n}function Ko(n){return"function"==typeof n}const mv=new pe("Set Injector scope."),yf={},mV={};let gv;function bf(){return void 0===gv&&(gv=new OS),gv}class Gr{}class _v extends Gr{get destroyed(){return this._destroyed}constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,yv(e,o=>this.processProvider(o)),this.records.set(LS,gc(void 0,this)),r.has("environment")&&this.records.set(Gr,gc(void 0,this));const s=this.records.get(mv);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(NS.multi,wt,Ge.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=to(this),i=pi(void 0);try{return e()}finally{to(t),pi(i)}}get(e,t=Jl,i=Ge.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(PM))return e[PM](this);i=Ph(i);const r=to(this),s=pi(void 0);try{if(!(i&Ge.SkipSelf)){let a=this.records.get(e);if(void 0===a){const c=function bV(n){return"function"==typeof n||"object"==typeof n&&n instanceof pe}(e)&&Dh(e);a=c&&this.injectableDefInScope(c)?gc(vv(e),yf):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(i&Ge.Self?bf():this.parent).get(e,t=i&Ge.Optional&&t===Jl?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[Rh]=o[Rh]||[]).unshift(xn(e)),r)throw o;return function mU(n,e,t,i){const r=n[Rh];throw e[DM]&&r.unshift(e[DM]),n.message=function gU(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=xn(e);if(Array.isArray(e))r=e.map(xn).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):xn(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(uU,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[Rh]=null,n}(o,e,"R3InjectorError",this.source)}throw o}finally{pi(s),to(r)}}resolveInjectorInitializers(){const e=to(this),t=pi(void 0);try{const i=this.get(xu.multi,wt,Ge.Self);for(const r of i)r()}finally{to(e),pi(t)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(xn(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new J(205,!1)}processProvider(e){let t=Ko(e=qe(e))?e:qe(e&&e.provide);const i=function _V(n){return pv(n)?gc(void 0,n.useValue):gc(VS(n),yf)}(e);if(Ko(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=gc(void 0,yf,!0),r.factory=()=>f_(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){return t.value===yf&&(t.value=mV,t.value=t.factory()),"object"==typeof t.value&&t.value&&function yV(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=qe(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function vv(n){const e=Dh(n),t=null!==e?e.factory:jo(n);if(null!==t)return t;if(n instanceof pe)throw new J(204,!1);if(n instanceof Function)return function gV(n){const e=n.length;if(e>0)throw hu(e,"?"),new J(204,!1);const t=function aU(n){return n&&(n[Ih]||n[TM])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new J(204,!1)}function VS(n,e,t){let i;if(Ko(n)){const r=qe(n);return jo(r)||vv(r)}if(pv(n))i=()=>qe(n.useValue);else if(function BS(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...f_(n.deps||[]));else if(function US(n){return!(!n||!n.useExisting)}(n))i=()=>re(qe(n.useExisting));else{const r=qe(n&&(n.useClass||n.provide));if(!function vV(n){return!!n.deps}(n))return jo(r)||vv(r);i=()=>new r(...f_(n.deps))}return i}function gc(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function yv(n,e){for(const t of n)Array.isArray(t)?yv(t,e):t&&l_(t)?yv(t.\u0275providers,e):e(t)}const wf=new pe("AppId",{providedIn:"root",factory:()=>wV}),wV="ng",zS=new pe("Platform Initializer"),oo=new pe("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),_c=new pe("AnimationModuleType"),bv=new pe("CSP nonce",{providedIn:"root",factory:()=>function yu(){if(void 0!==av)return av;if(typeof document<"u")return document;throw new J(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let GS=(n,e)=>null;function WS(n,e){return GS(n,e)}class IV{}class qS{}class PV{resolveComponentFactory(e){throw function RV(n){const e=Error(`No component factory found for ${xn(n)}.`);return e.ngComponent=n,e}(e)}}let Tf=(()=>{class n{}return n.NULL=new PV,n})();function LV(){return vc(Gn(),ne())}function vc(n,e){return new On(yi(n,e))}let On=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=LV,n})();function NV(n){return n instanceof On?n.nativeElement:n}class Tu{}let FV=(()=>{class n{}return n.\u0275prov=xe({token:n,providedIn:"root",factory:()=>null}),n})();class yc{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const kV=new yc("16.0.2"),Rv={};function Cu(n){for(;n;){n[tt]|=64;const e=gu(n);if(y_(n)&&!e)return n;n=e}return null}function Pv(n){return n.ngOriginalError}class Wr{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Pv(e);for(;t&&Pv(t);)t=Pv(t);return t||null}}const KS=new pe("",{providedIn:"root",factory:()=>!1});function vs(n){return n instanceof Function?n():n}class eT extends KM{constructor(){super(...arguments),this.consumerAllowSignalWrites=!1,this._lView=null}set lView(e){this._lView=e}onConsumerDependencyMayHaveChanged(){Cu(this._lView)}onProducerUpdateValueVersion(){}get hasReadASignal(){return this.hasProducers}runInContext(e,t,i){const r=Nn(this);this.trackingVersion++;try{e(t,i)}finally{Nn(r)}}destroy(){this.trackingVersion++}}let Df=null;function tT(){return Df??=new eT,Df}function nT(n,e){return n[e]??tT()}function iT(n,e){const t=tT();t.hasReadASignal&&(n[e]=Df,t.lView=n,Df=new eT)}const et={};function gr(n){rT(bt(),ne(),si()+n,!1)}function rT(n,e,t,i){if(!i)if(3==(3&e[tt])){const s=n.preOrderCheckHooks;null!==s&&$h(e,s,t)}else{const s=n.preOrderHooks;null!==s&&qh(e,s,0,t)}$o(t)}function cT(n,e=null,t=null,i){const r=lT(n,e,t,i);return r.resolveInjectorInitializers(),r}function lT(n,e=null,t=null,i,r=new Set){const s=[t||wt,hV(n)];return i=i||("object"==typeof n?void 0:xn(n)),new _v(s,e||bf(),i||null,r)}let jr=(()=>{class n{static create(t,i){if(Array.isArray(t))return cT({name:""},i,t,"");{const r=t.name??"";return cT({name:r},t.parent,t.providers,r)}}}return n.THROW_IF_NOT_FOUND=Jl,n.NULL=new OS,n.\u0275prov=xe({token:n,providedIn:"any",factory:()=>re(LS)}),n.__NG_ELEMENT_ID__=-1,n})();function oe(n,e=Ge.Default){const t=ne();return null===t?re(n,e):PE(Gn(),t,qe(n),e)}function Lv(){throw new Error("invalid")}function If(n,e,t,i,r,s,o,a,c,l,u){const d=e.blueprint.slice();return d[Mn]=r,d[tt]=140|i,(null!==l||n&&2048&n[tt])&&(d[tt]|=2048),oE(d),d[Wt]=d[Ka]=n,d[Jt]=t,d[Go]=o||n&&n[Go],d[Qe]=a||n&&n[Qe],d[Za]=c||n&&n[Za]||null,d[Kn]=s,d[ru]=function uB(){return lB++}(),d[ps]=u,d[jM]=l,d[hn]=2==e.type?n[hn]:d,d}function wc(n,e,t,i,r){let s=n.data[e];if(null===s)s=function Nv(n,e,t,i,r){const s=hE(),o=S_(),c=n.data[e]=function rz(n,e,t,i,r,s){let o=e?e.injectorIndex:-1,a=0;return tc()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=c),null!==s&&(o?null==s.child&&null!==c.parent&&(s.child=c):null===s.next&&(s.next=c,c.prev=s)),c}(n,e,t,i,r),function h3(){return $e.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function ou(){const n=$e.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Vr(s,!0),s}function Au(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function uT(n,e,t,i,r){const s=nT(e,Oh),o=si(),a=2&i;try{if($o(-1),a&&e.length>gt&&rT(n,e,gt,!1),Br(a?2:0,r),a)s.runInContext(t,i,r);else{const l=Nn(null);try{t(i,r)}finally{Nn(l)}}}finally{a&&null===e[Oh]&&iT(e,Oh),$o(o),Br(a?3:1,r)}}function Ov(n,e,t){if(v_(e)){const i=Nn(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=n.data[o];a.contentQueries&&a.contentQueries(1,t[o],o)}}finally{Nn(i)}}}function Fv(n,e,t){dE()&&(function dz(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;Wo(t)&&function vz(n,e,t){const i=yi(e,n),o=Rf(n,If(n,dT(t),null,t.onPush?64:16,i,e,null,n[Go].rendererFactory.createRenderer(i,t),null,null,null));n[e.index]=o}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||Kh(t,e),Jn(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const c=n.data[a],l=qo(e,n,a,t);Jn(l,e),null!==o&&yz(0,a-r,l,c,0,o),mr(c)&&(bi(t.index,e)[Jt]=qo(e,n,a,t))}}(n,e,t,yi(t,e)),64==(64&t.flags)&&gT(n,e,t))}function kv(n,e,t=yi){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function dT(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=Uv(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function Uv(n,e,t,i,r,s,o,a,c,l,u){const d=gt+i,h=d+r,f=function JV(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:et);return t}(d,h),p="function"==typeof l?l():l;return f[be]={type:n,blueprint:f,template:t,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:c,consts:p,incompleteFirstPass:!1,ssrId:u}}let hT=n=>null;function fT(n,e,t,i){for(let r in n)if(n.hasOwnProperty(r)){t=null===t?{}:t;const s=n[r];null===i?pT(t,e,r,s):i.hasOwnProperty(r)&&pT(t,e,i[r],s)}return t}function pT(n,e,t,i){n.hasOwnProperty(t)?n[t].push(e,i):n[t]=[e,i]}function ki(n,e,t,i,r,s,o,a){const c=yi(e,t);let u,l=e.inputs;!a&&null!=l&&(u=l[i])?(Gv(n,t,u,i,r),Wo(e)&&function az(n,e){const t=bi(e,n);16&t[tt]||(t[tt]|=64)}(t,e.index)):3&e.type&&(i=function oz(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,s.setProperty(c,i,r))}function Bv(n,e,t,i){if(dE()){const r=null===i?null:{"":-1},s=function fz(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(BM(e,o.selectors,!1))if(i||(i=[]),mr(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),i.unshift(...a,o),Vv(n,e,a.length)}else i.unshift(o),Vv(n,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return null===i?null:[i,r]}(n,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&mT(n,e,t,o,r,a),r&&function pz(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new J(-301,!1);i.push(e[r],s)}}}(t,i,r)}t.mergedAttrs=tu(t.mergedAttrs,t.attrs)}function mT(n,e,t,i,r,s){for(let l=0;l<i.length;l++)k_(Kh(t,e),n,i[l].type);!function gz(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let l=0;l<i.length;l++){const u=i[l];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,c=Au(n,e,i.length,null);for(let l=0;l<i.length;l++){const u=i[l];t.mergedAttrs=tu(t.mergedAttrs,u.hostAttrs),_z(n,t,e,c,u),mz(c,u,r),null!==u.contentQueries&&(t.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(t.flags|=64);const d=u.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}!function sz(n,e,t){const r=e.directiveEnd,s=n.data,o=e.attrs,a=[];let c=null,l=null;for(let u=e.directiveStart;u<r;u++){const d=s[u],h=t?t.get(d):null,p=h?h.outputs:null;c=fT(d.inputs,u,c,h?h.inputs:null),l=fT(d.outputs,u,l,p);const _=null===c||null===o||UM(e)?null:bz(c,u,o);a.push(_)}null!==c&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}(n,t,s)}function gT(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,o=function p3(){return $e.lFrame.currentDirectiveIndex}();try{$o(s);for(let a=i;a<r;a++){const c=n.data[a],l=e[a];C_(a),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&hz(c,l)}}finally{$o(-1),C_(o)}}function hz(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function Vv(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function mz(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;mr(e)&&(t[""]=n)}}function _z(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=jo(r.type)),o=new au(s,mr(r),oe);n.blueprint[i]=o,t[i]=o,function lz(n,e,t,i,r){const s=r.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~e.index;(function uz(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,i,s)}}(n,e,i,Au(n,t,r.hostVars,et),r)}function $r(n,e,t,i,r,s){const o=yi(n,e);!function zv(n,e,t,i,r,s,o){if(null==s)n.removeAttribute(e,r,t);else{const a=null==o?Ye(s):o(s,i||"",r);n.setAttribute(e,r,a,t)}}(e[Qe],o,s,n.value,t,i,r)}function yz(n,e,t,i,r,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)_T(i,t,o[a++],o[a++],o[a++])}function _T(n,e,t,i,r){const s=Nn(null);try{null!==n.setInput?n.setInput(e,r,t,i):e[i]=r}finally{Nn(s)}}function bz(n,e,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const o=n[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){i.push(s,o[a+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function vT(n,e,t,i){return[n,!0,!1,e,null,0,i,t,null,null,null]}function yT(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const s=t[i+1];if(-1!==s){const o=n.data[s];D_(t[i]),o.contentQueries(2,e[s],s)}}}function Rf(n,e){return n[nu]?n[WM][pr]=e:n[nu]=e,n[WM]=e,e}function Hv(n,e,t){D_(0);const i=Nn(null);try{e(n,t)}finally{Nn(i)}}function bT(n){return n[Ya]||(n[Ya]=[])}function wT(n){return n.cleanup||(n.cleanup=[])}function xT(n,e,t){return(null===n||mr(n))&&(t=function ZU(n){for(;Array.isArray(n);){if("object"==typeof n[__])return n;n=n[Mn]}return null}(t[e.index])),t[Qe]}function MT(n,e){const t=n[Za],i=t?t.get(Wr,null):null;i&&i.handleError(e)}function Gv(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++];_T(n.data[o],e[o],i,a,r)}}function wz(n,e){const t=bi(e,n),i=t[be];!function xz(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}(i,t);const r=t[Mn];null!==r&&null===t[ps]&&(t[ps]=WS(r,t[Za])),Wv(i,t,t[Jt])}function Wv(n,e,t){I_(e);try{const i=n.viewQuery;null!==i&&Hv(1,i,t);const r=n.template;null!==r&&uT(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&yT(n,e),n.staticViewQueries&&Hv(2,n.viewQuery,t);const s=n.components;null!==s&&function Mz(n,e){for(let t=0;t<e.length;t++)wz(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[tt]&=-5,R_()}}let ET=(()=>{class n{constructor(){this.all=new Set,this.queue=new Map}create(t,i,r){const s=typeof Zone>"u"?null:Zone.current,o=new WU(t,l=>{this.all.has(l)&&this.queue.set(l,s)},r);let a;this.all.add(o),o.notify();const c=()=>{o.cleanup(),a?.(),this.all.delete(o),this.queue.delete(o)};return a=i?.onDestroy(c),{destroy:c}}flush(){if(0!==this.queue.size)for(const[t,i]of this.queue)this.queue.delete(t),i?i.run(()=>t.run()):t.run()}get isQueueEmpty(){return 0===this.queue.size}}return n.\u0275prov=xe({token:n,providedIn:"root",factory:()=>new n}),n})();function Pf(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=a_(r,a):2==s&&(i=a_(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function Du(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&i.push(Ut(s)),vi(s)){for(let a=Hn;a<s.length;a++){const c=s[a],l=c[be].firstChild;null!==l&&Du(c[be],c,l,i)}s[kr]!==s[Mn]&&i.push(s[kr])}const o=t.type;if(8&o)Du(n,e,t.child,i);else if(32&o){const a=Z_(t,e);let c;for(;c=a();)i.push(c)}else if(16&o){const a=mS(e,t);if(Array.isArray(a))i.push(...a);else{const c=gu(e[hn]);Du(c[be],c,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function Lf(n,e,t,i=!0){const r=e[Go].rendererFactory;r.begin&&r.begin();try{Nf(n,e,n.template,t)}catch(o){throw i&&MT(e,o),o}finally{r.end&&r.end(),e[Go].effectManager?.flush()}}function Nf(n,e,t,i){const r=e[tt];if(256!=(256&r)){e[Go].effectManager?.flush(),I_(e);try{oE(e),function pE(n){return $e.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&uT(n,e,t,2,i);const o=3==(3&r);if(o){const l=n.preOrderCheckHooks;null!==l&&$h(e,l,null)}else{const l=n.preOrderHooks;null!==l&&qh(e,l,0,null),P_(e,0)}if(function Dz(n){for(let e=K_(n);null!==e;e=J_(e)){if(!e[$M])continue;const t=e[Qa];for(let i=0;i<t.length;i++){e3(t[i])}}}(e),function Az(n){for(let e=K_(n);null!==e;e=J_(e))for(let t=Hn;t<e.length;t++){const i=e[t],r=i[be];Gh(i)&&Nf(r,i,r.template,i[Jt])}}(e),null!==n.contentQueries&&yT(n,e),o){const l=n.contentCheckHooks;null!==l&&$h(e,l)}else{const l=n.contentHooks;null!==l&&qh(e,l,1),P_(e,1)}!function KV(n,e){const t=n.hostBindingOpCodes;if(null===t)return;const i=nT(e,Fh);try{for(let r=0;r<t.length;r++){const s=t[r];if(s<0)$o(~s);else{const o=s,a=t[++r],c=t[++r];f3(a,o),i.runInContext(c,2,e[o])}}}finally{null===e[Fh]&&iT(e,Fh),$o(-1)}}(n,e);const a=n.components;null!==a&&function Rz(n,e){for(let t=0;t<e.length;t++)Iz(n,e[t])}(e,a);const c=n.viewQuery;if(null!==c&&Hv(2,c,i),o){const l=n.viewCheckHooks;null!==l&&$h(e,l)}else{const l=n.viewHooks;null!==l&&qh(e,l,2),P_(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[tt]&=-73,aE(e)}finally{R_()}}}function Iz(n,e){const t=bi(e,n);if(Gh(t)){const i=t[be];80&t[tt]?Nf(i,t,i.template,t[Jt]):t[Ho]>0&&jv(t)}}function jv(n){for(let i=K_(n);null!==i;i=J_(i))for(let r=Hn;r<i.length;r++){const s=i[r];if(Gh(s))if(1024&s[tt]){const o=s[be];Nf(o,s,o.template,s[Jt])}else s[Ho]>0&&jv(s)}const t=n[be].components;if(null!==t)for(let i=0;i<t.length;i++){const r=bi(t[i],n);Gh(r)&&r[Ho]>0&&jv(r)}}class Iu{get rootNodes(){const e=this._lView,t=e[be];return Du(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Jt]}set context(e){this._lView[Jt]=e}get destroyed(){return 256==(256&this._lView[tt])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[Wt];if(vi(e)){const t=e[kh],i=t?t.indexOf(this):-1;i>-1&&(ev(e,i),ef(t,i))}this._attachedToViewContainer=!1}aS(this._lView[be],this._lView)}onDestroy(e){!function lE(n,e){if(256==(256&n[tt]))throw new J(911,!1);null===n[no]&&(n[no]=[]),n[no].push(e)}(this._lView,e)}markForCheck(){Cu(this._cdRefInjectingView||this._lView)}detach(){this._lView[tt]&=-129}reattach(){this._lView[tt]|=128}detectChanges(){Lf(this._lView[be],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new J(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function EB(n,e){vu(n,e,e[Qe],2,null,null)}(this._lView[be],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new J(902,!1);this._appRef=e}}class Pz extends Iu{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;Lf(e[be],e,e[Jt],!1)}checkNoChanges(){}get context(){return null}}class ST extends Tf{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Mt(e);return new Ru(t,this.ngModule)}}function TT(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class Nz{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=Ph(i);const r=this.injector.get(e,Rv,i);return r!==Rv||t===Rv?r:this.parentInjector.get(e,t,i)}}class Ru extends qS{get inputs(){return TT(this.componentDef.inputs)}get outputs(){return TT(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function TU(n){return n.map(SU).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){let s=(r=r||this.ngModule)instanceof Gr?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new Nz(e,s):e,a=o.get(Tu,null);if(null===a)throw new J(407,!1);const u={rendererFactory:a,sanitizer:o.get(FV,null),effectManager:o.get(ET,null)},d=a.createRenderer(null,this.componentDef),h=this.componentDef.selectors[0][0]||"div",f=i?function QV(n,e,t,i){const s=i.get(KS,!1)||t===mi.ShadowDom,o=n.selectRootElement(e,s);return function ez(n){hT(n)}(o),o}(d,i,this.componentDef.encapsulation,o):uf(d,h,function Lz(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(h)),p=this.componentDef.onPush?576:528,_=Uv(0,null,null,1,0,null,null,null,null,null,null),g=If(null,_,null,p,null,null,u,d,o,null,null);let m,y;I_(g);try{const v=this.componentDef;let b,x=null;v.findHostDirectiveDefs?(b=[],x=new Map,v.findHostDirectiveDefs(v,b,x),b.push(v)):b=[v];const E=function Fz(n,e){const t=n[be],i=gt;return n[i]=e,wc(t,i,2,"#host",null)}(g,f),T=function kz(n,e,t,i,r,s,o){const a=r[be];!function Uz(n,e,t,i){for(const r of n)e.mergedAttrs=tu(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(Pf(e,e.mergedAttrs,!0),null!==t&&yS(i,t,e))}(i,n,e,o);let c=null;null!==e&&(c=WS(e,r[Za]));const l=s.rendererFactory.createRenderer(e,t),u=If(r,dT(t),null,t.onPush?64:16,r[n.index],n,s,l,null,null,c);return a.firstCreatePass&&Vv(a,n,i.length-1),Rf(r,u),r[n.index]=u}(E,f,v,b,g,u,d);y=sE(_,gt),f&&function Vz(n,e,t,i){if(i)g_(n,t,["ng-version",kV.full]);else{const{attrs:r,classes:s}=function CU(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!fr(r))break;r=s}i++}return{attrs:e,classes:t}}(e.selectors[0]);r&&g_(n,t,r),s&&s.length>0&&vS(n,t,s.join(" "))}}(d,v,f,i),void 0!==t&&function zz(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const s=t[r];i.push(null!=s?Array.from(s):null)}}(y,this.ngContentSelectors,t),m=function Bz(n,e,t,i,r,s){const o=Gn(),a=r[be],c=yi(o,r);mT(a,r,o,t,null,i);for(let u=0;u<t.length;u++)Jn(qo(r,a,o.directiveStart+u,o),r);gT(a,r,o),c&&Jn(c,r);const l=qo(r,a,o.directiveStart+o.componentOffset,o);if(n[Jt]=r[Jt]=l,null!==s)for(const u of s)u(l,e);return Ov(a,o,n),l}(T,v,b,x,g,[Hz]),Wv(_,g,null)}finally{R_()}return new Oz(this.componentType,m,vc(y,g),g,y)}}class Oz extends IV{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new Pz(r),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;Gv(s[be],s,r,e,t),this.previousInputValues.set(e,t),Cu(bi(this._tNode.index,s))}}get injector(){return new oc(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function Hz(){const n=Gn();jh(ne()[be],n)}function bs(n){let e=function CT(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(mr(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new J(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=$v(n.inputs),o.declaredInputs=$v(n.declaredInputs),o.outputs=$v(n.outputs);const a=r.hostBindings;a&&$z(n,a);const c=r.viewQuery,l=r.contentQueries;if(c&&Wz(n,c),l&&jz(n,l),o_(n.inputs,r.inputs),o_(n.declaredInputs,r.declaredInputs),o_(n.outputs,r.outputs),mr(r)&&r.data.animation){const u=n.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===bs&&(t=!1)}}e=Object.getPrototypeOf(e)}!function Gz(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=tu(r.hostAttrs,t=tu(t,r.hostAttrs))}}(i)}function $v(n){return n===hs?{}:n===wt?[]:n}function Wz(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function jz(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function $z(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}function Of(n){return!!qv(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function qv(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function Qn(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function Qo(n,e,t,i){const r=ne();return Qn(r,rc(),e)&&(bt(),$r(jt(),r,n,e,t,i)),Qo}function _r(n,e,t,i,r,s,o,a){const c=ne(),l=bt(),u=n+gt,d=l.firstCreatePass?function _H(n,e,t,i,r,s,o,a,c){const l=e.consts,u=wc(e,n,4,o||null,ro(l,a));Bv(e,t,u,ro(l,c)),jh(e,u);const d=u.tView=Uv(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return null!==e.queries&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}(u,l,c,e,t,i,r,s,o):l.data[u];Vr(d,!1);const h=GT(l,c,d,n);Wh()&&hf(l,c,h,d),Jn(h,c),Rf(c,c[u]=vT(h,c,h,d)),Uh(d)&&Fv(l,c,d),null!=o&&kv(c,d,a)}let GT=function WT(n,e,t,i){return so(!0),e[Qe].createComment("")};function Mi(n,e,t){const i=ne();return Qn(i,rc(),e)&&ki(bt(),jt(),i,n,e,i[Qe],t,!1),Mi}function Qv(n,e,t,i,r){const o=r?"class":"style";Gv(n,t,e.inputs[o],o,i)}function fn(n,e,t,i){const r=ne(),s=bt(),o=gt+n,a=r[Qe],c=s.firstCreatePass?function wH(n,e,t,i,r,s){const o=e.consts,c=wc(e,n,2,i,ro(o,r));return Bv(e,t,c,ro(o,s)),null!==c.attrs&&Pf(c,c.attrs,!1),null!==c.mergedAttrs&&Pf(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,e,t,i):s.data[o],l=$T(s,r,c,a,e,n);r[o]=l;const u=Uh(c);return Vr(c,!0),yS(a,l,c),32!=(32&c.flags)&&Wh()&&hf(s,r,l,c),0===function n3(){return $e.lFrame.elementDepthCount}()&&Jn(l,r),function r3(){$e.lFrame.elementDepthCount++}(),u&&(Fv(s,r,c),Ov(s,c,r)),null!==i&&kv(r,c),fn}function Fn(){let n=Gn();S_()?T_():(n=n.parent,Vr(n,!1));const e=n;(function o3(n){return $e.skipHydrationRootTNode===n})(e)&&function u3(){$e.skipHydrationRootTNode=null}(),function s3(){$e.lFrame.elementDepthCount--}();const t=bt();return t.firstCreatePass&&(jh(t,n),v_(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function S3(n){return 0!=(8&n.flags)}(e)&&Qv(t,e,ne(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function T3(n){return 0!=(16&n.flags)}(e)&&Qv(t,e,ne(),e.stylesWithoutHost,!1),Fn}function ao(n,e,t,i){return fn(n,e,t,i),Fn(),ao}let $T=(n,e,t,i,r,s)=>(so(!0),uf(i,r,function xE(){return $e.lFrame.currentNamespace}()));function Rc(){return ne()}function Vf(n){return!!n&&"function"==typeof n.then}function YT(n){return!!n&&"function"==typeof n.subscribe}function co(n,e,t,i){const r=ne(),s=bt(),o=Gn();return ZT(s,r,r[Qe],o,n,e,i),co}function ny(n,e){const t=Gn(),i=ne(),r=bt();return ZT(r,i,xT(A_(r.data),t,i),t,n,e),ny}function ZT(n,e,t,i,r,s,o){const a=Uh(i),l=n.firstCreatePass&&wT(n),u=e[Jt],d=bT(e);let h=!0;if(3&i.type||o){const _=yi(i,e),g=o?o(_):_,m=d.length,y=o?b=>o(Ut(b[i.index])):i.index;let v=null;if(!o&&a&&(v=function CH(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[Ya],c=r[s+2];return a.length>c?a[c]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==v)(v.__ngLastListenerFn__||v).__ngNextListenerFn__=s,v.__ngLastListenerFn__=s,h=!1;else{s=JT(i,e,u,s,!1);const b=t.listen(g,r,s);d.push(s,b),l&&l.push(r,y,m,m+1)}}else s=JT(i,e,u,s,!1);const f=i.outputs;let p;if(h&&null!==f&&(p=f[r])){const _=p.length;if(_)for(let g=0;g<_;g+=2){const x=e[p[g]][p[g+1]].subscribe(s),E=d.length;d.push(s,x),l&&l.push(r,i.index,E,-(E+1))}}}function KT(n,e,t,i){try{return Br(6,e,t),!1!==t(i)}catch(r){return MT(n,r),!1}finally{Br(7,e,t)}}function JT(n,e,t,i,r){return function s(o){if(o===Function)return i;Cu(n.componentOffset>-1?bi(n.index,e):e);let c=KT(e,t,i,o),l=s.__ngNextListenerFn__;for(;l;)c=KT(e,t,l,o)&&c,l=l.__ngNextListenerFn__;return r&&!1===c&&o.preventDefault(),c}}function Ui(n=1){return function g3(n){return($e.lFrame.contextLView=function _3(n,e){for(;n>0;)e=e[Ka],n--;return e}(n,$e.lFrame.contextLView))[Jt]}(n)}function AH(n,e){let t=null;const i=function wU(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?BM(n,s,!0):EU(i,s))return r}else t=r}return t}function ws(n){const e=ne()[hn][Kn];if(!e.projection){const i=e.projection=hu(n?n.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){const o=n?AH(s,n):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}function oi(n,e=0,t){const i=ne(),r=bt(),s=wc(r,gt+n,16,null,t||null);null===s.projection&&(s.projection=e),T_(),(!i[ps]||tc())&&32!=(32&s.flags)&&function PB(n,e,t){_S(e[Qe],0,e,t,nv(n,t,e),dS(t.parent||e[Kn],t,e))}(r,i,s)}function zf(n,e){return n<<17|e<<2}function lo(n){return n>>17&32767}function ry(n){return 2|n}function ea(n){return(131068&n)>>2}function sy(n,e){return-131069&n|e<<2}function oy(n){return 1|n}function cC(n,e,t,i,r){const s=n[t+1],o=null===e;let a=i?lo(s):ea(s),c=!1;for(;0!==a&&(!1===c||o);){const u=n[a+1];NH(n[a],e)&&(c=!0,n[a+1]=i?oy(u):ry(u)),a=i?lo(u):ea(u)}c&&(n[t+1]=i?ry(s):oy(s))}function NH(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&dc(n,e)>=0}function Fu(n,e,t){return vr(n,e,t,!1),Fu}function er(n,e){return vr(n,e,null,!0),er}function vr(n,e,t,i){const r=ne(),s=bt(),o=function gs(n){const e=$e.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}(2);s.firstUpdatePass&&function gC(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[si()],o=function mC(n,e){return e>=n.expandoStartIndex}(n,t);(function bC(n,e){return 0!=(n.flags&(e?8:16))})(s,i)&&null===e&&!o&&(e=!1),e=function GH(n,e,t,i){const r=A_(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=ku(t=ay(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=ay(r,n,e,t,i),null===s){let c=function WH(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==ea(i))return n[lo(i)]}(n,e,i);void 0!==c&&Array.isArray(c)&&(c=ay(null,n,e,c[1],i),c=ku(c,e.attrs,i),function jH(n,e,t,i){n[lo(t?e.classBindings:e.styleBindings)]=i}(n,e,i,c))}else s=function $H(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=ku(i,n[s].hostAttrs,t);return ku(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function PH(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=lo(o),c=ea(o);n[i]=t;let u,l=!1;if(Array.isArray(t)?(u=t[1],(null===u||dc(t,u)>0)&&(l=!0)):u=t,r)if(0!==c){const h=lo(n[a+1]);n[i+1]=zf(h,a),0!==h&&(n[h+1]=sy(n[h+1],i)),n[a+1]=function IH(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=zf(a,0),0!==a&&(n[a+1]=sy(n[a+1],i)),a=i;else n[i+1]=zf(c,0),0===a?a=i:n[c+1]=sy(n[c+1],i),c=i;l&&(n[i+1]=ry(n[i+1])),cC(n,u,i,!0),cC(n,u,i,!1),function LH(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&dc(s,e)>=0&&(t[i+1]=oy(t[i+1]))}(e,u,n,i,s),o=zf(a,c),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}(s,n,o,i),e!==et&&Qn(r,o,e)&&function vC(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const c=n.data,l=c[a+1],u=function RH(n){return 1==(1&n)}(l)?yC(c,e,t,r,ea(l),o):void 0;Hf(u)||(Hf(s)||function DH(n){return 2==(2&n)}(l)&&(s=yC(c,null,t,r,a,o)),function NB(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let s=-1===i.indexOf("-")?void 0:wi.DashCase;null==r?n.removeStyle(t,i,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=wi.Important),n.setStyle(t,i,r,s))}}(i,o,Hh(si(),t),r,s))}(s,s.data[si()],r,r[Qe],n,r[o+1]=function ZH(n,e){return null==n||""===n||("string"==typeof e?n+=e:"object"==typeof n&&(n=xn(Fi(n)))),n}(e,t),i,o)}function ay(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=ku(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function ku(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Oi(n,o,!!t||e[++s]))}return void 0===n?null:n}function yC(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const c=n[r],l=Array.isArray(c),u=l?c[1]:c,d=null===u;let h=t[r+1];h===et&&(h=d?wt:void 0);let f=d?V_(h,i):u===i?h:void 0;if(l&&!Hf(f)&&(f=V_(c,i)),Hf(f)&&(a=f,o))return a;const p=n[r+1];r=o?lo(p):ea(p)}if(null!==e){let c=s?e.residualClasses:e.residualStyles;null!=c&&(a=V_(c,i))}return a}function Hf(n){return void 0!==n}function Gf(n,e=""){const t=ne(),i=bt(),r=n+gt,s=i.firstCreatePass?wc(i,r,1,e,null):i.data[r],o=wC(i,t,s,e,n);t[r]=o,Wh()&&hf(i,t,o,s),Vr(s,!1)}let wC=(n,e,t,i,r)=>(so(!0),function lf(n,e){return n.createText(e)}(e[Qe],i));function cy(n){return Wf("",n,""),cy}function Wf(n,e,t){const i=ne(),r=function Mc(n,e,t,i){return Qn(n,rc(),t)?e+Ye(t)+i:et}(i,n,e,t);return r!==et&&function ys(n,e,t){const i=Hh(e,n);!function sS(n,e,t){n.setValue(e,t)}(n[Qe],i,t)}(i,si(),r),Wf}function ly(n,e,t){const i=ne();if(Qn(i,rc(),e)){const s=bt(),o=jt();ki(s,o,i,n,e,xT(A_(s.data),o,i),t,!0)}return ly}const Nc="en-US";let HC=Nc;function hy(n,e,t,i,r){if(n=qe(n),Array.isArray(n))for(let s=0;s<n.length;s++)hy(n[s],e,t,i,r);else{const s=bt(),o=ne();let a=Ko(n)?n:qe(n.provide),c=VS(n);const l=Gn(),u=1048575&l.providerIndexes,d=l.directiveStart,h=l.providerIndexes>>20;if(Ko(n)||!n.multi){const f=new au(c,r,oe),p=py(a,e,r?u:u+h,d);-1===p?(k_(Kh(l,o),s,a),fy(s,n,e.length),e.push(a),l.directiveStart++,l.directiveEnd++,r&&(l.providerIndexes+=1048576),t.push(f),o.push(f)):(t[p]=f,o[p]=f)}else{const f=py(a,e,u+h,d),p=py(a,e,u,u+h),g=p>=0&&t[p];if(r&&!g||!r&&!(f>=0&&t[f])){k_(Kh(l,o),s,a);const m=function g5(n,e,t,i,r){const s=new au(n,t,oe);return s.multi=[],s.index=e,s.componentProviders=0,fA(s,r,i&&!t),s}(r?m5:p5,t.length,r,i,c);!r&&g&&(t[p].providerFactory=m),fy(s,n,e.length,0),e.push(a),l.directiveStart++,l.directiveEnd++,r&&(l.providerIndexes+=1048576),t.push(m),o.push(m)}else fy(s,n,f>-1?f:p,fA(t[r?p:f],c,!r&&i));!r&&i&&g&&t[p].componentProviders++}}}function fy(n,e,t,i){const r=Ko(e),s=function pV(n){return!!n.useClass}(e);if(r||s){const c=(s?qe(e.useClass):e).prototype.ngOnDestroy;if(c){const l=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const u=l.indexOf(t);-1===u?l.push(t,[i,c]):l[u+1].push(i,c)}else l.push(t,c)}}}function fA(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function py(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function p5(n,e,t,i){return my(this.multi,[])}function m5(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=qo(t,t[be],this.providerFactory.index,i);s=a.slice(0,o),my(r,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],my(r,s);return s}function my(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function Gu(n,e=[]){return t=>{t.providersResolver=(i,r)=>function f5(n,e,t){const i=bt();if(i.firstCreatePass){const r=mr(n);hy(t,i.data,i.blueprint,r,!0),hy(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class Oc{}class pA{}class gy extends Oc{constructor(e,t,i){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new ST(this);const r=Li(e);this._bootstrapComponents=vs(r.bootstrap),this._r3Injector=lT(e,t,[{provide:Oc,useValue:this},{provide:Tf,useValue:this.componentFactoryResolver},...i],xn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class _y extends pA{constructor(e){super(),this.moduleType=e}create(e){return new gy(this.moduleType,e,[])}}class mA extends Oc{constructor(e){super(),this.componentFactoryResolver=new ST(this),this.instance=null;const t=new _v([...e.providers,{provide:Oc,useValue:this},{provide:Tf,useValue:this.componentFactoryResolver}],e.parent||bf(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function vy(n,e,t=null){return new mA({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let y5=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t.id)){const i=FS(0,t.type),r=i.length>0?vy([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t.id,r)}return this.cachedInjectors.get(t.id)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=xe({token:n,providedIn:"environment",factory:()=>new n(re(Gr))}),n})();function gA(n){n.getStandaloneInjector=e=>e.get(y5).getOrCreateStandaloneInjector(n)}function MA(n,e,t,i,r,s){const o=e+t;return Qn(n,o,r)?function qr(n,e,t){return n[e]=t}(n,o+1,s?i.call(s,r):i(r)):function Wu(n,e){const t=n[e];return t===et?void 0:t}(n,o+1)}function DA(n,e,t){const i=n+gt,r=ne(),s=ec(r,i);return function ju(n,e){return n[be].data[e].pure}(r,i)?MA(r,function ri(){const n=$e.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}(),e,s.transform,t,s):s.transform(t)}function by(n){return e=>{setTimeout(n,void 0,e)}}const Tn=class G5 extends Kt{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let r=e,s=t||(()=>null),o=i;if(e&&"object"==typeof e){const c=e;r=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=by(s),r&&(r=by(r)),o&&(o=by(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof ni&&e.add(a),a}};function W5(){return this._results[Symbol.iterator]()}class Yf{get changes(){return this._changes||(this._changes=new Tn)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Yf.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=W5)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=function Ji(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function k3(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let xs=(()=>{class n{}return n.__NG_ELEMENT_ID__=q5,n})();const j5=xs,$5=class extends j5{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t,null)}createEmbeddedViewImpl(e,t,i){const r=this._declarationTContainer.tView,s=If(this._declarationLView,r,e,16,null,r.declTNode,null,null,null,t||null,i||null);s[iu]=this._declarationLView[this._declarationTContainer.index];const a=this._declarationLView[Fr];return null!==a&&(s[Fr]=a.createEmbeddedView(r)),Wv(r,s,e),new Iu(s)}};function q5(){return Zf(Gn(),ne())}function Zf(n,e){return 4&n.type?new $5(e,n,vc(n,e)):null}let br=(()=>{class n{}return n.__NG_ELEMENT_ID__=eG,n})();function eG(){return OA(Gn(),ne())}const tG=br,LA=class extends tG{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return vc(this._hostTNode,this._hostLView)}get injector(){return new oc(this._hostTNode,this._hostLView)}get parentInjector(){const e=F_(this._hostTNode,this._hostLView);if(TE(e)){const t=Yh(e,this._hostLView),i=Xh(e);return new oc(t[be].data[i+8],t)}return new oc(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=NA(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-Hn}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const a=e.createEmbeddedViewImpl(t||{},s,null);return this.insertImpl(a,r,false),a}createComponent(e,t,i,r,s){const o=e&&!function uu(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const _=t||{};a=_.index,i=_.injector,r=_.projectableNodes,s=_.environmentInjector||_.ngModuleRef}const c=o?e:new Ru(Mt(e)),l=i||this.parentInjector;if(!s&&null==c.ngModule){const g=(o?l:this.parentInjector).get(Gr,null);g&&(s=g)}Mt(c.componentType??{});const f=c.create(l,r,null,s);return this.insertImpl(f.hostView,a,false),f}insert(e,t){return this.insertImpl(e,t,!1)}insertImpl(e,t,i){const r=e._lView,s=r[be];if(function QU(n){return vi(n[Wt])}(r)){const c=this.indexOf(e);if(-1!==c)this.detach(c);else{const l=r[Wt],u=new LA(l,l[Kn],l[Wt]);u.detach(u.indexOf(e))}}const o=this._adjustIndex(t),a=this._lContainer;if(function TB(n,e,t,i){const r=Hn+i,s=t.length;i>0&&(t[r-1][pr]=e),i<s-Hn?(e[pr]=t[r],UE(t,Hn+i,e)):(t.push(e),e[pr]=null),e[Wt]=t;const o=e[iu];null!==o&&t!==o&&function CB(n,e){const t=n[Qa];e[hn]!==e[Wt][Wt][hn]&&(n[$M]=!0),null===t?n[Qa]=[e]:t.push(e)}(o,e);const a=e[Fr];null!==a&&a.insertView(n),e[tt]|=128}(s,r,a,o),!i){const c=rv(o,a),l=r[Qe],u=df(l,a[kr]);null!==u&&function MB(n,e,t,i,r,s){i[Mn]=r,i[Kn]=e,vu(n,i,t,1,r,s)}(s,a[Kn],l,r,u,c)}return e.attachToViewContainerRef(),UE(xy(a),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=NA(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=ev(this._lContainer,t);i&&(ef(xy(this._lContainer),t),aS(i[be],i))}detach(e){const t=this._adjustIndex(e,-1),i=ev(this._lContainer,t);return i&&null!=ef(xy(this._lContainer),t)?new Iu(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function NA(n){return n[kh]}function xy(n){return n[kh]||(n[kh]=[])}function OA(n,e){let t;const i=e[n.index];return vi(i)?t=i:(t=vT(i,e,null,n),e[n.index]=t,Rf(e,t)),FA(t,e,n,i),new LA(t,n,e)}let FA=function kA(n,e,t,i){if(n[kr])return;let r;r=8&t.type?Ut(i):function nG(n,e){const t=n[Qe],i=t.createComment(""),r=yi(e,n);return Yo(t,df(t,r),i,function RB(n,e){return n.nextSibling(e)}(t,r),!1),i}(e,t),n[kr]=r};class My{constructor(e){this.queryList=e,this.matches=null}clone(){return new My(this.queryList)}setDirty(){this.queryList.setDirty()}}class Ey{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new Ey(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==HA(e,t).matches&&this.queries[t].setDirty()}}class UA{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class Sy{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new Sy(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class Ty{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new Ty(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,sG(t,s)),this.matchTNodeWithReadOption(e,t,Jh(t,e,s,!1,!1))}else i===xs?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Jh(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===On||r===br||r===xs&&4&t.type)this.addMatch(t.index,-2);else{const s=Jh(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function sG(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function aG(n,e,t,i){return-1===t?function oG(n,e){return 11&n.type?vc(n,e):4&n.type?Zf(n,e):null}(e,n):-2===t?function cG(n,e,t){return t===On?vc(e,n):t===xs?Zf(e,n):t===br?OA(e,n):void 0}(n,e,i):qo(n,n[be],t,e)}function BA(n,e,t,i){const r=e[Fr].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let c=0;c<o.length;c+=2){const l=o[c];a.push(l<0?null:aG(e,s[l],o[c+1],t.metadata.read))}r.matches=a}return r.matches}function Cy(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=BA(n,e,r,t);for(let a=0;a<s.length;a+=2){const c=s[a];if(c>0)i.push(o[a/2]);else{const l=s[a+1],u=e[-c];for(let d=Hn;d<u.length;d++){const h=u[d];h[iu]===h[Wt]&&Cy(h[be],h,l,i)}if(null!==u[Qa]){const d=u[Qa];for(let h=0;h<d.length;h++){const f=d[h];Cy(f[be],f,l,i)}}}}}return i}function Ms(n){const e=ne(),t=bt(),i=gE();D_(i+1);const r=HA(t,i);if(n.dirty&&function JU(n){return 4==(4&n[tt])}(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?Cy(t,e,i,[]):BA(t,e,r,i);n.reset(s,NV),n.notifyOnChanges()}return!0}return!1}function Kf(n,e,t){const i=bt();i.firstCreatePass&&(zA(i,new UA(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),VA(i,ne(),e)}function Fc(n,e,t,i){const r=bt();if(r.firstCreatePass){const s=Gn();zA(r,new UA(e,t,i),s.index),function uG(n,e){const t=n.contentQueries||(n.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(n.queries.length-1,e)}(r,n),2==(2&t)&&(r.staticContentQueries=!0)}VA(r,ne(),t)}function Es(){return function lG(n,e){return n[Fr].queries[e].queryList}(ne(),gE())}function VA(n,e,t){const i=new Yf(4==(4&t));(function iz(n,e,t,i){const r=bT(e);r.push(t),n.firstCreatePass&&wT(n).push(i,r.length-1)})(n,e,i,i.destroy),null===e[Fr]&&(e[Fr]=new Ey),e[Fr].queries.push(new My(i))}function zA(n,e,t){null===n.queries&&(n.queries=new Sy),n.queries.track(new Ty(e,t))}function HA(n,e){return n.queries.getByIndex(e)}const Ly=new pe("Application Initializer");let Ny=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),this.appInits=_e(Ly,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const r of this.appInits){const s=r();if(Vf(s))t.push(s);else if(YT(s)){const o=new Promise((a,c)=>{s.subscribe({complete:a,error:c})});t.push(o)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),sD=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const Zr=new pe("LocaleId",{providedIn:"root",factory:()=>_e(Zr,Ge.Optional|Ge.SkipSelf)||function PG(){return typeof $localize<"u"&&$localize.locale||Nc}()});class NG{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let oD=(()=>{class n{compileModuleSync(t){return new _y(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),s=vs(Li(t).declarations).reduce((o,a)=>{const c=Mt(a);return c&&o.push(new Ru(c)),o},[]);return new NG(i,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const kG=(()=>Promise.resolve(0))();function Oy(n){typeof Zone>"u"?kG.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}function lD(...n){}class at{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Tn(!1),this.onMicrotaskEmpty=new Tn(!1),this.onStable=new Tn(!1),this.onError=new Tn(!1),typeof Zone>"u")throw new J(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function UG(){let n=Ot.requestAnimationFrame,e=Ot.cancelAnimationFrame;if(typeof Zone<"u"&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function zG(n){const e=()=>{!function VG(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Ot,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,ky(n),n.isCheckStableRunning=!0,Fy(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),ky(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{try{return uD(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),dD(n)}},onInvoke:(t,i,r,s,o,a,c)=>{try{return uD(n),t.invoke(r,s,o,a,c)}finally{n.shouldCoalesceRunChangeDetection&&e(),dD(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,ky(n),Fy(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!at.isInAngularZone())throw new J(909,!1)}static assertNotInAngularZone(){if(at.isInAngularZone())throw new J(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,BG,lD,lD);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const BG={};function Fy(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function ky(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function uD(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function dD(n){n._nesting--,Fy(n)}class HG{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Tn,this.onMicrotaskEmpty=new Tn,this.onStable=new Tn,this.onError=new Tn}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}const hD=new pe("",{providedIn:"root",factory:fD});function fD(){const n=_e(at);let e=!0;return wM(new Nt(r=>{e=n.isStable&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks,n.runOutsideAngular(()=>{r.next(e),r.complete()})}),new Nt(r=>{let s;n.runOutsideAngular(()=>{s=n.onStable.subscribe(()=>{at.assertNotInAngularZone(),Oy(()=>{!e&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks&&(e=!0,r.next(!0))})})});const o=n.onUnstable.subscribe(()=>{at.assertInAngularZone(),e&&(e=!1,n.runOutsideAngular(()=>{r.next(!1)}))});return()=>{s.unsubscribe(),o.unsubscribe()}}).pipe(xM()))}const pD=new pe(""),Qf=new pe("");let Vy,Uy=(()=>{class n{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Vy||(function GG(n){Vy=n}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{at.assertNotInAngularZone(),Oy(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Oy(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(re(at),re(By),re(Qf))},n.\u0275prov=xe({token:n,factory:n.\u0275fac}),n})(),By=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return Vy?.findTestabilityInTree(this,t,i)??null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),uo=null;const mD=new pe("AllowMultipleToken"),zy=new pe("PlatformDestroyListeners"),ep=new pe("appBootstrapListener");class _D{constructor(e,t){this.name=e,this.token=t}}function yD(n,e,t=[]){const i=`Platform: ${e}`,r=new pe(i);return(s=[])=>{let o=Hy();if(!o||o.injector.get(mD,!1)){const a=[...t,...s,{provide:r,useValue:!0}];n?n(a):function $G(n){if(uo&&!uo.get(mD,!1))throw new J(400,!1);(function gD(){!function HU(n){JM=n}(()=>{throw new J(600,!1)})})(),uo=n;const e=n.get(wD);(function vD(n){n.get(zS,null)?.forEach(t=>t())})(n)}(function bD(n=[],e){return jr.create({name:e,providers:[{provide:mv,useValue:"platform"},{provide:zy,useValue:new Set([()=>uo=null])},...n]})}(a,i))}return function XG(n){const e=Hy();if(!e)throw new J(401,!1);return e}()}}function Hy(){return uo?.get(wD)??null}let wD=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function YG(n="zone.js",e){return"noop"===n?new HG:"zone.js"===n?new at(e):n}(i?.ngZone,function xD(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const s=function v5(n,e,t){return new gy(n,e,t)}(t.moduleType,this.injector,function CD(n){return[{provide:at,useFactory:n},{provide:xu,multi:!0,useFactory:()=>{const e=_e(KG,{optional:!0});return()=>e.initialize()}},{provide:TD,useFactory:ZG},{provide:hD,useFactory:fD}]}(()=>r)),o=s.injector.get(Wr,null);return r.runOutsideAngular(()=>{const a=r.onError.subscribe({next:c=>{o.handleError(c)}});s.onDestroy(()=>{tp(this._modules,s),a.unsubscribe()})}),function MD(n,e,t){try{const i=t();return Vf(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(o,r,()=>{const a=s.injector.get(Ny);return a.runInitializers(),a.donePromise.then(()=>(function GC(n){Ki(n,"Expected localeId to be defined"),"string"==typeof n&&(HC=n.toLowerCase().replace(/_/g,"-"))}(s.injector.get(Zr,Nc)||Nc),this._moduleDoBootstrap(s),s))})})}bootstrapModule(t,i=[]){const r=ED({},i);return function WG(n,e,t){const i=new _y(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(na);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new J(-403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new J(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(zy,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(re(jr))},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function ED(n,e){return Array.isArray(e)?e.reduce(ED,n):{...n,...e}}let na=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=_e(TD),this.componentTypes=[],this.components=[],this.isStable=_e(hD),this._injector=_e(Gr)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,i){const r=t instanceof qS;if(!this._injector.get(Ny).done)throw!r&&function Xa(n){const e=Mt(n)||Zn(n)||_i(n);return null!==e&&e.standalone}(t),new J(405,!1);let o;o=r?t:this._injector.get(Tf).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function jG(n){return n.isBoundToModule}(o)?void 0:this._injector.get(Oc),l=o.create(jr.NULL,[],i||o.selector,a),u=l.location.nativeElement,d=l.injector.get(pD,null);return d?.registerApplication(u),l.onDestroy(()=>{this.detachView(l.hostView),tp(this.components,l),d?.unregisterApplication(u)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new J(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this.internalErrorHandler(t)}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;tp(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(ep,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>tp(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new J(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function tp(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const TD=new pe("",{providedIn:"root",factory:()=>_e(Wr).handleError.bind(void 0)});function ZG(){const n=_e(at),e=_e(Wr);return t=>n.runOutsideAngular(()=>e.handleError(t))}let KG=(()=>{class n{constructor(){this.zone=_e(at),this.applicationRef=_e(na)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();let Bc=(()=>{class n{}return n.__NG_ELEMENT_ID__=QG,n})();function QG(n){return function eW(n,e,t){if(Wo(n)&&!t){const i=bi(n.index,e);return new Iu(i,i)}return 47&n.type?new Iu(e[hn],e):null}(Gn(),ne(),16==(16&n))}class RD{constructor(){}supports(e){return Of(e)}create(e){return new oW(e)}}const sW=(n,e)=>e;class oW{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||sW}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<LD(i,r,s)?t:i,a=LD(o,r,s),c=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const l=a-r,u=c-r;if(l!=u){for(let h=0;h<l;h++){const f=h<s.length?s[h]:s[h]=0,p=f+h;u<=p&&p<l&&(s[h]=f+1)}s[o.previousIndex]=u-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Of(e))throw new J(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function Qz(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Symbol.iterator]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new aW(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new PD),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new PD),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class aW{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class cW{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class PD{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new cW,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function LD(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class ND{constructor(){}supports(e){return e instanceof Map||qv(e)}create(){return new lW}}class lW{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||qv(e)))throw new J(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new uW(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class uW{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function OD(){return new rp([new RD])}let rp=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||OD()),deps:[[n,new fu,new Xo]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new J(901,!1)}}return n.\u0275prov=xe({token:n,providedIn:"root",factory:OD}),n})();function FD(){return new qu([new ND])}let qu=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||FD()),deps:[[n,new fu,new Xo]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new J(901,!1)}}return n.\u0275prov=xe({token:n,providedIn:"root",factory:FD}),n})();const fW=yD(null,"core",[]);let pW=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(re(na))},n.\u0275mod=Yn({type:n}),n.\u0275inj=zn({}),n})(),HD=(()=>{class n{get whenAllTasksComplete(){return 0===this.collection.size&&this.complete(),this.promise}constructor(){this.taskId=0,this.collection=new Set,this.ngZone=_e(at),this.completed=!1,this.ngZone.runOutsideAngular(()=>{this.promise=new Promise(t=>{this.resolve=t})})}add(){if(this.completed)return-1;const t=this.taskId++;return this.collection.add(t),t}remove(t){this.completed||(this.collection.delete(t),0===this.collection.size&&this.complete())}ngOnDestroy(){this.complete(),this.collection.clear()}complete(){this.completed=!0,this.resolve()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Zy=null;function Vc(){return Zy}class TW{}const Ct=new pe("DocumentToken");let Ky=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=xe({token:n,factory:function(){return _e(AW)},providedIn:"platform"}),n})();const CW=new pe("Location Initialized");let AW=(()=>{class n extends Ky{constructor(){super(),this._doc=_e(Ct),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Vc().getBaseHref(this._doc)}onPopState(t){const i=Vc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Vc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=xe({token:n,factory:function(){return new n},providedIn:"platform"}),n})();function Jy(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function WD(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Ss(n){return n&&"?"!==n[0]?"?"+n:n}let ra=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=xe({token:n,factory:function(){return _e($D)},providedIn:"root"}),n})();const jD=new pe("appBaseHref");let $D=(()=>{class n extends ra{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??_e(Ct).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Jy(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+Ss(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+Ss(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+Ss(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(re(Ky),re(jD,8))},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),DW=(()=>{class n extends ra{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=Jy(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let o=this.prepareExternalUrl(r+Ss(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){let o=this.prepareExternalUrl(r+Ss(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(re(Ky),re(jD,8))},n.\u0275prov=xe({token:n,factory:n.\u0275fac}),n})(),Qy=(()=>{class n{constructor(t){this._subject=new Tn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function PW(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(WD(qD(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+Ss(i))}normalize(t){return n.stripTrailingSlash(function RW(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,qD(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ss(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ss(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}}return n.normalizeQueryParams=Ss,n.joinWithSlash=Jy,n.stripTrailingSlash=WD,n.\u0275fac=function(t){return new(t||n)(re(ra))},n.\u0275prov=xe({token:n,factory:function(){return function IW(){return new Qy(re(ra))}()},providedIn:"root"}),n})();function qD(n){return n.replace(/\/index.html$/,"")}function n1(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}class _8{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let o1=(()=>{class n{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new _8(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const a=i.get(s);i.move(a,o),a1(a,r)}});for(let r=0,s=i.length;r<s;r++){const a=i.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{a1(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(oe(br),oe(xs),oe(rp))},n.\u0275dir=Ln({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function a1(n,e){n.context.$implicit=e.item}let Zu=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new v8,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){c1("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){c1("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(oe(br),oe(xs))},n.\u0275dir=Ln({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class v8{constructor(){this.$implicit=null,this.ngIf=null}}function c1(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${xn(e)}'.`)}let u1=(()=>{class n{constructor(t){this.differs=t,this.keyValues=[],this.compareFn=d1}transform(t,i=d1){if(!t||!(t instanceof Map)&&"object"!=typeof t)return null;this.differ||(this.differ=this.differs.find(t).create());const r=this.differ.diff(t),s=i!==this.compareFn;return r&&(this.keyValues=[],r.forEachItem(o=>{this.keyValues.push(function U8(n,e){return{key:n,value:e}}(o.key,o.currentValue))})),(r||s)&&(this.keyValues.sort(i),this.compareFn=i),this.keyValues}}return n.\u0275fac=function(t){return new(t||n)(oe(qu,16))},n.\u0275pipe=gi({name:"keyvalue",type:n,pure:!1,standalone:!0}),n})();function d1(n,e){const t=n.key,i=e.key;if(t===i)return 0;if(void 0===t)return 1;if(void 0===i)return-1;if(null===t)return 1;if(null===i)return-1;if("string"==typeof t&&"string"==typeof i)return t<i?-1:1;if("number"==typeof t&&"number"==typeof i)return t-i;if("boolean"==typeof t&&"boolean"==typeof i)return t<i?-1:1;const r=String(t),s=String(i);return r==s?0:r<s?-1:1}let h1=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=zn({}),n})();const f1="browser";function p1(n){return"server"===n}let $8=(()=>{class n{}return n.\u0275prov=xe({token:n,providedIn:"root",factory:()=>new q8(re(Ct),window)}),n})();class q8{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function X8(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&"function"==typeof n.body.attachShadow){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=m1(this.window.history)||m1(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function m1(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class g1{}class wj extends TW{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class _0 extends wj{static makeCurrent(){!function SW(n){Zy||(Zy=n)}(new _0)}onAndCancel(e,t,i){return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function xj(){return Ju=Ju||document.querySelector("base"),Ju?Ju.getAttribute("href"):null}();return null==t?null:function Mj(n){vp=vp||document.createElement("a"),vp.setAttribute("href",n);const e=vp.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Ju=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return n1(document.cookie,e)}}let vp,Ju=null,Sj=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=xe({token:n,factory:n.\u0275fac}),n})();const v0=new pe("EventManagerPlugins");let w1=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(s=>s.supports(t)),!i)throw new J(5101,!1);return this._eventNameToPlugin.set(t,i),i}}return n.\u0275fac=function(t){return new(t||n)(re(v0),re(at))},n.\u0275prov=xe({token:n,factory:n.\u0275fac}),n})();class x1{constructor(e){this._doc=e}}const y0="ng-app-id";let M1=(()=>{class n{constructor(t,i,r,s={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=p1(s),this.resetHostNodes()}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${y0}="${this.appId}"]`);if(t?.length){const i=new Map;return t.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){const r=this.styleRef;if(r.has(t)){const s=r.get(t);return s.usage+=i,s.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){const r=this.styleNodesInDOM,s=r?.get(i);if(s?.parentNode===t)return r.delete(i),s.removeAttribute(y0),s;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute(y0,this.appId),o}}addStyleToHost(t,i){const r=this.getStyleElement(t,i);t.appendChild(r);const s=this.styleRef,o=s.get(i)?.elements;o?o.push(r):s.set(i,{elements:[r],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}}return n.\u0275fac=function(t){return new(t||n)(re(Ct),re(wf),re(bv,8),re(oo))},n.\u0275prov=xe({token:n,factory:n.\u0275fac}),n})();const b0={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},w0=/%COMP%/g,Dj=new pe("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function S1(n,e){return e.map(t=>t.replace(w0,n))}let x0=(()=>{class n{constructor(t,i,r,s,o,a,c,l=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestory=s,this.doc=o,this.platformId=a,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=p1(a),this.defaultRenderer=new M0(t,o,c,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===mi.ShadowDom&&(i={...i,encapsulation:mi.Emulated});const r=this.getOrCreateRenderer(t,i);return r instanceof C1?r.applyToHost(t):r instanceof E0&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const o=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,u=this.removeStylesOnCompDestory,d=this.platformIsServer;switch(i.encapsulation){case mi.Emulated:s=new C1(c,l,i,this.appId,u,o,a,d);break;case mi.ShadowDom:return new Lj(c,l,t,i,o,a,this.nonce,d);default:s=new E0(c,l,i,u,o,a,d)}s.onDestroy=()=>r.delete(i.id),r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}}return n.\u0275fac=function(t){return new(t||n)(re(w1),re(M1),re(wf),re(Dj),re(Ct),re(oo),re(at),re(bv))},n.\u0275prov=xe({token:n,factory:n.\u0275fac}),n})();class M0{constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(b0[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(T1(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(T1(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?this.doc.querySelector(e):e;if(!i)throw new J(5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=b0[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=b0[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(wi.DashCase|wi.Important)?e.style.setProperty(t,i,r&wi.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&wi.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){if("string"==typeof e&&!(e=Vc().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(i))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function T1(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class Lj extends M0{constructor(e,t,i,r,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=S1(r.id,r.styles);for(const u of l){const d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=u,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class E0 extends M0{constructor(e,t,i,r,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestory=r,this.rendererUsageCount=0,this.styles=c?S1(c,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class C1 extends E0{constructor(e,t,i,r,s,o,a,c){const l=r+"-"+i.id;super(e,t,i,s,o,a,c,l),this.contentAttr=function Ij(n){return"_ngcontent-%COMP%".replace(w0,n)}(l),this.hostAttr=function Rj(n){return"_nghost-%COMP%".replace(w0,n)}(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let Nj=(()=>{class n extends x1{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(re(Ct))},n.\u0275prov=xe({token:n,factory:n.\u0275fac}),n})();const A1=["alt","control","meta","shift"],Oj={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Fj={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let kj=(()=>{class n extends x1{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Vc().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),A1.forEach(l=>{const u=i.indexOf(l);u>-1&&(i.splice(u,1),o+=l+".")}),o+=s,0!=i.length||0===s.length)return null;const c={};return c.domEventName=r,c.fullKey=o,c}static matchEventFullKeyCode(t,i){let r=Oj[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),A1.forEach(o=>{o!==r&&(0,Fj[o])(t)&&(s+=o+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(re(Ct))},n.\u0275prov=xe({token:n,factory:n.\u0275fac}),n})();const zj=yD(fW,"browser",[{provide:oo,useValue:f1},{provide:zS,useValue:function Uj(){_0.makeCurrent()},multi:!0},{provide:Ct,useFactory:function Vj(){return function BB(n){av=n}(document),document},deps:[]}]),Hj=new pe(""),R1=[{provide:Qf,useClass:class Ej{addToWindow(e){Ot.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new J(5103,!1);return s},Ot.getAllAngularTestabilities=()=>e.getAllTestabilities(),Ot.getAllAngularRootElements=()=>e.getAllRootElements(),Ot.frameworkStabilizers||(Ot.frameworkStabilizers=[]),Ot.frameworkStabilizers.push(i=>{const r=Ot.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(c){o=o||c,s--,0==s&&i(o)};r.forEach(function(c){c.whenStable(a)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?Vc().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:pD,useClass:Uy,deps:[at,By,Qf]},{provide:Uy,useClass:Uy,deps:[at,By,Qf]}],P1=[{provide:mv,useValue:"root"},{provide:Wr,useFactory:function Bj(){return new Wr},deps:[]},{provide:v0,useClass:Nj,multi:!0,deps:[Ct,at,oo]},{provide:v0,useClass:kj,multi:!0,deps:[Ct]},x0,M1,w1,{provide:Tu,useExisting:x0},{provide:g1,useClass:Sj,deps:[]},[]];let L1=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:wf,useValue:t.appId}]}}}return n.\u0275fac=function(t){return new(t||n)(re(Hj,12))},n.\u0275mod=Yn({type:n}),n.\u0275inj=zn({providers:[...P1,...R1],imports:[h1,pW]}),n})(),N1=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return n.\u0275fac=function(t){return new(t||n)(re(Ct))},n.\u0275prov=xe({token:n,factory:function(t){let i=null;return i=t?new t:function Wj(){return new N1(re(Ct))}(),i},providedIn:"root"}),n})();typeof window<"u"&&window;let T0=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=xe({token:n,factory:function(t){let i=null;return i=t?new(t||n):re(k1),i},providedIn:"root"}),n})(),k1=(()=>{class n extends T0{constructor(t){super(),this._doc=t}sanitize(t,i){if(null==i)return null;switch(t){case Et.NONE:return i;case Et.HTML:return Hr(i,"HTML")?Fi(i):DS(this._doc,String(i)).toString();case Et.STYLE:return Hr(i,"Style")?Fi(i):i;case Et.SCRIPT:if(Hr(i,"Script"))return Fi(i);throw new J(5200,!1);case Et.URL:return Hr(i,"URL")?Fi(i):gf(String(i));case Et.RESOURCE_URL:if(Hr(i,"ResourceURL"))return Fi(i);throw new J(5201,!1);default:throw new J(5202,!1)}}bypassSecurityTrustHtml(t){return function $B(n){return new VB(n)}(t)}bypassSecurityTrustStyle(t){return function qB(n){return new zB(n)}(t)}bypassSecurityTrustScript(t){return function XB(n){return new HB(n)}(t)}bypassSecurityTrustUrl(t){return function YB(n){return new GB(n)}(t)}bypassSecurityTrustResourceUrl(t){return function ZB(n){return new WB(n)}(t)}}return n.\u0275fac=function(t){return new(t||n)(re(Ct))},n.\u0275prov=xe({token:n,factory:function(t){let i=null;return i=t?new t:function Xj(n){return new k1(n.get(Ct))}(re(jr)),i},providedIn:"root"}),n})();function Oe(...n){return Pn(n,Zl(n))}class ir extends Kt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}const{isArray:Zj}=Array,{getPrototypeOf:Kj,prototype:Jj,keys:Qj}=Object;function B1(n){if(1===n.length){const e=n[0];if(Zj(e))return{args:e,keys:null};if(function e$(n){return n&&"object"==typeof n&&Kj(n)===Jj}(e)){const t=Qj(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}const{isArray:t$}=Array;function C0(n){return ut(e=>function n$(n,e){return t$(e)?n(...e):n(e)}(n,e))}function V1(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function yp(...n){const e=Zl(n),t=_M(n),{args:i,keys:r}=B1(n);if(0===i.length)return Pn([],e);const s=new Nt(function i$(n,e,t=Js){return i=>{z1(e,()=>{const{length:r}=n,s=new Array(r);let o=r,a=r;for(let c=0;c<r;c++)z1(e,()=>{const l=Pn(n[c],e);let u=!1;l.subscribe(Gt(i,d=>{s[c]=d,u||(u=!0,a--),a||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>V1(r,o):Js));return t?s.pipe(C0(t)):s}function z1(n,e,t){n?us(t,n,e):e()}const bp=Xl(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function wp(...n){return function r$(){return $a(1)}()(Pn(n,Zl(n)))}function H1(n){return new Nt(e=>{ii(n()).subscribe(e)})}function zc(n,e){const t=vt(n)?n:()=>n,i=r=>r.error(t());return new Nt(e?r=>e.schedule(i,0,r):i)}function A0(){return sn((n,e)=>{let t=null;n._refCount++;const i=Gt(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class G1 extends Nt{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,nM(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new ni;const t=this.getSubject();e.add(this.source.subscribe(Gt(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=ni.EMPTY)}return e}refCount(){return A0()(this)}}function Kr(n,e){return sn((t,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();t.subscribe(Gt(i,c=>{r?.unsubscribe();let l=0;const u=s++;ii(n(c,u)).subscribe(r=Gt(i,d=>i.next(e?e(c,d,u,l++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function Er(n){return n<=0?()=>Nr:sn((e,t)=>{let i=0;e.subscribe(Gt(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function xp(...n){const e=Zl(n);return sn((t,i)=>{(e?wp(n,t,e):wp(n,t)).subscribe(i)})}function Wn(n,e){return sn((t,i)=>{let r=0;t.subscribe(Gt(i,s=>n.call(e,s,r++)&&i.next(s)))})}function Mp(n){return sn((e,t)=>{let i=!1;e.subscribe(Gt(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function W1(n=s$){return sn((e,t)=>{let i=!1;e.subscribe(Gt(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function s$(){return new bp}function sa(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Wn((r,s)=>n(r,s,i)):Js,Er(1),t?Mp(e):W1(()=>new bp))}function Hc(n,e){return vt(e)?Rn(n,e,1):Rn(n,1)}function kn(n,e,t){const i=vt(n)||e||t?{next:n,error:e,complete:t}:n;return i?sn((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(Gt(s,c=>{var l;null===(l=i.next)||void 0===l||l.call(i,c),s.next(c)},()=>{var c;a=!1,null===(c=i.complete)||void 0===c||c.call(i),s.complete()},c=>{var l;a=!1,null===(l=i.error)||void 0===l||l.call(i,c),s.error(c)},()=>{var c,l;a&&(null===(c=i.unsubscribe)||void 0===c||c.call(i)),null===(l=i.finalize)||void 0===l||l.call(i)}))}):Js}function fo(n){return sn((e,t)=>{let s,i=null,r=!1;i=e.subscribe(Gt(t,void 0,void 0,o=>{s=ii(n(o,fo(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function D0(n){return n<=0?()=>Nr:sn((e,t)=>{let i=[];e.subscribe(Gt(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function I0(n){return ut(()=>n)}function Ep(n){return sn((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const it="primary",Qu=Symbol("RouteTitle");class l${constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Gc(n){return new l$(n)}function u$(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],a=n[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function Jr(n,e){const t=n?Object.keys(n):void 0,i=e?Object.keys(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!j1(n[r],e[r]))return!1;return!0}function j1(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function $1(n){return n.length>0?n[n.length-1]:null}function po(n){return function Yj(n){return!!n&&(n instanceof Nt||vt(n.lift)&&vt(n.subscribe))}(n)?n:Vf(n)?Pn(Promise.resolve(n)):Oe(n)}const h$={exact:function Y1(n,e,t){if(!oa(n.segments,e.segments)||!Sp(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!Y1(n.children[i],e.children[i],t))return!1;return!0},subset:Z1},q1={exact:function f$(n,e){return Jr(n,e)},subset:function p$(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>j1(n[t],e[t]))},ignored:()=>!0};function X1(n,e,t){return h$[t.paths](n.root,e.root,t.matrixParams)&&q1[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function Z1(n,e,t){return K1(n,e,e.segments,t)}function K1(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!oa(r,t)||e.hasChildren()||!Sp(r,t,i))}if(n.segments.length===t.length){if(!oa(n.segments,t)||!Sp(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!Z1(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(oa(n.segments,r)&&Sp(n.segments,r,i)&&n.children[it])&&K1(n.children[it],e,s,i)}}function Sp(n,e,t){return e.every((i,r)=>q1[t](n[r].parameters,i.parameters))}class Wc{constructor(e=new Dt([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Gc(this.queryParams)),this._queryParamMap}toString(){return _$.serialize(this)}}class Dt{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Tp(this)}}class ed{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Gc(this.parameters)),this._parameterMap}toString(){return eI(this)}}function oa(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let td=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=xe({token:n,factory:function(){return new R0},providedIn:"root"}),n})();class R0{parse(e){const t=new A$(e);return new Wc(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${nd(e.root,!0)}`,i=function b$(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${Cp(t)}=${Cp(r)}`).join("&"):`${Cp(t)}=${Cp(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function v$(n){return encodeURI(n)}(e.fragment)}`:""}`}}const _$=new R0;function Tp(n){return n.segments.map(e=>eI(e)).join("/")}function nd(n,e){if(!n.hasChildren())return Tp(n);if(e){const t=n.children[it]?nd(n.children[it],!1):"",i=[];return Object.entries(n.children).forEach(([r,s])=>{r!==it&&i.push(`${r}:${nd(s,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function g$(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===it&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==it&&(t=t.concat(e(r,i)))}),t}(n,(i,r)=>r===it?[nd(n.children[it],!1)]:[`${r}:${nd(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[it]?`${Tp(n)}/${t[0]}`:`${Tp(n)}/(${t.join("//")})`}}function J1(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Cp(n){return J1(n).replace(/%3B/gi,";")}function P0(n){return J1(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ap(n){return decodeURIComponent(n)}function Q1(n){return Ap(n.replace(/\+/g,"%20"))}function eI(n){return`${P0(n.path)}${function y$(n){return Object.keys(n).map(e=>`;${P0(e)}=${P0(n[e])}`).join("")}(n.parameters)}`}const w$=/^[^\/()?;#]+/;function L0(n){const e=n.match(w$);return e?e[0]:""}const x$=/^[^\/()?;=#]+/,E$=/^[^=?&#]+/,T$=/^[^&#]+/;class A${constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Dt([],{}):new Dt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[it]=new Dt(e,t)),i}parseSegment(){const e=L0(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new J(4009,!1);return this.capture(e),new ed(Ap(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function M$(n){const e=n.match(x$);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=L0(this.remaining);r&&(i=r,this.capture(i))}e[Ap(t)]=Ap(i)}parseQueryParam(e){const t=function S$(n){const e=n.match(E$);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const o=function C$(n){const e=n.match(T$);return e?e[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=Q1(t),s=Q1(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=L0(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new J(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=it);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[it]:new Dt([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new J(4011,!1)}}function tI(n){return n.segments.length>0?new Dt([],{[it]:n}):n}function nI(n){const e={};for(const i of Object.keys(n.children)){const s=nI(n.children[i]);if(i===it&&0===s.segments.length&&s.hasChildren())for(const[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function D$(n){if(1===n.numberOfChildren&&n.children[it]){const e=n.children[it];return new Dt(n.segments.concat(e.segments),e.children)}return n}(new Dt(n.segments,e))}function aa(n){return n instanceof Wc}function iI(n){let e;const r=tI(function t(s){const o={};for(const c of s.children){const l=t(c);o[c.outlet]=l}const a=new Dt(s.url,o);return s===n&&(e=a),a}(n.root));return e??r}function rI(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(0===e.length)return N0(r,r,r,t,i);const s=function R$(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new oI(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]="string"==typeof l?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,c)=>{0==c&&"."===a||(0==c&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new oI(t,e,i)}(e);if(s.toRoot())return N0(r,r,new Dt([],{}),t,i);const o=function P$(n,e,t){if(n.isAbsolute)return new Ip(e,!0,0);if(!t)return new Ip(e,!1,NaN);if(null===t.parent)return new Ip(t,!0,0);const i=Dp(n.commands[0])?0:1;return function L$(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new J(4005,!1);r=i.segments.length}return new Ip(i,!1,r-s)}(t,t.segments.length-1+i,n.numberOfDoubleDots)}(s,r,n),a=o.processChildren?rd(o.segmentGroup,o.index,s.commands):aI(o.segmentGroup,o.index,s.commands);return N0(r,o.segmentGroup,a,t,i)}function Dp(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function id(n){return"object"==typeof n&&null!=n&&n.outlets}function N0(n,e,t,i,r){let o,s={};i&&Object.entries(i).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`}),o=n===e?t:sI(n,e,t);const a=tI(nI(o));return new Wc(a,s,r)}function sI(n,e,t){const i={};return Object.entries(n.children).forEach(([r,s])=>{i[r]=s===e?t:sI(s,e,t)}),new Dt(n.segments,i)}class oI{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Dp(i[0]))throw new J(4003,!1);const r=i.find(id);if(r&&r!==$1(i))throw new J(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Ip{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function aI(n,e,t){if(n||(n=new Dt([],{})),0===n.segments.length&&n.hasChildren())return rd(n,e,t);const i=function O$(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const o=n.segments[r],a=t[i];if(id(a))break;const c=`${a}`,l=i<t.length-1?t[i+1]:null;if(r>0&&void 0===c)break;if(c&&l&&"object"==typeof l&&void 0===l.outlets){if(!lI(c,l,o))return s;i+=2}else{if(!lI(c,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new Dt(n.segments.slice(0,i.pathIndex),{});return s.children[it]=new Dt(n.segments.slice(i.pathIndex),n.children),rd(s,0,r)}return i.match&&0===r.length?new Dt(n.segments,{}):i.match&&!n.hasChildren()?O0(n,e,t):i.match?rd(n,0,r):O0(n,e,t)}function rd(n,e,t){if(0===t.length)return new Dt(n.segments,{});{const i=function N$(n){return id(n[0])?n[0].outlets:{[it]:n}}(t),r={};if(!i[it]&&n.children[it]&&1===n.numberOfChildren&&0===n.children[it].segments.length){const s=rd(n.children[it],e,t);return new Dt(n.segments,s.children)}return Object.entries(i).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(r[s]=aI(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{void 0===i[s]&&(r[s]=o)}),new Dt(n.segments,r)}}function O0(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(id(s)){const c=F$(s.outlets);return new Dt(i,c)}if(0===r&&Dp(t[0])){i.push(new ed(n.segments[e].path,cI(t[0]))),r++;continue}const o=id(s)?s.outlets[it]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&Dp(a)?(i.push(new ed(o,cI(a))),r+=2):(i.push(new ed(o,{})),r++)}return new Dt(i,{})}function F$(n){const e={};return Object.entries(n).forEach(([t,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(e[t]=O0(new Dt([],{}),0,i))}),e}function cI(n){const e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function lI(n,e,t){return n==t.path&&Jr(e,t.parameters)}const sd="imperative";class Qr{constructor(e,t){this.id=e,this.url=t}}class F0 extends Qr{constructor(e,t,i="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class ca extends Qr{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Rp extends Qr{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class od extends Qr{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=16}}class k0 extends Qr{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class k$ extends Qr{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class U$ extends Qr{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class B$ extends Qr{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class V$ extends Qr{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class z$ extends Qr{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class H${constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class G${constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class W${constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class j${constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class $${constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class q${constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class uI{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class X${constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new ad,this.attachRef=null}}let ad=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new X$,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class dI{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=U0(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=U0(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=B0(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return B0(e,this._root).map(t=>t.value)}}function U0(n,e){if(n===e.value)return e;for(const t of e.children){const i=U0(n,t);if(i)return i}return null}function B0(n,e){if(n===e.value)return[e];for(const t of e.children){const i=B0(n,t);if(i.length)return i.unshift(e),i}return[]}class Cs{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function jc(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class hI extends dI{constructor(e,t){super(e),this.snapshot=t,V0(this,e)}toString(){return this.snapshot.toString()}}function fI(n,e){const t=function Y$(n,e){const o=new Pp([],{},{},"",{},it,e,null,{});return new mI("",new Cs(o,[]))}(0,e),i=new ir([new ed("",{})]),r=new ir({}),s=new ir({}),o=new ir({}),a=new ir(""),c=new la(i,r,o,a,s,it,e,t.root);return c.snapshot=t.root,new hI(new Cs(c,[]),t)}class la{constructor(e,t,i,r,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(ut(l=>l[Qu]))??Oe(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(ut(e=>Gc(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(ut(e=>Gc(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function pI(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const r=t[i],s=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function Z$(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(i))}class Pp{get title(){return this.data?.[Qu]}constructor(e,t,i,r,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Gc(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Gc(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class mI extends dI{constructor(e,t){super(t),this.url=e,V0(this,t)}toString(){return gI(this._root)}}function V0(n,e){e.value._routerState=n,e.children.forEach(t=>V0(n,t))}function gI(n){const e=n.children.length>0?` { ${n.children.map(gI).join(", ")} } `:"";return`${n.value}${e}`}function z0(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Jr(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Jr(e.params,t.params)||n.paramsSubject.next(t.params),function d$(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Jr(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.urlSubject.next(t.url),Jr(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function H0(n,e){const t=Jr(n.params,e.params)&&function m$(n,e){return oa(n,e)&&n.every((t,i)=>Jr(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||H0(n.parent,e.parent))}let G0=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=it,this.activateEvents=new Tn,this.deactivateEvents=new Tn,this.attachEvents=new Tn,this.detachEvents=new Tn,this.parentContexts=_e(ad),this.location=_e(br),this.changeDetector=_e(Bc),this.environmentInjector=_e(Gr),this.inputBinder=_e(Lp,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new J(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new J(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new J(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new J(4013,!1);this._activatedRoute=t;const r=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new K$(t,a,r.injector);this.activated=r.createComponent(o,{index:r.length,injector:c,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=Ln({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[io]}),n})();class K${constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===la?this.route:e===ad?this.childContexts:this.parent.get(e,t)}}const Lp=new pe("");let _I=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:i}=t,r=yp([i.queryParams,i.params,i.data]).pipe(Kr(([s,o,a],c)=>(a={...s,...o,...a},0===c?Oe(a):Promise.resolve(a)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(t);const o=function EW(n){const e=Mt(n);if(!e)return null;const t=new Ru(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone}}}(i.component);if(o)for(const{templateName:a}of o.inputs)t.activatedComponentRef.setInput(a,s[a]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,r)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=xe({token:n,factory:n.\u0275fac}),n})();function cd(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function Q$(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return cd(n,i,r);return cd(n,i)})}(n,e,t);return new Cs(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>cd(n,a)),o}}const i=function e6(n){return new la(new ir(n.url),new ir(n.params),new ir(n.queryParams),new ir(n.fragment),new ir(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>cd(n,s));return new Cs(i,r)}}const W0="ngNavigationCancelingError";function vI(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=aa(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=yI(!1,0,e);return r.url=t,r.navigationBehaviorOptions=i,r}function yI(n,e,t){const i=new Error("NavigationCancelingError: "+(n||""));return i[W0]=!0,i.cancellationCode=e,t&&(i.url=t),i}function bI(n){return wI(n)&&aa(n.url)}function wI(n){return n&&n[W0]}let xI=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Pi({type:n,selectors:[["ng-component"]],standalone:!0,features:[gA],decls:1,vars:0,template:function(t,i){1&t&&ao(0,"router-outlet")},dependencies:[G0],encapsulation:2}),n})();function j0(n){const e=n.children&&n.children.map(j0),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==it&&(t.component=xI),t}function Sr(n){return n.outlet||it}function ld(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class a6{constructor(e,t,i,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),z0(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=jc(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=jc(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=jc(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){const r=jc(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new q$(s.value.snapshot))}),e.children.length&&this.forwardEvent(new j$(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(z0(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),z0(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=ld(r.snapshot);o.attachRef=null,o.route=r,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,i)}}class MI{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Np{constructor(e,t){this.component=e,this.route=t}}function c6(n,e,t){const i=n._root;return ud(i,e?e._root:null,t,[i.value])}function $c(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||function oU(n){return null!==Dh(n)}(n)?e.get(n):n:i}function ud(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=jc(e);return n.children.forEach(o=>{(function u6(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const c=function d6(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!oa(n.url,e.url);case"pathParamsOrQueryParamsChange":return!oa(n.url,e.url)||!Jr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!H0(n,e)||!Jr(n.queryParams,e.queryParams);default:return!H0(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);c?r.canActivateChecks.push(new MI(i)):(s.data=o.data,s._resolvedData=o._resolvedData),ud(n,e,s.component?a?a.children:null:t,i,r),c&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Np(a.outlet.component,o))}else o&&dd(e,a,r),r.canActivateChecks.push(new MI(i)),ud(n,null,s.component?a?a.children:null:t,i,r)})(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>dd(a,t.getContext(o),r)),r}function dd(n,e,t){const i=jc(n),r=n.value;Object.entries(i).forEach(([s,o])=>{dd(o,r.component?e?e.children.getContext(s):null:e,t)}),t.canDeactivateChecks.push(new Np(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function hd(n){return"function"==typeof n}function EI(n){return n instanceof bp||"EmptyError"===n?.name}const Op=Symbol("INITIAL_VALUE");function qc(){return Kr(n=>yp(n.map(e=>e.pipe(Er(1),xp(Op)))).pipe(ut(e=>{for(const t of e)if(!0!==t){if(t===Op)return Op;if(!1===t||t instanceof Wc)return t}return!0}),Wn(e=>e!==Op),Er(1)))}function SI(n){return function mk(...n){return Qx(n)}(kn(e=>{if(aa(e))throw vI(0,e)}),ut(e=>!0===e))}class Fp{constructor(e){this.segmentGroup=e||null}}class TI{constructor(e){this.urlTree=e}}function Xc(n){return zc(new Fp(n))}function CI(n){return zc(new TI(n))}class R6{constructor(e,t){this.urlSerializer=e,this.urlTree=t}noMatchError(e){return new J(4002,!1)}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return Oe(i);if(r.numberOfChildren>1||!r.children[it])return zc(new J(4e3,!1));r=r.children[it]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreateUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new Wc(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Object.entries(e).forEach(([r,s])=>{if("string"==typeof s&&s.startsWith(":")){const a=s.substring(1);i[r]=t[a]}else i[r]=s}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,i,r)}),new Dt(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new J(4001,!1);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}const $0={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function P6(n,e,t,i,r){const s=q0(n,e,t);return s.matched?(i=function t6(n,e){return n.providers&&!n._injector&&(n._injector=vy(n.providers,e,`Route: ${n.path}`)),n._injector??e}(e,i),function A6(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?Oe(r.map(o=>{const a=$c(o,n);return po(function _6(n){return n&&hd(n.canMatch)}(a)?a.canMatch(e,t):n.runInContext(()=>a(e,t)))})).pipe(qc(),SI()):Oe(!0)}(i,e,t).pipe(ut(o=>!0===o?s:{...$0}))):Oe(s)}function q0(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...$0}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||u$)(t,n,e);if(!r)return{...$0};const s={};Object.entries(r.posParams??{}).forEach(([a,c])=>{s[a]=c.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function AI(n,e,t,i){return t.length>0&&function O6(n,e,t){return t.some(i=>kp(n,e,i)&&Sr(i)!==it)}(n,t,i)?{segmentGroup:new Dt(e,N6(i,new Dt(t,n.children))),slicedSegments:[]}:0===t.length&&function F6(n,e,t){return t.some(i=>kp(n,e,i))}(n,t,i)?{segmentGroup:new Dt(n.segments,L6(n,0,t,i,n.children)),slicedSegments:t}:{segmentGroup:new Dt(n.segments,n.children),slicedSegments:t}}function L6(n,e,t,i,r){const s={};for(const o of i)if(kp(n,t,o)&&!r[Sr(o)]){const a=new Dt([],{});s[Sr(o)]=a}return{...r,...s}}function N6(n,e){const t={};t[it]=e;for(const i of n)if(""===i.path&&Sr(i)!==it){const r=new Dt([],{});t[Sr(i)]=r}return t}function kp(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class V6{constructor(e,t,i,r,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.allowRedirects=!0,this.applyRedirects=new R6(this.urlSerializer,this.urlTree)}noMatchError(e){return new J(4002,!1)}recognize(){const e=AI(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,it).pipe(fo(t=>{if(t instanceof TI)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof Fp?this.noMatchError(t):t}),ut(t=>{const i=new Pp([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},it,this.rootComponentType,null,{}),r=new Cs(i,t),s=new mI("",r),o=function I$(n,e,t=null,i=null){return rI(iI(n),e,t,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e.root,it).pipe(fo(i=>{throw i instanceof Fp?this.noMatchError(i):i}))}inheritParamsAndData(e){const t=e.value,i=pI(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,r,!0)}processChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return Pn(r).pipe(Hc(s=>{const o=i.children[s],a=function s6(n,e){const t=n.filter(i=>Sr(i)===e);return t.push(...n.filter(i=>Sr(i)!==e)),t}(t,s);return this.processSegmentGroup(e,a,o,s)}),function a$(n,e){return sn(function o$(n,e,t,i,r){return(s,o)=>{let a=t,c=e,l=0;s.subscribe(Gt(o,u=>{const d=l++;c=a?n(c,u,d):(a=!0,u),i&&o.next(c)},r&&(()=>{a&&o.next(c),o.complete()})))}}(n,e,arguments.length>=2,!0))}((s,o)=>(s.push(...o),s)),Mp(null),function c$(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Wn((r,s)=>n(r,s,i)):Js,D0(1),t?Mp(e):W1(()=>new bp))}(),Rn(s=>{if(null===s)return Xc(i);const o=DI(s);return function z6(n){n.sort((e,t)=>e.value.outlet===it?-1:t.value.outlet===it?1:e.value.outlet.localeCompare(t.value.outlet))}(o),Oe(o)}))}processSegment(e,t,i,r,s,o){return Pn(t).pipe(Hc(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,i,r,s,o).pipe(fo(c=>{if(c instanceof Fp)return Oe(null);throw c}))),sa(a=>!!a),fo(a=>{if(EI(a))return function U6(n,e,t){return 0===e.length&&!n.children[t]}(i,r,s)?Oe([]):Xc(i);throw a}))}processSegmentAgainstRoute(e,t,i,r,s,o,a){return function k6(n,e,t,i){return!!(Sr(n)===i||i!==it&&kp(e,t,n))&&("**"===n.path||q0(e,n,t).matched)}(i,r,s,o)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,r,i,s,o,a):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,s,o):Xc(r):Xc(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,r){const s=this.applyRedirects.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?CI(s):this.applyRedirects.lineralizeSegments(i,s).pipe(Rn(o=>{const a=new Dt(o,{});return this.processSegment(e,t,a,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){const{matched:a,consumedSegments:c,remainingSegments:l,positionalParamSegments:u}=q0(t,r,s);if(!a)return Xc(t);const d=this.applyRedirects.applyRedirectCommands(c,r.redirectTo,u);return r.redirectTo.startsWith("/")?CI(d):this.applyRedirects.lineralizeSegments(r,d).pipe(Rn(h=>this.processSegment(e,i,t,h.concat(l),o,!1)))}matchSegmentAgainstRoute(e,t,i,r,s,o){let a;if("**"===i.path){const c=r.length>0?$1(r).parameters:{};a=Oe({snapshot:new Pp(r,c,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,II(i),Sr(i),i.component??i._loadedComponent??null,i,RI(i)),consumedSegments:[],remainingSegments:[]}),t.children={}}else a=P6(t,i,r,e).pipe(ut(({matched:c,consumedSegments:l,remainingSegments:u,parameters:d})=>c?{snapshot:new Pp(l,d,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,II(i),Sr(i),i.component??i._loadedComponent??null,i,RI(i)),consumedSegments:l,remainingSegments:u}:null));return a.pipe(Kr(c=>null===c?Xc(t):this.getChildConfig(e=i._injector??e,i,r).pipe(Kr(({routes:l})=>{const u=i._loadedInjector??e,{snapshot:d,consumedSegments:h,remainingSegments:f}=c,{segmentGroup:p,slicedSegments:_}=AI(t,h,f,l);if(0===_.length&&p.hasChildren())return this.processChildren(u,l,p).pipe(ut(m=>null===m?null:[new Cs(d,m)]));if(0===l.length&&0===_.length)return Oe([new Cs(d,[])]);const g=Sr(i)===s;return this.processSegment(u,l,p,_,g?it:s,!0).pipe(ut(m=>[new Cs(d,m)]))}))))}getChildConfig(e,t,i){return t.children?Oe({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?Oe({routes:t._loadedRoutes,injector:t._loadedInjector}):function C6(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?Oe(!0):Oe(r.map(o=>{const a=$c(o,n);return po(function f6(n){return n&&hd(n.canLoad)}(a)?a.canLoad(e,t):n.runInContext(()=>a(e,t)))})).pipe(qc(),SI())}(e,t,i).pipe(Rn(r=>r?this.configLoader.loadChildren(e,t).pipe(kn(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function I6(n){return zc(yI(!1,3))}())):Oe({routes:[],injector:e})}}function H6(n){const e=n.value.routeConfig;return e&&""===e.path}function DI(n){const e=[],t=new Set;for(const i of n){if(!H6(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=DI(i.children);e.push(new Cs(i.value,r))}return e.filter(i=>!t.has(i))}function II(n){return n.data||{}}function RI(n){return n.resolve||{}}function PI(n){return"string"==typeof n.title||null===n.title}function X0(n){return Kr(e=>{const t=n(e);return t?Pn(t).pipe(ut(()=>e)):Oe(e)})}const Yc=new pe("ROUTES");let Y0=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=_e(oD)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Oe(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=po(t.loadComponent()).pipe(ut(LI),kn(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),Ep(()=>{this.componentLoaders.delete(t)})),r=new G1(i,()=>new Kt).pipe(A0());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Oe({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=this.loadModuleFactoryOrRoutes(i.loadChildren).pipe(ut(a=>{this.onLoadEndListener&&this.onLoadEndListener(i);let c,l;return Array.isArray(a)?l=a:(c=a.create(t).injector,l=c.get(Yc,[],Ge.Self|Ge.Optional).flat()),{routes:l.map(j0),injector:c}}),Ep(()=>{this.childrenLoaders.delete(i)})),o=new G1(s,()=>new Kt).pipe(A0());return this.childrenLoaders.set(i,o),o}loadModuleFactoryOrRoutes(t){return po(t()).pipe(ut(LI),Rn(i=>i instanceof pA||Array.isArray(i)?Oe(i):Pn(this.compiler.compileModuleAsync(i))))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function LI(n){return function Y6(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let Up=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Kt,this.configLoader=_e(Y0),this.environmentInjector=_e(Gr),this.urlSerializer=_e(td),this.rootContexts=_e(ad),this.inputBindingEnabled=null!==_e(Lp,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Oe(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new G$(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new H$(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t){return this.transitions=new ir({id:0,currentUrlTree:t.currentUrlTree,currentRawUrl:t.currentUrlTree,extractedUrl:t.urlHandlingStrategy.extract(t.currentUrlTree),urlAfterRedirects:t.urlHandlingStrategy.extract(t.currentUrlTree),rawUrl:t.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:sd,restoredState:null,currentSnapshot:t.routerState.snapshot,targetSnapshot:null,currentRouterState:t.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Wn(i=>0!==i.id),ut(i=>({...i,extractedUrl:t.urlHandlingStrategy.extract(i.rawUrl)})),Kr(i=>{let r=!1,s=!1;return Oe(i).pipe(kn(o=>{this.currentNavigation={id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Kr(o=>{const a=t.browserUrlTree.toString(),c=!t.navigated||o.extractedUrl.toString()!==a||a!==t.currentUrlTree.toString();if(!c&&"reload"!==(o.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const u="";return this.events.next(new od(o.id,t.serializeUrl(i.rawUrl),u,0)),t.rawUrlTree=o.rawUrl,o.resolve(null),Nr}if(t.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return NI(o.source)&&(t.browserUrlTree=o.extractedUrl),Oe(o).pipe(Kr(u=>{const d=this.transitions?.getValue();return this.events.next(new F0(u.id,this.urlSerializer.serialize(u.extractedUrl),u.source,u.restoredState)),d!==this.transitions?.getValue()?Nr:Promise.resolve(u)}),function G6(n,e,t,i,r,s){return Rn(o=>function B6(n,e,t,i,r,s,o="emptyOnly"){return new V6(n,e,t,i,r,o,s).recognize()}(n,e,t,i,o.extractedUrl,r,s).pipe(ut(({state:a,tree:c})=>({...o,targetSnapshot:a,urlAfterRedirects:c}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),kn(u=>{if(i.targetSnapshot=u.targetSnapshot,i.urlAfterRedirects=u.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:u.urlAfterRedirects},"eager"===t.urlUpdateStrategy){if(!u.extras.skipLocationChange){const h=t.urlHandlingStrategy.merge(u.urlAfterRedirects,u.rawUrl);t.setBrowserUrl(h,u)}t.browserUrlTree=u.urlAfterRedirects}const d=new k$(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}));if(c&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){const{id:u,extractedUrl:d,source:h,restoredState:f,extras:p}=o,_=new F0(u,this.urlSerializer.serialize(d),h,f);this.events.next(_);const g=fI(0,this.rootComponentType).snapshot;return Oe(i={...o,targetSnapshot:g,urlAfterRedirects:d,extras:{...p,skipLocationChange:!1,replaceUrl:!1}})}{const u="";return this.events.next(new od(o.id,t.serializeUrl(i.extractedUrl),u,1)),t.rawUrlTree=o.rawUrl,o.resolve(null),Nr}}),kn(o=>{const a=new U$(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(a)}),ut(o=>i={...o,guards:c6(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),function y6(n,e){return Rn(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?Oe({...t,guardsResult:!0}):function b6(n,e,t,i){return Pn(n).pipe(Rn(r=>function T6(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?Oe(s.map(a=>{const c=ld(e)??r,l=$c(a,c);return po(function g6(n){return n&&hd(n.canDeactivate)}(l)?l.canDeactivate(n,e,t,i):c.runInContext(()=>l(n,e,t,i))).pipe(sa())})).pipe(qc()):Oe(!0)}(r.component,r.route,t,e,i)),sa(r=>!0!==r,!0))}(o,i,r,n).pipe(Rn(a=>a&&function h6(n){return"boolean"==typeof n}(a)?function w6(n,e,t,i){return Pn(e).pipe(Hc(r=>wp(function M6(n,e){return null!==n&&e&&e(new W$(n)),Oe(!0)}(r.route.parent,i),function x6(n,e){return null!==n&&e&&e(new $$(n)),Oe(!0)}(r.route,i),function S6(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function l6(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>H1(()=>Oe(o.guards.map(c=>{const l=ld(o.node)??t,u=$c(c,l);return po(function m6(n){return n&&hd(n.canActivateChild)}(u)?u.canActivateChild(i,n):l.runInContext(()=>u(i,n))).pipe(sa())})).pipe(qc())));return Oe(s).pipe(qc())}(n,r.path,t),function E6(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return Oe(!0);const r=i.map(s=>H1(()=>{const o=ld(e)??t,a=$c(s,o);return po(function p6(n){return n&&hd(n.canActivate)}(a)?a.canActivate(e,n):o.runInContext(()=>a(e,n))).pipe(sa())}));return Oe(r).pipe(qc())}(n,r.route,t))),sa(r=>!0!==r,!0))}(i,s,n,e):Oe(a)),ut(a=>({...t,guardsResult:a})))})}(this.environmentInjector,o=>this.events.next(o)),kn(o=>{if(i.guardsResult=o.guardsResult,aa(o.guardsResult))throw vI(0,o.guardsResult);const a=new B$(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(a)}),Wn(o=>!!o.guardsResult||(t.restoreHistory(o),this.cancelNavigationTransition(o,"",3),!1)),X0(o=>{if(o.guards.canActivateChecks.length)return Oe(o).pipe(kn(a=>{const c=new V$(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}),Kr(a=>{let c=!1;return Oe(a).pipe(function W6(n,e){return Rn(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return Oe(t);let s=0;return Pn(r).pipe(Hc(o=>function j6(n,e,t,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!PI(r)&&(s[Qu]=r.title),function $6(n,e,t,i){const r=function q6(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===r.length)return Oe({});const s={};return Pn(r).pipe(Rn(o=>function X6(n,e,t,i){const r=ld(e)??i,s=$c(n,r);return po(s.resolve?s.resolve(e,t):r.runInContext(()=>s(e,t)))}(n[o],e,t,i).pipe(sa(),kn(a=>{s[o]=a}))),D0(1),I0(s),fo(o=>EI(o)?Nr:zc(o)))}(s,n,e,i).pipe(ut(o=>(n._resolvedData=o,n.data=pI(n,t).resolve,r&&PI(r)&&(n.data[Qu]=r.title),null)))}(o.route,i,n,e)),kn(()=>s++),D0(1),Rn(o=>s===r.length?Oe(t):Nr))})}(t.paramsInheritanceStrategy,this.environmentInjector),kn({next:()=>c=!0,complete:()=>{c||(t.restoreHistory(a),this.cancelNavigationTransition(a,"",2))}}))}),kn(a=>{const c=new z$(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}))}),X0(o=>{const a=c=>{const l=[];c.routeConfig?.loadComponent&&!c.routeConfig._loadedComponent&&l.push(this.configLoader.loadComponent(c.routeConfig).pipe(kn(u=>{c.component=u}),ut(()=>{})));for(const u of c.children)l.push(...a(u));return l};return yp(a(o.targetSnapshot.root)).pipe(Mp(),Er(1))}),X0(()=>this.afterPreactivation()),ut(o=>{const a=function J$(n,e,t){const i=cd(n,e._root,t?t._root:void 0);return new hI(i,e)}(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return i={...o,targetRouterState:a}}),kn(o=>{t.currentUrlTree=o.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(o.urlAfterRedirects,o.rawUrl),t.routerState=o.targetRouterState,"deferred"===t.urlUpdateStrategy&&(o.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,o),t.browserUrlTree=o.urlAfterRedirects)}),((n,e,t,i)=>ut(r=>(new a6(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)))(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o),this.inputBindingEnabled),Er(1),kn({next:o=>{r=!0,this.lastSuccessfulNavigation=this.currentNavigation,t.navigated=!0,this.events.next(new ca(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(t.currentUrlTree))),t.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{r=!0}}),Ep(()=>{r||s||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),fo(o=>{if(s=!0,wI(o)){bI(o)||(t.navigated=!0,t.restoreHistory(i,!0));const a=new Rp(i.id,this.urlSerializer.serialize(i.extractedUrl),o.message,o.cancellationCode);if(this.events.next(a),bI(o)){const c=t.urlHandlingStrategy.merge(o.url,t.rawUrlTree),l={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||NI(i.source)};t.scheduleNavigation(c,sd,null,l,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{t.restoreHistory(i,!0);const a=new k0(i.id,this.urlSerializer.serialize(i.extractedUrl),o,i.targetSnapshot??void 0);this.events.next(a);try{i.resolve(t.errorHandler(o))}catch(c){i.reject(c)}}return Nr}))}))}cancelNavigationTransition(t,i,r){const s=new Rp(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function NI(n){return n!==sd}let OI=(()=>{class n{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===it);return i}getResolvedTitleForRoute(t){return t.data[Qu]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=xe({token:n,factory:function(){return _e(Z6)},providedIn:"root"}),n})(),Z6=(()=>{class n extends OI{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}}return n.\u0275fac=function(t){return new(t||n)(re(N1))},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),K6=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=xe({token:n,factory:function(){return _e(Q6)},providedIn:"root"}),n})();class J6{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let Q6=(()=>{class n extends J6{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=Qh(n)))(i||n)}}(),n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Bp=new pe("",{providedIn:"root",factory:()=>({})});let e9=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=xe({token:n,factory:function(){return _e(t9)},providedIn:"root"}),n})(),t9=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Bi=(()=>((Bi=Bi||{})[Bi.COMPLETE=0]="COMPLETE",Bi[Bi.FAILED=1]="FAILED",Bi[Bi.REDIRECTING=2]="REDIRECTING",Bi))();function FI(n,e){n.events.pipe(Wn(t=>t instanceof ca||t instanceof Rp||t instanceof k0||t instanceof od),ut(t=>t instanceof ca||t instanceof od?Bi.COMPLETE:t instanceof Rp&&(0===t.code||1===t.code)?Bi.REDIRECTING:Bi.FAILED),Wn(t=>t!==Bi.REDIRECTING),Er(1)).subscribe(()=>{e()})}function n9(n){throw n}function i9(n,e,t){return e.parse("/")}const r9={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},s9={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Vi=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=_e(sD),this.isNgZoneEnabled=!1,this.options=_e(Bp,{optional:!0})||{},this.pendingTasks=_e(HD),this.errorHandler=this.options.errorHandler||n9,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||i9,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=_e(e9),this.routeReuseStrategy=_e(K6),this.titleStrategy=_e(OI),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=_e(Yc,{optional:!0})?.flat()??[],this.navigationTransitions=_e(Up),this.urlSerializer=_e(td),this.location=_e(Qy),this.componentInputBindingEnabled=!!_e(Lp,{optional:!0}),this.isNgZoneEnabled=_e(at)instanceof at&&at.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Wc,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=fI(0,null),this.navigationTransitions.setupNavigations(this).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId??0},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),sd,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,i,t.state)},0)}))}navigateToSyncWithBrowser(t,i,r){const s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){const c={...r};delete c.navigationId,delete c.\u0275routerPageId,0!==Object.keys(c).length&&(s.state=c)}const a=this.parseUrl(t);this.scheduleNavigation(a,i,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(j0),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:c}=i,l=c?this.currentUrlTree.fragment:o;let d,u=null;switch(a){case"merge":u={...this.currentUrlTree.queryParams,...s};break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=s||null}null!==u&&(u=this.removeEmptyProps(u));try{d=iI(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||!t[0].startsWith("/"))&&(t=[]),d=this.currentUrlTree.root}return rI(d,t,u,l??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=aa(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,sd,null,i)}navigate(t,i={skipLocationChange:!1}){return function o9(n){for(let e=0;e<n.length;e++)if(null==n[e])throw new J(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?{...r9}:!1===i?{...s9}:i,aa(t))return X1(this.currentUrlTree,t,r);const s=this.parseUrl(t);return X1(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const s=t[r];return null!=s&&(i[r]=s),i},{})}scheduleNavigation(t,i,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,c,l;o?(a=o.resolve,c=o.reject,l=o.promise):l=new Promise((d,h)=>{a=d,c=h});const u=this.pendingTasks.add();return FI(this,()=>{Promise.resolve().then(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(d=>Promise.reject(d))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const o={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",o)}else{const s={...i.extras.state,...this.generateNgRouterState(i.id,(this.browserPageId??0)+1)};this.location.go(r,"",s)}}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-(this.browserPageId??this.currentPageId);0!==s?this.location.historyGo(s):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===s&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class kI{}let l9=(()=>{class n{constructor(t,i,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Wn(t=>t instanceof ca),Hc(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=vy(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return Pn(r).pipe($a())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):Oe(null);const s=r.pipe(Rn(o=>null===o?Oe(void 0):(i._loadedRoutes=o.routes,i._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return i.loadComponent&&!i._loadedComponent?Pn([s,this.loader.loadComponent(i)]).pipe($a()):s})}}return n.\u0275fac=function(t){return new(t||n)(re(Vi),re(oD),re(Gr),re(kI),re(Y0))},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const K0=new pe("");let UI=(()=>{class n{constructor(t,i,r,s,o={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof F0?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof ca?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof od&&0===t.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof uI&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new uI(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return n.\u0275fac=function(t){Lv()},n.\u0275prov=xe({token:n,factory:n.\u0275fac}),n})();function u9(n,...e){return vf([{provide:Yc,multi:!0,useValue:n},[],{provide:la,useFactory:BI,deps:[Vi]},{provide:ep,multi:!0,useFactory:VI},e.map(t=>t.\u0275providers)])}function BI(n){return n.routerState.root}function As(n,e){return{\u0275kind:n,\u0275providers:e}}function VI(){const n=_e(jr);return e=>{const t=n.get(na);if(e!==t.components[0])return;const i=n.get(Vi),r=n.get(zI);1===n.get(J0)&&i.initialNavigation(),n.get(HI,null,Ge.Optional)?.setUpPreloading(),n.get(K0,null,Ge.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const zI=new pe("",{factory:()=>new Kt}),J0=new pe("",{providedIn:"root",factory:()=>1}),HI=new pe("");function p9(n){return As(0,[{provide:HI,useExisting:l9},{provide:kI,useExisting:n}])}function GI(){return As(8,[_I,{provide:Lp,useExisting:_I}])}const WI=new pe("ROUTER_FORROOT_GUARD"),m9=[Qy,{provide:td,useClass:R0},Vi,ad,{provide:la,useFactory:BI,deps:[Vi]},Y0,[]];function g9(){return new _D("Router",Vi)}let jI=(()=>{class n{constructor(t){}static forRoot(t,i){return{ngModule:n,providers:[m9,[],{provide:Yc,multi:!0,useValue:t},{provide:WI,useFactory:b9,deps:[[Vi,new Xo,new fu]]},{provide:Bp,useValue:i||{}},i?.useHash?{provide:ra,useClass:DW}:{provide:ra,useClass:$D},{provide:K0,useFactory:()=>{const n=_e($8),e=_e(at),t=_e(Bp),i=_e(Up),r=_e(td);return t.scrollOffset&&n.setOffset(t.scrollOffset),new UI(r,i,n,e,t)}},i?.preloadingStrategy?p9(i.preloadingStrategy).\u0275providers:[],{provide:_D,multi:!0,useFactory:g9},i?.initialNavigation?w9(i):[],i?.bindToComponentInputs?GI().\u0275providers:[],[{provide:$I,useFactory:VI},{provide:ep,multi:!0,useExisting:$I}]]}}static forChild(t){return{ngModule:n,providers:[{provide:Yc,multi:!0,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)(re(WI,8))},n.\u0275mod=Yn({type:n}),n.\u0275inj=zn({}),n})();function b9(n){return"guarded"}function w9(n){return["disabled"===n.initialNavigation?As(3,[{provide:Ly,multi:!0,useFactory:()=>{const e=_e(Vi);return()=>{e.setUpLocationChangeListener()}}},{provide:J0,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?As(2,[{provide:J0,useValue:0},{provide:Ly,multi:!0,deps:[jr],useFactory:e=>{const t=e.get(CW,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=e.get(Vi),s=e.get(zI);FI(r,()=>{i(!0)}),e.get(Up).afterPreactivation=()=>(i(!0),s.closed?Oe(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const $I=new pe("");function qI(n,e,t,i,r,s,o){try{var a=n[s](o),c=a.value}catch(l){return void t(l)}a.done?e(c):Promise.resolve(c).then(i,r)}function Q0(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(c){qI(s,i,r,o,a,"next",c)}function a(c){qI(s,i,r,o,a,"throw",c)}o(void 0)})}}const YI=1,S9=2,Ds=3,mo=0,Si=1,Is=2,go=0,Vp=0,j9=1,$9=2,_o=0,q9=1,X9=2,Y9=3,Z9=4,K9=5,vo=301,ua=302,fd=306,li=1001,gn=1003,cn=1006,yo=1008,bo=1009,rb=1012,wo=1014,Rs=1015,pd=1016,sR=1017,oR=1018,da=1020,rr=1023,ha=1026,Jc=1027,aR=1029,cR=1031,lR=1033,fa=3001,Bt="srgb",Tr="srgb-linear",Yp="display-p3",kR="300 es",Ps=2e3;class tl{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const ei=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let UR=1234567;const ga=Math.PI/180,nl=180/Math.PI;function zi(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(ei[255&n]+ei[n>>8&255]+ei[n>>16&255]+ei[n>>24&255]+"-"+ei[255&e]+ei[e>>8&255]+"-"+ei[e>>16&15|64]+ei[e>>24&255]+"-"+ei[63&t|128]+ei[t>>8&255]+"-"+ei[t>>16&255]+ei[t>>24&255]+ei[255&i]+ei[i>>8&255]+ei[i>>16&255]+ei[i>>24&255]).toLowerCase()}function en(n,e,t){return Math.max(e,Math.min(t,n))}function pb(n,e){return(n%e+e)%e}function md(n,e,t){return(1-t)*n+t*e}function mb(n){return 0==(n&n-1)&&0!==n}function Jp(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function Ti(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function ot(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(4294967295*n);case Uint16Array:return Math.round(65535*n);case Uint8Array:return Math.round(255*n);case Int32Array:return Math.round(2147483647*n);case Int16Array:return Math.round(32767*n);case Int8Array:return Math.round(127*n);default:throw new Error("Invalid component type.")}}const qt={DEG2RAD:ga,RAD2DEG:nl,generateUUID:zi,clamp:en,euclideanModulo:pb,mapLinear:function x7(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)},inverseLerp:function M7(n,e,t){return n!==e?(t-n)/(e-n):0},lerp:md,damp:function E7(n,e,t,i){return md(n,e,1-Math.exp(-t*i))},pingpong:function S7(n,e=1){return e-Math.abs(pb(n,2*e)-e)},smoothstep:function T7(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e))*n*(3-2*n)},smootherstep:function C7(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e))*n*n*(n*(6*n-15)+10)},randInt:function A7(n,e){return n+Math.floor(Math.random()*(e-n+1))},randFloat:function D7(n,e){return n+Math.random()*(e-n)},randFloatSpread:function I7(n){return n*(.5-Math.random())},seededRandom:function R7(n){void 0!==n&&(UR=n);let e=UR+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function P7(n){return n*ga},radToDeg:function L7(n){return n*nl},isPowerOfTwo:mb,ceilPowerOfTwo:function BR(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))},floorPowerOfTwo:Jp,setQuaternionFromProperEuler:function N7(n,e,t,i,r){const s=Math.cos,o=Math.sin,a=s(t/2),c=o(t/2),l=s((e+i)/2),u=o((e+i)/2),d=s((e-i)/2),h=o((e-i)/2),f=s((i-e)/2),p=o((i-e)/2);switch(r){case"XYX":n.set(a*u,c*d,c*h,a*l);break;case"YZY":n.set(c*h,a*u,c*d,a*l);break;case"ZXZ":n.set(c*d,c*h,a*u,a*l);break;case"XZX":n.set(a*u,c*p,c*f,a*l);break;case"YXY":n.set(c*f,a*u,c*p,a*l);break;case"ZYZ":n.set(c*p,c*f,a*u,a*l);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:ot,denormalize:Ti};class ie{constructor(e=0,t=0){ie.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(en(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class dt{constructor(e,t,i,r,s,o,a,c,l){dt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,a,c,l)}set(e,t,i,r,s,o,a,c,l){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=c,u[6]=i,u[7]=o,u[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],c=i[6],l=i[1],u=i[4],d=i[7],h=i[2],f=i[5],p=i[8],_=r[0],g=r[3],m=r[6],y=r[1],v=r[4],b=r[7],x=r[2],E=r[5],T=r[8];return s[0]=o*_+a*y+c*x,s[3]=o*g+a*v+c*E,s[6]=o*m+a*b+c*T,s[1]=l*_+u*y+d*x,s[4]=l*g+u*v+d*E,s[7]=l*m+u*b+d*T,s[2]=h*_+f*y+p*x,s[5]=h*g+f*v+p*E,s[8]=h*m+f*b+p*T,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8];return t*o*u-t*a*l-i*s*u+i*a*c+r*s*l-r*o*c}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],d=u*o-a*l,h=a*c-u*s,f=l*s-o*c,p=t*d+i*h+r*f;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const _=1/p;return e[0]=d*_,e[1]=(r*l-u*i)*_,e[2]=(a*i-r*o)*_,e[3]=h*_,e[4]=(u*t-r*c)*_,e[5]=(r*s-a*t)*_,e[6]=f*_,e[7]=(i*c-l*t)*_,e[8]=(o*t-i*s)*_,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const c=Math.cos(s),l=Math.sin(s);return this.set(i*c,i*l,-i*(c*o+l*a)+o+e,-r*l,r*c,-r*(-l*o+c*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(gb.makeScale(e,t)),this}rotate(e){return this.premultiply(gb.makeRotation(-e)),this}translate(e,t){return this.premultiply(gb.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const gb=new dt;function VR(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function gd(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function F7(){const n=gd("canvas");return n.style.display="block",n}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const zR={};function _d(n){n in zR||(zR[n]=!0,console.warn(n))}function rl(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function _b(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}const k7=(new dt).fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),U7=(new dt).fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),z7={[Tr]:n=>n,[Bt]:n=>n.convertSRGBToLinear(),[Yp]:function B7(n){return n.convertSRGBToLinear().applyMatrix3(U7)}},H7={[Tr]:n=>n,[Bt]:n=>n.convertLinearToSRGB(),[Yp]:function V7(n){return n.applyMatrix3(k7).convertLinearToSRGB()}},sr={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return Tr},set workingColorSpace(n){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(n,e,t){if(!1===this.enabled||e===t||!e||!t)return n;const i=z7[e],r=H7[t];if(void 0===i||void 0===r)throw new Error(`Unsupported color space conversion, "${e}" to "${t}".`);return r(i(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this.workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this.workingColorSpace)}};let sl;class HR{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===sl&&(sl=gd("canvas")),sl.width=e.width,sl.height=e.height;const i=sl.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=sl}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=gd("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*rl(s[o]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*rl(t[i]/255)):rl(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let G7=0;class ol{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:G7++}),this.uuid=zi(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(vb(r[o].isDataTexture?r[o].image:r[o]))}else s=vb(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function vb(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?HR.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let W7=0,Ls=(()=>{class n extends tl{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=li,s=li,o=cn,a=yo,c=rr,l=bo,u=n.DEFAULT_ANISOTROPY,d=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:W7++}),this.uuid=zi(),this.name="",this.source=new ol(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=c,this.internalFormat=null,this.type=l,this.offset=new ie(0,0),this.repeat=new ie(1,1),this.center=new ie(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new dt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof d?this.colorSpace=d:(_d("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=d===fa?Bt:""),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case li:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case li:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return _d("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Bt?fa:3e3}set encoding(t){_d("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===fa?Bt:""}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n.DEFAULT_ANISOTROPY=1,n})();class Rt{constructor(e=0,t=0,i=0,r=1){Rt.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const c=e.elements,l=c[0],u=c[4],d=c[8],h=c[1],f=c[5],p=c[9],_=c[2],g=c[6],m=c[10];if(Math.abs(u-h)<.01&&Math.abs(d-_)<.01&&Math.abs(p-g)<.01){if(Math.abs(u+h)<.1&&Math.abs(d+_)<.1&&Math.abs(p+g)<.1&&Math.abs(l+f+m-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const v=(l+1)/2,b=(f+1)/2,x=(m+1)/2,E=(u+h)/4,T=(d+_)/4,P=(p+g)/4;return v>b&&v>x?v<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(v),r=E/i,s=T/i):b>x?b<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(b),i=E/r,s=P/r):x<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(x),i=T/s,r=P/s),this.set(i,r,s,t),this}let y=Math.sqrt((g-p)*(g-p)+(d-_)*(d-_)+(h-u)*(h-u));return Math.abs(y)<.001&&(y=1),this.x=(g-p)/y,this.y=(d-_)/y,this.z=(h-u)/y,this.w=Math.acos((l+f+m-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class j7 extends tl{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Rt(0,0,e,t),this.scissorTest=!1,this.viewport=new Rt(0,0,e,t);const r={width:e,height:t,depth:1};void 0!==i.encoding&&(_d("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===fa?Bt:""),this.texture=new Ls(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.internalFormat=void 0!==i.internalFormat?i.internalFormat:null,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:cn,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null,this.samples=void 0!==i.samples?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new ol(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class xo extends j7{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class yb extends Ls{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=gn,this.minFilter=gn,this.wrapR=li,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class GR extends Ls{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=gn,this.minFilter=gn,this.wrapR=li,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class jn{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let c=i[r+0],l=i[r+1],u=i[r+2],d=i[r+3];const h=s[o+0],f=s[o+1],p=s[o+2],_=s[o+3];if(0===a)return e[t+0]=c,e[t+1]=l,e[t+2]=u,void(e[t+3]=d);if(1===a)return e[t+0]=h,e[t+1]=f,e[t+2]=p,void(e[t+3]=_);if(d!==_||c!==h||l!==f||u!==p){let g=1-a;const m=c*h+l*f+u*p+d*_,y=m>=0?1:-1,v=1-m*m;if(v>Number.EPSILON){const x=Math.sqrt(v),E=Math.atan2(x,m*y);g=Math.sin(g*E)/x,a=Math.sin(a*E)/x}const b=a*y;if(c=c*g+h*b,l=l*g+f*b,u=u*g+p*b,d=d*g+_*b,g===1-a){const x=1/Math.sqrt(c*c+l*l+u*u+d*d);c*=x,l*=x,u*=x,d*=x}}e[t]=c,e[t+1]=l,e[t+2]=u,e[t+3]=d}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],c=i[r+1],l=i[r+2],u=i[r+3],d=s[o],h=s[o+1],f=s[o+2],p=s[o+3];return e[t]=a*p+u*d+c*f-l*h,e[t+1]=c*p+u*h+l*d-a*f,e[t+2]=l*p+u*f+a*h-c*d,e[t+3]=u*p-a*d-c*h-l*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,c=Math.sin,l=a(i/2),u=a(r/2),d=a(s/2),h=c(i/2),f=c(r/2),p=c(s/2);switch(o){case"XYZ":this._x=h*u*d+l*f*p,this._y=l*f*d-h*u*p,this._z=l*u*p+h*f*d,this._w=l*u*d-h*f*p;break;case"YXZ":this._x=h*u*d+l*f*p,this._y=l*f*d-h*u*p,this._z=l*u*p-h*f*d,this._w=l*u*d+h*f*p;break;case"ZXY":this._x=h*u*d-l*f*p,this._y=l*f*d+h*u*p,this._z=l*u*p+h*f*d,this._w=l*u*d-h*f*p;break;case"ZYX":this._x=h*u*d-l*f*p,this._y=l*f*d+h*u*p,this._z=l*u*p-h*f*d,this._w=l*u*d+h*f*p;break;case"YZX":this._x=h*u*d+l*f*p,this._y=l*f*d+h*u*p,this._z=l*u*p-h*f*d,this._w=l*u*d-h*f*p;break;case"XZY":this._x=h*u*d-l*f*p,this._y=l*f*d-h*u*p,this._z=l*u*p+h*f*d,this._w=l*u*d+h*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],c=t[9],l=t[2],u=t[6],d=t[10],h=i+a+d;if(h>0){const f=.5/Math.sqrt(h+1);this._w=.25/f,this._x=(u-c)*f,this._y=(s-l)*f,this._z=(o-r)*f}else if(i>a&&i>d){const f=2*Math.sqrt(1+i-a-d);this._w=(u-c)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+l)/f}else if(a>d){const f=2*Math.sqrt(1+a-i-d);this._w=(s-l)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(c+u)/f}else{const f=2*Math.sqrt(1+d-i-a);this._w=(o-r)/f,this._x=(s+l)/f,this._y=(c+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(en(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,c=t._y,l=t._z,u=t._w;return this._x=i*u+o*a+r*l-s*c,this._y=r*u+o*c+s*a-i*l,this._z=s*u+o*l+i*c-r*a,this._w=o*u-i*a-r*c-s*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const c=1-a*a;if(c<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*i+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(c),u=Math.atan2(l,a),d=Math.sin((1-t)*u)/l,h=Math.sin(t*u)/l;return this._w=o*d+this._w*h,this._x=i*d+this._x*h,this._y=r*d+this._y*h,this._z=s*d+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class C{constructor(e=0,t=0,i=0){C.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(WR.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(WR.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,c=e.w,l=c*t+o*r-a*i,u=c*i+a*t-s*r,d=c*r+s*i-o*t,h=-s*t-o*i-a*r;return this.x=l*c+h*-s+u*-a-d*-o,this.y=u*c+h*-o+d*-s-l*-a,this.z=d*c+h*-a+l*-o-u*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,c=t.z;return this.x=r*c-s*a,this.y=s*o-i*c,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return bb.copy(this).projectOnVector(e),this.sub(bb)}reflect(e){return this.sub(bb.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(en(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const bb=new C,WR=new jn;class Ns{constructor(e=new C(1/0,1/0,1/0),t=new C(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(Fs.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(Fs.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Fs.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){if(e.updateWorldMatrix(!1,!1),void 0!==e.boundingBox)null===e.boundingBox&&e.computeBoundingBox(),al.copy(e.boundingBox),al.applyMatrix4(e.matrixWorld),this.union(al);else{const r=e.geometry;if(void 0!==r)if(t&&void 0!==r.attributes&&void 0!==r.attributes.position){const s=r.attributes.position;for(let o=0,a=s.count;o<a;o++)Fs.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(Fs)}else null===r.boundingBox&&r.computeBoundingBox(),al.copy(r.boundingBox),al.applyMatrix4(e.matrixWorld),this.union(al)}const i=e.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Fs),Fs.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(vd),Qp.subVectors(this.max,vd),cl.subVectors(e.a,vd),ll.subVectors(e.b,vd),ul.subVectors(e.c,vd),Mo.subVectors(ll,cl),Eo.subVectors(ul,ll),_a.subVectors(cl,ul);let t=[0,-Mo.z,Mo.y,0,-Eo.z,Eo.y,0,-_a.z,_a.y,Mo.z,0,-Mo.x,Eo.z,0,-Eo.x,_a.z,0,-_a.x,-Mo.y,Mo.x,0,-Eo.y,Eo.x,0,-_a.y,_a.x,0];return!(!wb(t,cl,ll,ul,Qp)||(t=[1,0,0,0,1,0,0,0,1],!wb(t,cl,ll,ul,Qp)))&&(em.crossVectors(Mo,Eo),t=[em.x,em.y,em.z],wb(t,cl,ll,ul,Qp))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Fs).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Fs).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Os[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Os[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Os[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Os[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Os[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Os[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Os[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Os[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Os)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Os=[new C,new C,new C,new C,new C,new C,new C,new C],Fs=new C,al=new Ns,cl=new C,ll=new C,ul=new C,Mo=new C,Eo=new C,_a=new C,vd=new C,Qp=new C,em=new C,va=new C;function wb(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){va.fromArray(n,s);const a=r.x*Math.abs(va.x)+r.y*Math.abs(va.y)+r.z*Math.abs(va.z),c=e.dot(va),l=t.dot(va),u=i.dot(va);if(Math.max(-Math.max(c,l,u),Math.min(c,l,u))>a)return!1}return!0}const $7=new Ns,yd=new C,xb=new C;class es{constructor(e=new C,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):$7.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;yd.subVectors(e,this.center);const t=yd.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.addScaledVector(yd,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(xb.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(yd.copy(e.center).add(xb)),this.expandByPoint(yd.copy(e.center).sub(xb))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const ks=new C,Mb=new C,tm=new C,So=new C,Eb=new C,nm=new C,Sb=new C;class bd{constructor(e=new C,t=new C(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ks)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=ks.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ks.copy(this.origin).addScaledVector(this.direction,t),ks.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){Mb.copy(e).add(t).multiplyScalar(.5),tm.copy(t).sub(e).normalize(),So.copy(this.origin).sub(Mb);const s=.5*e.distanceTo(t),o=-this.direction.dot(tm),a=So.dot(this.direction),c=-So.dot(tm),l=So.lengthSq(),u=Math.abs(1-o*o);let d,h,f,p;if(u>0)if(d=o*c-a,h=o*a-c,p=s*u,d>=0)if(h>=-p)if(h<=p){const _=1/u;d*=_,h*=_,f=d*(d+o*h+2*a)+h*(o*d+h+2*c)+l}else h=s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*c)+l;else h=-s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*c)+l;else h<=-p?(d=Math.max(0,-(-o*s+a)),h=d>0?-s:Math.min(Math.max(-s,-c),s),f=-d*d+h*(h+2*c)+l):h<=p?(d=0,h=Math.min(Math.max(-s,-c),s),f=h*(h+2*c)+l):(d=Math.max(0,-(o*s+a)),h=d>0?s:Math.min(Math.max(-s,-c),s),f=-d*d+h*(h+2*c)+l);else h=o>0?-s:s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*c)+l;return i&&i.copy(this.origin).addScaledVector(this.direction,d),r&&r.copy(Mb).addScaledVector(tm,h),f}intersectSphere(e,t){ks.subVectors(e.center,this.origin);const i=ks.dot(this.direction),r=ks.dot(ks)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,c=i+o;return c<0?null:this.at(a<0?c:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,c;const l=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,h=this.origin;return l>=0?(i=(e.min.x-h.x)*l,r=(e.max.x-h.x)*l):(i=(e.max.x-h.x)*l,r=(e.min.x-h.x)*l),u>=0?(s=(e.min.y-h.y)*u,o=(e.max.y-h.y)*u):(s=(e.max.y-h.y)*u,o=(e.min.y-h.y)*u),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),d>=0?(a=(e.min.z-h.z)*d,c=(e.max.z-h.z)*d):(a=(e.max.z-h.z)*d,c=(e.min.z-h.z)*d),i>c||a>r)||((a>i||i!=i)&&(i=a),(c<r||r!=r)&&(r=c),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,ks)}intersectTriangle(e,t,i,r,s){Eb.subVectors(t,e),nm.subVectors(i,e),Sb.crossVectors(Eb,nm);let a,o=this.direction.dot(Sb);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}So.subVectors(this.origin,e);const c=a*this.direction.dot(nm.crossVectors(So,nm));if(c<0)return null;const l=a*this.direction.dot(Eb.cross(So));if(l<0||c+l>o)return null;const u=-a*So.dot(Sb);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class rt{constructor(e,t,i,r,s,o,a,c,l,u,d,h,f,p,_,g){rt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,a,c,l,u,d,h,f,p,_,g)}set(e,t,i,r,s,o,a,c,l,u,d,h,f,p,_,g){const m=this.elements;return m[0]=e,m[4]=t,m[8]=i,m[12]=r,m[1]=s,m[5]=o,m[9]=a,m[13]=c,m[2]=l,m[6]=u,m[10]=d,m[14]=h,m[3]=f,m[7]=p,m[11]=_,m[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new rt).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/dl.setFromMatrixColumn(e,0).length(),s=1/dl.setFromMatrixColumn(e,1).length(),o=1/dl.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),c=Math.cos(r),l=Math.sin(r),u=Math.cos(s),d=Math.sin(s);if("XYZ"===e.order){const h=o*u,f=o*d,p=a*u,_=a*d;t[0]=c*u,t[4]=-c*d,t[8]=l,t[1]=f+p*l,t[5]=h-_*l,t[9]=-a*c,t[2]=_-h*l,t[6]=p+f*l,t[10]=o*c}else if("YXZ"===e.order){const h=c*u,f=c*d,p=l*u,_=l*d;t[0]=h+_*a,t[4]=p*a-f,t[8]=o*l,t[1]=o*d,t[5]=o*u,t[9]=-a,t[2]=f*a-p,t[6]=_+h*a,t[10]=o*c}else if("ZXY"===e.order){const h=c*u,f=c*d,p=l*u,_=l*d;t[0]=h-_*a,t[4]=-o*d,t[8]=p+f*a,t[1]=f+p*a,t[5]=o*u,t[9]=_-h*a,t[2]=-o*l,t[6]=a,t[10]=o*c}else if("ZYX"===e.order){const h=o*u,f=o*d,p=a*u,_=a*d;t[0]=c*u,t[4]=p*l-f,t[8]=h*l+_,t[1]=c*d,t[5]=_*l+h,t[9]=f*l-p,t[2]=-l,t[6]=a*c,t[10]=o*c}else if("YZX"===e.order){const h=o*c,f=o*l,p=a*c,_=a*l;t[0]=c*u,t[4]=_-h*d,t[8]=p*d+f,t[1]=d,t[5]=o*u,t[9]=-a*u,t[2]=-l*u,t[6]=f*d+p,t[10]=h-_*d}else if("XZY"===e.order){const h=o*c,f=o*l,p=a*c,_=a*l;t[0]=c*u,t[4]=-d,t[8]=l*u,t[1]=h*d+_,t[5]=o*u,t[9]=f*d-p,t[2]=p*d-f,t[6]=a*u,t[10]=_*d+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(q7,e,X7)}lookAt(e,t,i){const r=this.elements;return Hi.subVectors(e,t),0===Hi.lengthSq()&&(Hi.z=1),Hi.normalize(),To.crossVectors(i,Hi),0===To.lengthSq()&&(1===Math.abs(i.z)?Hi.x+=1e-4:Hi.z+=1e-4,Hi.normalize(),To.crossVectors(i,Hi)),To.normalize(),im.crossVectors(Hi,To),r[0]=To.x,r[4]=im.x,r[8]=Hi.x,r[1]=To.y,r[5]=im.y,r[9]=Hi.y,r[2]=To.z,r[6]=im.z,r[10]=Hi.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],c=i[8],l=i[12],u=i[1],d=i[5],h=i[9],f=i[13],p=i[2],_=i[6],g=i[10],m=i[14],y=i[3],v=i[7],b=i[11],x=i[15],E=r[0],T=r[4],P=r[8],w=r[12],S=r[1],W=r[5],te=r[9],U=r[13],V=r[2],G=r[6],O=r[10],N=r[14],F=r[3],$=r[7],Q=r[11],k=r[15];return s[0]=o*E+a*S+c*V+l*F,s[4]=o*T+a*W+c*G+l*$,s[8]=o*P+a*te+c*O+l*Q,s[12]=o*w+a*U+c*N+l*k,s[1]=u*E+d*S+h*V+f*F,s[5]=u*T+d*W+h*G+f*$,s[9]=u*P+d*te+h*O+f*Q,s[13]=u*w+d*U+h*N+f*k,s[2]=p*E+_*S+g*V+m*F,s[6]=p*T+_*W+g*G+m*$,s[10]=p*P+_*te+g*O+m*Q,s[14]=p*w+_*U+g*N+m*k,s[3]=y*E+v*S+b*V+x*F,s[7]=y*T+v*W+b*G+x*$,s[11]=y*P+v*te+b*O+x*Q,s[15]=y*w+v*U+b*N+x*k,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],c=e[9],l=e[13],u=e[2],d=e[6],h=e[10],f=e[14];return e[3]*(+s*c*d-r*l*d-s*a*h+i*l*h+r*a*f-i*c*f)+e[7]*(+t*c*f-t*l*h+s*o*h-r*o*f+r*l*u-s*c*u)+e[11]*(+t*l*d-t*a*f-s*o*d+i*o*f+s*a*u-i*l*u)+e[15]*(-r*a*u-t*c*d+t*a*h+r*o*d-i*o*h+i*c*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],d=e[9],h=e[10],f=e[11],p=e[12],_=e[13],g=e[14],m=e[15],y=d*g*l-_*h*l+_*c*f-a*g*f-d*c*m+a*h*m,v=p*h*l-u*g*l-p*c*f+o*g*f+u*c*m-o*h*m,b=u*_*l-p*d*l+p*a*f-o*_*f-u*a*m+o*d*m,x=p*d*c-u*_*c-p*a*h+o*_*h+u*a*g-o*d*g,E=t*y+i*v+r*b+s*x;if(0===E)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const T=1/E;return e[0]=y*T,e[1]=(_*h*s-d*g*s-_*r*f+i*g*f+d*r*m-i*h*m)*T,e[2]=(a*g*s-_*c*s+_*r*l-i*g*l-a*r*m+i*c*m)*T,e[3]=(d*c*s-a*h*s-d*r*l+i*h*l+a*r*f-i*c*f)*T,e[4]=v*T,e[5]=(u*g*s-p*h*s+p*r*f-t*g*f-u*r*m+t*h*m)*T,e[6]=(p*c*s-o*g*s-p*r*l+t*g*l+o*r*m-t*c*m)*T,e[7]=(o*h*s-u*c*s+u*r*l-t*h*l-o*r*f+t*c*f)*T,e[8]=b*T,e[9]=(p*d*s-u*_*s-p*i*f+t*_*f+u*i*m-t*d*m)*T,e[10]=(o*_*s-p*a*s+p*i*l-t*_*l-o*i*m+t*a*m)*T,e[11]=(u*a*s-o*d*s-u*i*l+t*d*l+o*i*f-t*a*f)*T,e[12]=x*T,e[13]=(u*_*r-p*d*r+p*i*h-t*_*h-u*i*g+t*d*g)*T,e[14]=(p*a*r-o*_*r-p*i*c+t*_*c+o*i*g-t*a*g)*T,e[15]=(o*d*r-u*a*r+u*i*c-t*d*c-o*i*h+t*a*h)*T,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,c=e.z,l=s*o,u=s*a;return this.set(l*o+i,l*a-r*c,l*c+r*a,0,l*a+r*c,u*a+i,u*c-r*o,0,l*c-r*a,u*c+r*o,s*c*c+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,c=t._w,l=s+s,u=o+o,d=a+a,h=s*l,f=s*u,p=s*d,_=o*u,g=o*d,m=a*d,y=c*l,v=c*u,b=c*d,x=i.x,E=i.y,T=i.z;return r[0]=(1-(_+m))*x,r[1]=(f+b)*x,r[2]=(p-v)*x,r[3]=0,r[4]=(f-b)*E,r[5]=(1-(h+m))*E,r[6]=(g+y)*E,r[7]=0,r[8]=(p+v)*T,r[9]=(g-y)*T,r[10]=(1-(h+_))*T,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=dl.set(r[0],r[1],r[2]).length();const o=dl.set(r[4],r[5],r[6]).length(),a=dl.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Cr.copy(this);const l=1/s,u=1/o,d=1/a;return Cr.elements[0]*=l,Cr.elements[1]*=l,Cr.elements[2]*=l,Cr.elements[4]*=u,Cr.elements[5]*=u,Cr.elements[6]*=u,Cr.elements[8]*=d,Cr.elements[9]*=d,Cr.elements[10]*=d,t.setFromRotationMatrix(Cr),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=Ps){const c=this.elements,l=2*s/(t-e),u=2*s/(i-r),d=(t+e)/(t-e),h=(i+r)/(i-r);let f,p;if(a===Ps)f=-(o+s)/(o-s),p=-2*o*s/(o-s);else{if(2001!==a)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);f=-o/(o-s),p=-o*s/(o-s)}return c[0]=l,c[4]=0,c[8]=d,c[12]=0,c[1]=0,c[5]=u,c[9]=h,c[13]=0,c[2]=0,c[6]=0,c[10]=f,c[14]=p,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=Ps){const c=this.elements,l=1/(t-e),u=1/(i-r),d=1/(o-s),h=(t+e)*l,f=(i+r)*u;let p,_;if(a===Ps)p=(o+s)*d,_=-2*d;else{if(2001!==a)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);p=s*d,_=-1*d}return c[0]=2*l,c[4]=0,c[8]=0,c[12]=-h,c[1]=0,c[5]=2*u,c[9]=0,c[13]=-f,c[2]=0,c[6]=0,c[10]=_,c[14]=-p,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const dl=new C,Cr=new rt,q7=new C(0,0,0),X7=new C(1,1,1),To=new C,im=new C,Hi=new C,jR=new rt,$R=new jn;let Tb=(()=>{class n{constructor(t=0,i=0,r=0,s=n.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,r,s=this._order){return this._x=t,this._y=i,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],c=s[8],l=s[1],u=s[5],d=s[9],h=s[2],f=s[6],p=s[10];switch(i){case"XYZ":this._y=Math.asin(en(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-en(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(c,p),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,o),this._z=0);break;case"ZXY":this._x=Math.asin(en(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(l,o));break;case"ZYX":this._y=Math.asin(-en(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(f,p),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(en(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(c,p));break;case"XZY":this._z=Math.asin(-en(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(c,o)):(this._x=Math.atan2(-d,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,i,r){return jR.makeRotationFromQuaternion(t),this.setFromRotationMatrix(jR,i,r)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return $R.setFromEuler(this),this.setFromQuaternion($R,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})();class Cb{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let Y7=0;const qR=new C,hl=new jn,Us=new rt,rm=new C,wd=new C,Z7=new C,K7=new jn,XR=new C(1,0,0),YR=new C(0,1,0),ZR=new C(0,0,1),J7={type:"added"},Q7={type:"removed"};let Gi=(()=>{class n extends tl{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Y7++}),this.uuid=zi(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();const t=new C,i=new Tb,r=new jn,s=new C(1,1,1);i._onChange(function o(){r.setFromEuler(i,!1)}),r._onChange(function a(){i.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new rt},normalMatrix:{value:new dt}}),this.matrix=new rt,this.matrixWorld=new rt,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Cb,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return hl.setFromAxisAngle(t,i),this.quaternion.multiply(hl),this}rotateOnWorldAxis(t,i){return hl.setFromAxisAngle(t,i),this.quaternion.premultiply(hl),this}rotateX(t){return this.rotateOnAxis(XR,t)}rotateY(t){return this.rotateOnAxis(YR,t)}rotateZ(t){return this.rotateOnAxis(ZR,t)}translateOnAxis(t,i){return qR.copy(t).applyQuaternion(this.quaternion),this.position.add(qR.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(XR,t)}translateY(t){return this.translateOnAxis(YR,t)}translateZ(t){return this.translateOnAxis(ZR,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Us.copy(this.matrixWorld).invert())}lookAt(t,i,r){t.isVector3?rm.copy(t):rm.set(t,i,r);const s=this.parent;this.updateWorldMatrix(!0,!1),wd.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Us.lookAt(wd,rm,this.up):Us.lookAt(rm,wd,this.up),this.quaternion.setFromRotationMatrix(Us),s&&(Us.extractRotation(s.matrixWorld),hl.setFromRotationMatrix(Us),this.quaternion.premultiply(hl.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(J7)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(Q7)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),Us.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Us.multiply(t.parent.matrixWorld)),t.applyMatrix4(Us),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectByProperty(t,i);if(void 0!==a)return a}}getObjectsByProperty(t,i){let r=[];this[t]===i&&r.push(this);for(let s=0,o=this.children.length;s<o;s++){const a=this.children[s].getObjectsByProperty(t,i);a.length>0&&(r=r.concat(a))}return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(wd,t,Z7),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(wd,K7,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let r=0,s=i.length;r<s;r++){const o=i[r];(!0===o.matrixWorldAutoUpdate||!0===t)&&o.updateMatrixWorld(t)}}updateWorldMatrix(t,i){const r=this.parent;if(!0===t&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===i){const s=this.children;for(let o=0,a=s.length;o<a;o++){const c=s[o];!0===c.matrixWorldAutoUpdate&&c.updateWorldMatrix(!1,!0)}}}toJSON(t){const i=void 0===t||"string"==typeof t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};function o(c,l){return void 0===c[l.uuid]&&(c[l.uuid]=l.toJSON(t)),l.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);const c=this.geometry.parameters;if(void 0!==c&&void 0!==c.shapes){const l=c.shapes;if(Array.isArray(l))for(let u=0,d=l.length;u<d;u++)o(t.shapes,l[u]);else o(t.shapes,l)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const c=[];for(let l=0,u=this.material.length;l<u;l++)c.push(o(t.materials,this.material[l]));s.material=c}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let c=0;c<this.children.length;c++)s.children.push(this.children[c].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let c=0;c<this.animations.length;c++)s.animations.push(o(t.animations,this.animations[c]))}if(i){const c=a(t.geometries),l=a(t.materials),u=a(t.textures),d=a(t.images),h=a(t.shapes),f=a(t.skeletons),p=a(t.animations),_=a(t.nodes);c.length>0&&(r.geometries=c),l.length>0&&(r.materials=l),u.length>0&&(r.textures=u),d.length>0&&(r.images=d),h.length>0&&(r.shapes=h),f.length>0&&(r.skeletons=f),p.length>0&&(r.animations=p),_.length>0&&(r.nodes=_)}return r.object=s,r;function a(c){const l=[];for(const u in c){const d=c[u];delete d.metadata,l.push(d)}return l}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return n.DEFAULT_UP=new C(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})();const Ar=new C,Bs=new C,Ab=new C,Vs=new C,fl=new C,pl=new C,KR=new C,Db=new C,Ib=new C,Rb=new C;let sm=!1;class Wi{constructor(e=new C,t=new C,i=new C){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),Ar.subVectors(e,t),r.cross(Ar);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){Ar.subVectors(r,t),Bs.subVectors(i,t),Ab.subVectors(e,t);const o=Ar.dot(Ar),a=Ar.dot(Bs),c=Ar.dot(Ab),l=Bs.dot(Bs),u=Bs.dot(Ab),d=o*l-a*a;if(0===d)return s.set(-2,-1,-1);const h=1/d,f=(l*c-a*u)*h,p=(o*u-a*c)*h;return s.set(1-f-p,p,f)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,Vs),Vs.x>=0&&Vs.y>=0&&Vs.x+Vs.y<=1}static getUV(e,t,i,r,s,o,a,c){return!1===sm&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),sm=!0),this.getInterpolation(e,t,i,r,s,o,a,c)}static getInterpolation(e,t,i,r,s,o,a,c){return this.getBarycoord(e,t,i,r,Vs),c.setScalar(0),c.addScaledVector(s,Vs.x),c.addScaledVector(o,Vs.y),c.addScaledVector(a,Vs.z),c}static isFrontFacing(e,t,i,r){return Ar.subVectors(i,t),Bs.subVectors(e,t),Ar.cross(Bs).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ar.subVectors(this.c,this.b),Bs.subVectors(this.a,this.b),.5*Ar.cross(Bs).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Wi.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Wi.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return!1===sm&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),sm=!0),Wi.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}getInterpolation(e,t,i,r,s){return Wi.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return Wi.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Wi.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;fl.subVectors(r,i),pl.subVectors(s,i),Db.subVectors(e,i);const c=fl.dot(Db),l=pl.dot(Db);if(c<=0&&l<=0)return t.copy(i);Ib.subVectors(e,r);const u=fl.dot(Ib),d=pl.dot(Ib);if(u>=0&&d<=u)return t.copy(r);const h=c*d-u*l;if(h<=0&&c>=0&&u<=0)return o=c/(c-u),t.copy(i).addScaledVector(fl,o);Rb.subVectors(e,s);const f=fl.dot(Rb),p=pl.dot(Rb);if(p>=0&&f<=p)return t.copy(s);const _=f*l-c*p;if(_<=0&&l>=0&&p<=0)return a=l/(l-p),t.copy(i).addScaledVector(pl,a);const g=u*p-f*d;if(g<=0&&d-u>=0&&f-p>=0)return KR.subVectors(s,r),a=(d-u)/(d-u+(f-p)),t.copy(r).addScaledVector(KR,a);const m=1/(g+_+h);return o=_*m,a=h*m,t.copy(i).addScaledVector(fl,o).addScaledVector(pl,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let eq=0;class xd extends tl{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:eq++}),this.uuid=zi(),this.name="",this.type="Material",this.blending=1,this.side=mo,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const c=s[a];delete c.metadata,o.push(c)}return o}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(i.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),this.side!==mo&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaHash&&(i.alphaHash=this.alphaHash),!0===this.alphaToCoverage&&(i.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(i.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=this.flatShading),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const JR={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Dr={h:0,s:0,l:0},om={h:0,s:0,l:0};function Pb(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}class Te{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(void 0===t&&void 0===i){const r=e;r&&r.isColor?this.copy(r):"number"==typeof r?this.setHex(r):"string"==typeof r&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Bt){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,sr.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=sr.workingColorSpace){return this.r=e,this.g=t,this.b=i,sr.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=sr.workingColorSpace){if(e=pb(e,1),t=en(t,0,1),i=en(i,0,1),0===t)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=Pb(o,s,e+1/3),this.g=Pb(o,s,e),this.b=Pb(o,s,e-1/3)}return sr.toWorkingColorSpace(this,r),this}setStyle(e,t=Bt){function i(s){void 0!==s&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[2];switch(r[1]){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(3===o)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(6===o)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Bt){const i=JR[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=rl(e.r),this.g=rl(e.g),this.b=rl(e.b),this}copyLinearToSRGB(e){return this.r=_b(e.r),this.g=_b(e.g),this.b=_b(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Bt){return sr.fromWorkingColorSpace(ti.copy(this),e),65536*Math.round(en(255*ti.r,0,255))+256*Math.round(en(255*ti.g,0,255))+Math.round(en(255*ti.b,0,255))}getHexString(e=Bt){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=sr.workingColorSpace){sr.fromWorkingColorSpace(ti.copy(this),t);const i=ti.r,r=ti.g,s=ti.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let c,l;const u=(a+o)/2;if(a===o)c=0,l=0;else{const d=o-a;switch(l=u<=.5?d/(o+a):d/(2-o-a),o){case i:c=(r-s)/d+(r<s?6:0);break;case r:c=(s-i)/d+2;break;case s:c=(i-r)/d+4}c/=6}return e.h=c,e.s=l,e.l=u,e}getRGB(e,t=sr.workingColorSpace){return sr.fromWorkingColorSpace(ti.copy(this),t),e.r=ti.r,e.g=ti.g,e.b=ti.b,e}getStyle(e=Bt){sr.fromWorkingColorSpace(ti.copy(this),e);const t=ti.r,i=ti.g,r=ti.b;return e!==Bt?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*i)},${Math.round(255*r)})`}offsetHSL(e,t,i){return this.getHSL(Dr),Dr.h+=e,Dr.s+=t,Dr.l+=i,this.setHSL(Dr.h,Dr.s,Dr.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Dr),e.getHSL(om);const i=md(Dr.h,om.h,t),r=md(Dr.s,om.s,t),s=md(Dr.l,om.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const ti=new Te;Te.NAMES=JR;class ya extends xd{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Te(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Vp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const _n=new C,am=new ie;class Un{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=35044,this.updateRange={offset:0,count:-1},this.gpuType=Rs,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)am.fromBufferAttribute(this,t),am.applyMatrix3(e),this.setXY(t,am.x,am.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)_n.fromBufferAttribute(this,t),_n.applyMatrix3(e),this.setXYZ(t,_n.x,_n.y,_n.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)_n.fromBufferAttribute(this,t),_n.applyMatrix4(e),this.setXYZ(t,_n.x,_n.y,_n.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)_n.fromBufferAttribute(this,t),_n.applyNormalMatrix(e),this.setXYZ(t,_n.x,_n.y,_n.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)_n.fromBufferAttribute(this,t),_n.transformDirection(e),this.setXYZ(t,_n.x,_n.y,_n.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Ti(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=ot(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Ti(t,this.array)),t}setX(e,t){return this.normalized&&(t=ot(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Ti(t,this.array)),t}setY(e,t){return this.normalized&&(t=ot(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Ti(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ot(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Ti(t,this.array)),t}setW(e,t){return this.normalized&&(t=ot(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=ot(t,this.array),i=ot(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=ot(t,this.array),i=ot(i,this.array),r=ot(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=ot(t,this.array),i=ot(i,this.array),r=ot(r,this.array),s=ot(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class QR extends Un{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class eP extends Un{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class Ie extends Un{constructor(e,t,i){super(new Float32Array(e),t,i)}}let nq=0;const or=new rt,Lb=new Gi,ml=new C,ji=new Ns,Ed=new Ns,Bn=new C;class ft extends tl{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:nq++}),this.uuid=zi(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(VR(e)?eP:QR)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const s=(new dt).getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return or.makeRotationFromQuaternion(e),this.applyMatrix4(or),this}rotateX(e){return or.makeRotationX(e),this.applyMatrix4(or),this}rotateY(e){return or.makeRotationY(e),this.applyMatrix4(or),this}rotateZ(e){return or.makeRotationZ(e),this.applyMatrix4(or),this}translate(e,t,i){return or.makeTranslation(e,t,i),this.applyMatrix4(or),this}scale(e,t,i){return or.makeScale(e,t,i),this.applyMatrix4(or),this}lookAt(e){return Lb.lookAt(e),Lb.updateMatrix(),this.applyMatrix4(Lb.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ml).negate(),this.translate(ml.x,ml.y,ml.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Ie(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Ns);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new C(-1/0,-1/0,-1/0),new C(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)ji.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(Bn.addVectors(this.boundingBox.min,ji.min),this.boundingBox.expandByPoint(Bn),Bn.addVectors(this.boundingBox.max,ji.max),this.boundingBox.expandByPoint(Bn)):(this.boundingBox.expandByPoint(ji.min),this.boundingBox.expandByPoint(ji.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new es);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new C,1/0);if(e){const i=this.boundingSphere.center;if(ji.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)Ed.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(Bn.addVectors(ji.min,Ed.min),ji.expandByPoint(Bn),Bn.addVectors(ji.max,Ed.max),ji.expandByPoint(Bn)):(ji.expandByPoint(Ed.min),ji.expandByPoint(Ed.max));ji.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)Bn.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(Bn));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],c=this.morphTargetsRelative;for(let l=0,u=a.count;l<u;l++)Bn.fromBufferAttribute(a,l),c&&(ml.fromBufferAttribute(e,l),Bn.add(ml)),r=Math.max(r,i.distanceToSquared(Bn))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Un(new Float32Array(4*a),4));const c=this.getAttribute("tangent").array,l=[],u=[];for(let S=0;S<a;S++)l[S]=new C,u[S]=new C;const d=new C,h=new C,f=new C,p=new ie,_=new ie,g=new ie,m=new C,y=new C;function v(S,W,te){d.fromArray(r,3*S),h.fromArray(r,3*W),f.fromArray(r,3*te),p.fromArray(o,2*S),_.fromArray(o,2*W),g.fromArray(o,2*te),h.sub(d),f.sub(d),_.sub(p),g.sub(p);const U=1/(_.x*g.y-g.x*_.y);isFinite(U)&&(m.copy(h).multiplyScalar(g.y).addScaledVector(f,-_.y).multiplyScalar(U),y.copy(f).multiplyScalar(_.x).addScaledVector(h,-g.x).multiplyScalar(U),l[S].add(m),l[W].add(m),l[te].add(m),u[S].add(y),u[W].add(y),u[te].add(y))}let b=this.groups;0===b.length&&(b=[{start:0,count:i.length}]);for(let S=0,W=b.length;S<W;++S){const te=b[S],U=te.start;for(let G=U,O=U+te.count;G<O;G+=3)v(i[G+0],i[G+1],i[G+2])}const x=new C,E=new C,T=new C,P=new C;function w(S){T.fromArray(s,3*S),P.copy(T);const W=l[S];x.copy(W),x.sub(T.multiplyScalar(T.dot(W))).normalize(),E.crossVectors(P,W);const U=E.dot(u[S])<0?-1:1;c[4*S]=x.x,c[4*S+1]=x.y,c[4*S+2]=x.z,c[4*S+3]=U}for(let S=0,W=b.length;S<W;++S){const te=b[S],U=te.start;for(let G=U,O=U+te.count;G<O;G+=3)w(i[G+0]),w(i[G+1]),w(i[G+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new Un(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let h=0,f=i.count;h<f;h++)i.setXYZ(h,0,0,0);const r=new C,s=new C,o=new C,a=new C,c=new C,l=new C,u=new C,d=new C;if(e)for(let h=0,f=e.count;h<f;h+=3){const p=e.getX(h+0),_=e.getX(h+1),g=e.getX(h+2);r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,_),o.fromBufferAttribute(t,g),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),a.fromBufferAttribute(i,p),c.fromBufferAttribute(i,_),l.fromBufferAttribute(i,g),a.add(u),c.add(u),l.add(u),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(_,c.x,c.y,c.z),i.setXYZ(g,l.x,l.y,l.z)}else for(let h=0,f=t.count;h<f;h+=3)r.fromBufferAttribute(t,h+0),s.fromBufferAttribute(t,h+1),o.fromBufferAttribute(t,h+2),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),i.setXYZ(h+0,u.x,u.y,u.z),i.setXYZ(h+1,u.x,u.y,u.z),i.setXYZ(h+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Bn.fromBufferAttribute(e,t),Bn.normalize(),e.setXYZ(t,Bn.x,Bn.y,Bn.z)}toNonIndexed(){function e(a,c){const l=a.array,u=a.itemSize,d=a.normalized,h=new l.constructor(c.length*u);let f=0,p=0;for(let _=0,g=c.length;_<g;_++){f=a.isInterleavedBufferAttribute?c[_]*a.data.stride+a.offset:c[_]*u;for(let m=0;m<u;m++)h[p++]=l[f++]}return new Un(h,u,d)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new ft,i=this.index.array,r=this.attributes;for(const a in r){const l=e(r[a],i);t.setAttribute(a,l)}const s=this.morphAttributes;for(const a in s){const c=[],l=s[a];for(let u=0,d=l.length;u<d;u++){const f=e(l[u],i);c.push(f)}t.morphAttributes[a]=c}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,c=o.length;a<c;a++){const l=o[a];t.addGroup(l.start,l.count,l.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const c=this.parameters;for(const l in c)void 0!==c[l]&&(e[l]=c[l]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const c in i)e.data.attributes[c]=i[c].toJSON(e.data);const r={};let s=!1;for(const c in this.morphAttributes){const l=this.morphAttributes[c],u=[];for(let d=0,h=l.length;d<h;d++)u.push(l[d].toJSON(e.data));u.length>0&&(r[c]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const l in r)this.setAttribute(l,r[l].clone(t));const s=e.morphAttributes;for(const l in s){const u=[],d=s[l];for(let h=0,f=d.length;h<f;h++)u.push(d[h].clone(t));this.morphAttributes[l]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let l=0,u=o.length;l<u;l++){const d=o[l];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const c=e.boundingSphere;return null!==c&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const tP=new rt,ba=new bd,cm=new es,nP=new C,gl=new C,_l=new C,vl=new C,Nb=new C,lm=new C,um=new ie,dm=new ie,hm=new ie,iP=new C,rP=new C,sP=new C,fm=new C,pm=new C;class Ai extends Gi{constructor(e=new ft,t=new ya){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(i.attributes.position,e);const a=this.morphTargetInfluences;if(s&&a){lm.set(0,0,0);for(let c=0,l=s.length;c<l;c++){const u=a[c];0!==u&&(Nb.fromBufferAttribute(s[c],e),lm.addScaledVector(o?Nb:Nb.sub(t),u))}t.add(lm)}return t}raycast(e,t){const i=this.geometry,s=this.matrixWorld;void 0!==this.material&&(null===i.boundingSphere&&i.computeBoundingSphere(),cm.copy(i.boundingSphere),cm.applyMatrix4(s),ba.copy(e.ray).recast(e.near),(!1!==cm.containsPoint(ba.origin)||!(null===ba.intersectSphere(cm,nP)||ba.origin.distanceToSquared(nP)>(e.far-e.near)**2))&&(tP.copy(s).invert(),ba.copy(e.ray).applyMatrix4(tP),(null===i.boundingBox||!1!==ba.intersectsBox(i.boundingBox))&&this._computeIntersections(e,t,ba)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,c=s.attributes.position,l=s.attributes.uv,u=s.attributes.uv1,d=s.attributes.normal,h=s.groups,f=s.drawRange;if(null!==a)if(Array.isArray(o))for(let p=0,_=h.length;p<_;p++){const g=h[p],m=o[g.materialIndex];for(let b=Math.max(g.start,f.start),x=Math.min(a.count,Math.min(g.start+g.count,f.start+f.count));b<x;b+=3)r=mm(this,m,e,i,l,u,d,a.getX(b),a.getX(b+1),a.getX(b+2)),r&&(r.faceIndex=Math.floor(b/3),r.face.materialIndex=g.materialIndex,t.push(r))}else for(let g=Math.max(0,f.start),m=Math.min(a.count,f.start+f.count);g<m;g+=3)r=mm(this,o,e,i,l,u,d,a.getX(g),a.getX(g+1),a.getX(g+2)),r&&(r.faceIndex=Math.floor(g/3),t.push(r));else if(void 0!==c)if(Array.isArray(o))for(let p=0,_=h.length;p<_;p++){const g=h[p],m=o[g.materialIndex];for(let b=Math.max(g.start,f.start),x=Math.min(c.count,Math.min(g.start+g.count,f.start+f.count));b<x;b+=3)r=mm(this,m,e,i,l,u,d,b,b+1,b+2),r&&(r.faceIndex=Math.floor(b/3),r.face.materialIndex=g.materialIndex,t.push(r))}else for(let g=Math.max(0,f.start),m=Math.min(c.count,f.start+f.count);g<m;g+=3)r=mm(this,o,e,i,l,u,d,g,g+1,g+2),r&&(r.faceIndex=Math.floor(g/3),t.push(r))}}function mm(n,e,t,i,r,s,o,a,c,l){n.getVertexPosition(a,gl),n.getVertexPosition(c,_l),n.getVertexPosition(l,vl);const u=function iq(n,e,t,i,r,s,o,a){let c;if(c=e.side===Si?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,e.side===mo,a),null===c)return null;pm.copy(a),pm.applyMatrix4(n.matrixWorld);const l=t.ray.origin.distanceTo(pm);return l<t.near||l>t.far?null:{distance:l,point:pm.clone(),object:n}}(n,e,t,i,gl,_l,vl,fm);if(u){r&&(um.fromBufferAttribute(r,a),dm.fromBufferAttribute(r,c),hm.fromBufferAttribute(r,l),u.uv=Wi.getInterpolation(fm,gl,_l,vl,um,dm,hm,new ie)),s&&(um.fromBufferAttribute(s,a),dm.fromBufferAttribute(s,c),hm.fromBufferAttribute(s,l),u.uv1=Wi.getInterpolation(fm,gl,_l,vl,um,dm,hm,new ie),u.uv2=u.uv1),o&&(iP.fromBufferAttribute(o,a),rP.fromBufferAttribute(o,c),sP.fromBufferAttribute(o,l),u.normal=Wi.getInterpolation(fm,gl,_l,vl,iP,rP,sP,new C),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));const d={a,b:c,c:l,normal:new C,materialIndex:0};Wi.getNormal(gl,_l,vl,d.normal),u.face=d}return u}class yl extends ft{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const c=[],l=[],u=[],d=[];let h=0,f=0;function p(_,g,m,y,v,b,x,E,T,P,w){const S=b/T,W=x/P,te=b/2,U=x/2,V=E/2,G=T+1,O=P+1;let N=0,F=0;const $=new C;for(let Q=0;Q<O;Q++){const k=Q*W-U;for(let X=0;X<G;X++)$[_]=(X*S-te)*y,$[g]=k*v,$[m]=V,l.push($.x,$.y,$.z),$[_]=0,$[g]=0,$[m]=E>0?1:-1,u.push($.x,$.y,$.z),d.push(X/T),d.push(1-Q/P),N+=1}for(let Q=0;Q<P;Q++)for(let k=0;k<T;k++){const he=h+k+G*(Q+1),ce=h+(k+1)+G*(Q+1),Se=h+(k+1)+G*Q;c.push(h+k+G*Q,he,Se),c.push(he,ce,Se),F+=6}a.addGroup(f,F,w),f+=F,h+=N}p("z","y","x",-1,-1,i,t,e,o,s,0),p("z","y","x",1,-1,i,t,-e,o,s,1),p("x","z","y",1,1,e,i,t,r,o,2),p("x","z","y",1,-1,e,i,-t,r,o,3),p("x","y","z",1,-1,e,t,i,r,s,4),p("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(c),this.setAttribute("position",new Ie(l,3)),this.setAttribute("normal",new Ie(u,3)),this.setAttribute("uv",new Ie(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new yl(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function bl(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():e[t][i]=Array.isArray(r)?r.slice():r}}return e}function ui(n){const e={};for(let t=0;t<n.length;t++){const i=bl(n[t]);for(const r in i)e[r]=i[r]}return e}function oP(n){return null===n.getRenderTarget()?n.outputColorSpace:Tr}const sq={clone:bl,merge:ui};class Hs extends xd{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=bl(e.uniforms),this.uniformsGroups=function rq(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class Ob extends Gi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new rt,this.projectionMatrix=new rt,this.projectionMatrixInverse=new rt,this.coordinateSystem=Ps}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class $n extends Ob{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*nl*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*ga*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*nl*Math.atan(Math.tan(.5*ga*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*ga*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const c=o.fullWidth,l=o.fullHeight;s+=o.offsetX*r/c,t-=o.offsetY*i/l,r*=o.width/c,i*=o.height/l}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class cq extends Gi{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null;const r=new $n(-90,1,e,t);r.layers=this.layers,this.add(r);const s=new $n(-90,1,e,t);s.layers=this.layers,this.add(s);const o=new $n(-90,1,e,t);o.layers=this.layers,this.add(o);const a=new $n(-90,1,e,t);a.layers=this.layers,this.add(a);const c=new $n(-90,1,e,t);c.layers=this.layers,this.add(c);const l=new $n(-90,1,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,c]=t;for(const l of t)this.remove(l);if(e===Ps)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),c.up.set(0,1,0),c.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),c.up.set(0,-1,0),c.lookAt(0,0,-1)}for(const l of t)this.add(l),l.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const i=this.renderTarget;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,s,o,a,c,l]=this.children,u=e.getRenderTarget(),d=e.xr.enabled;e.xr.enabled=!1;const h=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,s),e.setRenderTarget(i,2),e.render(t,o),e.setRenderTarget(i,3),e.render(t,a),e.setRenderTarget(i,4),e.render(t,c),i.texture.generateMipmaps=h,e.setRenderTarget(i,5),e.render(t,l),e.setRenderTarget(u),e.xr.enabled=d,i.texture.needsPMREMUpdate=!0}}class gm extends Ls{constructor(e,t,i,r,s,o,a,c,l,u){super(e=void 0!==e?e:[],t=void 0!==t?t:vo,i,r,s,o,a,c,l,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class lq extends xo{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];void 0!==t.encoding&&(_d("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===fa?Bt:""),this.texture=new gm(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:cn}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new yl(5,5,5),s=new Hs({name:"CubemapFromEquirect",uniforms:bl(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:Si,blending:go});s.uniforms.tEquirect.value=t;const o=new Ai(r,s),a=t.minFilter;return t.minFilter===yo&&(t.minFilter=cn),new cq(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const Fb=new C,uq=new C,dq=new dt;class wa{constructor(e=new C(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=Fb.subVectors(i,t).cross(uq.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(Fb),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||dq.getNormalMatrix(e),r=this.coplanarPoint(Fb).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const xa=new es,_m=new C;class kb{constructor(e=new wa,t=new wa,i=new wa,r=new wa,s=new wa,o=new wa){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=Ps){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],c=r[3],l=r[4],u=r[5],d=r[6],h=r[7],f=r[8],p=r[9],_=r[10],g=r[11],m=r[12],y=r[13],v=r[14],b=r[15];if(i[0].setComponents(c-s,h-l,g-f,b-m).normalize(),i[1].setComponents(c+s,h+l,g+f,b+m).normalize(),i[2].setComponents(c+o,h+u,g+p,b+y).normalize(),i[3].setComponents(c-o,h-u,g-p,b-y).normalize(),i[4].setComponents(c-a,h-d,g-_,b-v).normalize(),t===Ps)i[5].setComponents(c+a,h+d,g+_,b+v).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);i[5].setComponents(a,d,_,v).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),xa.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),xa.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(xa)}intersectsSprite(e){return xa.center.set(0,0,0),xa.radius=.7071067811865476,xa.applyMatrix4(e.matrixWorld),this.intersectsSphere(xa)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(_m.x=r.normal.x>0?e.max.x:e.min.x,_m.y=r.normal.y>0?e.max.y:e.min.y,_m.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(_m)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function aP(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function hq(n,e){const t=e.isWebGL2,i=new WeakMap;return{get:function o(l){return l.isInterleavedBufferAttribute&&(l=l.data),i.get(l)},remove:function a(l){l.isInterleavedBufferAttribute&&(l=l.data);const u=i.get(l);u&&(n.deleteBuffer(u.buffer),i.delete(l))},update:function c(l,u){if(l.isGLBufferAttribute){const h=i.get(l);return void((!h||h.version<l.version)&&i.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version}))}l.isInterleavedBufferAttribute&&(l=l.data);const d=i.get(l);void 0===d?i.set(l,function r(l,u){const d=l.array,h=l.usage,f=n.createBuffer();let p;if(n.bindBuffer(u,f),n.bufferData(u,d,h),l.onUploadCallback(),d instanceof Float32Array)p=n.FLOAT;else if(d instanceof Uint16Array)if(l.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");p=n.HALF_FLOAT}else p=n.UNSIGNED_SHORT;else if(d instanceof Int16Array)p=n.SHORT;else if(d instanceof Uint32Array)p=n.UNSIGNED_INT;else if(d instanceof Int32Array)p=n.INT;else if(d instanceof Int8Array)p=n.BYTE;else if(d instanceof Uint8Array)p=n.UNSIGNED_BYTE;else{if(!(d instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);p=n.UNSIGNED_BYTE}return{buffer:f,type:p,bytesPerElement:d.BYTES_PER_ELEMENT,version:l.version}}(l,u)):d.version<l.version&&(function s(l,u,d){const h=u.array,f=u.updateRange;n.bindBuffer(d,l),-1===f.count?n.bufferSubData(d,0,h):(t?n.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h,f.offset,f.count):n.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h.subarray(f.offset,f.offset+f.count)),f.count=-1),u.onUploadCallback()}(d.buffer,l,u),d.version=l.version)}}}class vm extends ft{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),c=Math.floor(r),l=a+1,u=c+1,d=e/a,h=t/c,f=[],p=[],_=[],g=[];for(let m=0;m<u;m++){const y=m*h-o;for(let v=0;v<l;v++)p.push(v*d-s,-y,0),_.push(0,0,1),g.push(v/a),g.push(1-m/c)}for(let m=0;m<c;m++)for(let y=0;y<a;y++){const b=y+l*(m+1),x=y+1+l*(m+1),E=y+1+l*m;f.push(y+l*m,b,E),f.push(b,x,E)}this.setIndex(f),this.setAttribute("position",new Ie(p,3)),this.setAttribute("normal",new Ie(_,3)),this.setAttribute("uv",new Ie(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new vm(e.width,e.height,e.widthSegments,e.heightSegments)}}const ct={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tanisotropyV /= material.anisotropy;\n\tmaterial.anisotropy = saturate( material.anisotropy );\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometry.viewDir, geometry.normal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},ve={common:{diffuse:{value:new Te(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new dt},alphaMap:{value:null},alphaMapTransform:{value:new dt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new dt}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new dt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new dt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new dt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new dt},normalScale:{value:new ie(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new dt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new dt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new dt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new dt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Te(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Te(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new dt},alphaTest:{value:0},uvTransform:{value:new dt}},sprite:{diffuse:{value:new Te(16777215)},opacity:{value:1},center:{value:new ie(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new dt},alphaMap:{value:null},alphaMapTransform:{value:new dt},alphaTest:{value:0}}},ts={basic:{uniforms:ui([ve.common,ve.specularmap,ve.envmap,ve.aomap,ve.lightmap,ve.fog]),vertexShader:ct.meshbasic_vert,fragmentShader:ct.meshbasic_frag},lambert:{uniforms:ui([ve.common,ve.specularmap,ve.envmap,ve.aomap,ve.lightmap,ve.emissivemap,ve.bumpmap,ve.normalmap,ve.displacementmap,ve.fog,ve.lights,{emissive:{value:new Te(0)}}]),vertexShader:ct.meshlambert_vert,fragmentShader:ct.meshlambert_frag},phong:{uniforms:ui([ve.common,ve.specularmap,ve.envmap,ve.aomap,ve.lightmap,ve.emissivemap,ve.bumpmap,ve.normalmap,ve.displacementmap,ve.fog,ve.lights,{emissive:{value:new Te(0)},specular:{value:new Te(1118481)},shininess:{value:30}}]),vertexShader:ct.meshphong_vert,fragmentShader:ct.meshphong_frag},standard:{uniforms:ui([ve.common,ve.envmap,ve.aomap,ve.lightmap,ve.emissivemap,ve.bumpmap,ve.normalmap,ve.displacementmap,ve.roughnessmap,ve.metalnessmap,ve.fog,ve.lights,{emissive:{value:new Te(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ct.meshphysical_vert,fragmentShader:ct.meshphysical_frag},toon:{uniforms:ui([ve.common,ve.aomap,ve.lightmap,ve.emissivemap,ve.bumpmap,ve.normalmap,ve.displacementmap,ve.gradientmap,ve.fog,ve.lights,{emissive:{value:new Te(0)}}]),vertexShader:ct.meshtoon_vert,fragmentShader:ct.meshtoon_frag},matcap:{uniforms:ui([ve.common,ve.bumpmap,ve.normalmap,ve.displacementmap,ve.fog,{matcap:{value:null}}]),vertexShader:ct.meshmatcap_vert,fragmentShader:ct.meshmatcap_frag},points:{uniforms:ui([ve.points,ve.fog]),vertexShader:ct.points_vert,fragmentShader:ct.points_frag},dashed:{uniforms:ui([ve.common,ve.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ct.linedashed_vert,fragmentShader:ct.linedashed_frag},depth:{uniforms:ui([ve.common,ve.displacementmap]),vertexShader:ct.depth_vert,fragmentShader:ct.depth_frag},normal:{uniforms:ui([ve.common,ve.bumpmap,ve.normalmap,ve.displacementmap,{opacity:{value:1}}]),vertexShader:ct.meshnormal_vert,fragmentShader:ct.meshnormal_frag},sprite:{uniforms:ui([ve.sprite,ve.fog]),vertexShader:ct.sprite_vert,fragmentShader:ct.sprite_frag},background:{uniforms:{uvTransform:{value:new dt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ct.background_vert,fragmentShader:ct.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:ct.backgroundCube_vert,fragmentShader:ct.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ct.cube_vert,fragmentShader:ct.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ct.equirect_vert,fragmentShader:ct.equirect_frag},distanceRGBA:{uniforms:ui([ve.common,ve.displacementmap,{referencePosition:{value:new C},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ct.distanceRGBA_vert,fragmentShader:ct.distanceRGBA_frag},shadow:{uniforms:ui([ve.lights,ve.fog,{color:{value:new Te(0)},opacity:{value:1}}]),vertexShader:ct.shadow_vert,fragmentShader:ct.shadow_frag}};ts.physical={uniforms:ui([ts.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new dt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new dt},clearcoatNormalScale:{value:new ie(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new dt},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new dt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new dt},sheen:{value:0},sheenColor:{value:new Te(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new dt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new dt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new dt},transmissionSamplerSize:{value:new ie},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new dt},attenuationDistance:{value:0},attenuationColor:{value:new Te(0)},specularColor:{value:new Te(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new dt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new dt},anisotropyVector:{value:new ie},anisotropyMap:{value:null},anisotropyMapTransform:{value:new dt}}]),vertexShader:ct.meshphysical_vert,fragmentShader:ct.meshphysical_frag};const ym={r:0,b:0,g:0};function uY(n,e,t,i,r,s,o){const a=new Te(0);let l,u,c=!0===s?0:1,d=null,h=0,f=null;function _(g,m){g.getRGB(ym,oP(n)),i.buffers.color.setClear(ym.r,ym.g,ym.b,m,o)}return{getClearColor:function(){return a},setClearColor:function(g,m=1){a.set(g),c=m,_(a,c)},getClearAlpha:function(){return c},setClearAlpha:function(g){c=g,_(a,c)},render:function p(g,m){let y=!1,v=!0===m.isScene?m.background:null;v&&v.isTexture&&(v=(m.backgroundBlurriness>0?t:e).get(v)),null===v?_(a,c):v&&v.isColor&&(_(v,1),y=!0);const b=n.xr.getEnvironmentBlendMode();"additive"===b?i.buffers.color.setClear(0,0,0,1,o):"alpha-blend"===b&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||y)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),v&&(v.isCubeTexture||v.mapping===fd)?(void 0===u&&(u=new Ai(new yl(1,1,1),new Hs({name:"BackgroundCubeMaterial",uniforms:bl(ts.backgroundCube.uniforms),vertexShader:ts.backgroundCube.vertexShader,fragmentShader:ts.backgroundCube.fragmentShader,side:Si,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(x,E,T){this.matrixWorld.copyPosition(T.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),u.material.uniforms.envMap.value=v,u.material.uniforms.flipEnvMap.value=v.isCubeTexture&&!1===v.isRenderTargetTexture?-1:1,u.material.uniforms.backgroundBlurriness.value=m.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,u.material.toneMapped=v.colorSpace!==Bt,(d!==v||h!==v.version||f!==n.toneMapping)&&(u.material.needsUpdate=!0,d=v,h=v.version,f=n.toneMapping),u.layers.enableAll(),g.unshift(u,u.geometry,u.material,0,0,null)):v&&v.isTexture&&(void 0===l&&(l=new Ai(new vm(2,2),new Hs({name:"BackgroundMaterial",uniforms:bl(ts.background.uniforms),vertexShader:ts.background.vertexShader,fragmentShader:ts.background.fragmentShader,side:mo,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=v,l.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,l.material.toneMapped=v.colorSpace!==Bt,!0===v.matrixAutoUpdate&&v.updateMatrix(),l.material.uniforms.uvTransform.value.copy(v.matrix),(d!==v||h!==v.version||f!==n.toneMapping)&&(l.material.needsUpdate=!0,d=v,h=v.version,f=n.toneMapping),l.layers.enableAll(),g.unshift(l,l.geometry,l.material,0,0,null))}}}function dY(n,e,t,i){const r=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,a={},c=g(null);let l=c,u=!1;function f(V){return i.isWebGL2?n.bindVertexArray(V):s.bindVertexArrayOES(V)}function p(V){return i.isWebGL2?n.deleteVertexArray(V):s.deleteVertexArrayOES(V)}function g(V){const G=[],O=[],N=[];for(let F=0;F<r;F++)G[F]=0,O[F]=0,N[F]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:G,enabledAttributes:O,attributeDivisors:N,object:V,attributes:{},index:null}}function v(){const V=l.newAttributes;for(let G=0,O=V.length;G<O;G++)V[G]=0}function b(V){x(V,0)}function x(V,G){const N=l.enabledAttributes,F=l.attributeDivisors;l.newAttributes[V]=1,0===N[V]&&(n.enableVertexAttribArray(V),N[V]=1),F[V]!==G&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](V,G),F[V]=G)}function E(){const V=l.newAttributes,G=l.enabledAttributes;for(let O=0,N=G.length;O<N;O++)G[O]!==V[O]&&(n.disableVertexAttribArray(O),G[O]=0)}function T(V,G,O,N,F,$,Q){!0===Q?n.vertexAttribIPointer(V,G,O,F,$):n.vertexAttribPointer(V,G,O,N,F,$)}function te(){U(),u=!0,l!==c&&(l=c,f(l.object))}function U(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:function d(V,G,O,N,F){let $=!1;if(o){const Q=function _(V,G,O){const N=!0===O.wireframe;let F=a[V.id];void 0===F&&(F={},a[V.id]=F);let $=F[G.id];void 0===$&&($={},F[G.id]=$);let Q=$[N];return void 0===Q&&(Q=g(function h(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}()),$[N]=Q),Q}(N,O,G);l!==Q&&(l=Q,f(l.object)),$=function m(V,G,O,N){const F=l.attributes,$=G.attributes;let Q=0;const k=O.getAttributes();for(const X in k)if(k[X].location>=0){const ce=F[X];let Se=$[X];if(void 0===Se&&("instanceMatrix"===X&&V.instanceMatrix&&(Se=V.instanceMatrix),"instanceColor"===X&&V.instanceColor&&(Se=V.instanceColor)),void 0===ce||ce.attribute!==Se||Se&&ce.data!==Se.data)return!0;Q++}return l.attributesNum!==Q||l.index!==N}(V,N,O,F),$&&function y(V,G,O,N){const F={},$=G.attributes;let Q=0;const k=O.getAttributes();for(const X in k)if(k[X].location>=0){let ce=$[X];void 0===ce&&("instanceMatrix"===X&&V.instanceMatrix&&(ce=V.instanceMatrix),"instanceColor"===X&&V.instanceColor&&(ce=V.instanceColor));const Se={};Se.attribute=ce,ce&&ce.data&&(Se.data=ce.data),F[X]=Se,Q++}l.attributes=F,l.attributesNum=Q,l.index=N}(V,N,O,F)}else{const Q=!0===G.wireframe;(l.geometry!==N.id||l.program!==O.id||l.wireframe!==Q)&&(l.geometry=N.id,l.program=O.id,l.wireframe=Q,$=!0)}null!==F&&t.update(F,n.ELEMENT_ARRAY_BUFFER),($||u)&&(u=!1,function P(V,G,O,N){if(!1===i.isWebGL2&&(V.isInstancedMesh||N.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;v();const F=N.attributes,$=O.getAttributes(),Q=G.defaultAttributeValues;for(const k in $){const X=$[k];if(X.location>=0){let he=F[k];if(void 0===he&&("instanceMatrix"===k&&V.instanceMatrix&&(he=V.instanceMatrix),"instanceColor"===k&&V.instanceColor&&(he=V.instanceColor)),void 0!==he){const ce=he.normalized,Se=he.itemSize,Ue=t.get(he);if(void 0===Ue)continue;const Me=Ue.buffer,Re=Ue.type,Ze=Ue.bytesPerElement,It=!0===i.isWebGL2&&(Re===n.INT||Re===n.UNSIGNED_INT||1013===he.gpuType);if(he.isInterleavedBufferAttribute){const Be=he.data,R=Be.stride,me=he.offset;if(Be.isInstancedInterleavedBuffer){for(let ee=0;ee<X.locationSize;ee++)x(X.location+ee,Be.meshPerAttribute);!0!==V.isInstancedMesh&&void 0===N._maxInstanceCount&&(N._maxInstanceCount=Be.meshPerAttribute*Be.count)}else for(let ee=0;ee<X.locationSize;ee++)b(X.location+ee);n.bindBuffer(n.ARRAY_BUFFER,Me);for(let ee=0;ee<X.locationSize;ee++)T(X.location+ee,Se/X.locationSize,Re,ce,R*Ze,(me+Se/X.locationSize*ee)*Ze,It)}else{if(he.isInstancedBufferAttribute){for(let Be=0;Be<X.locationSize;Be++)x(X.location+Be,he.meshPerAttribute);!0!==V.isInstancedMesh&&void 0===N._maxInstanceCount&&(N._maxInstanceCount=he.meshPerAttribute*he.count)}else for(let Be=0;Be<X.locationSize;Be++)b(X.location+Be);n.bindBuffer(n.ARRAY_BUFFER,Me);for(let Be=0;Be<X.locationSize;Be++)T(X.location+Be,Se/X.locationSize,Re,ce,Se*Ze,Se/X.locationSize*Be*Ze,It)}}else if(void 0!==Q){const ce=Q[k];if(void 0!==ce)switch(ce.length){case 2:n.vertexAttrib2fv(X.location,ce);break;case 3:n.vertexAttrib3fv(X.location,ce);break;case 4:n.vertexAttrib4fv(X.location,ce);break;default:n.vertexAttrib1fv(X.location,ce)}}}}E()}(V,G,O,N),null!==F&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(F).buffer))},reset:te,resetDefaultState:U,dispose:function w(){te();for(const V in a){const G=a[V];for(const O in G){const N=G[O];for(const F in N)p(N[F].object),delete N[F];delete G[O]}delete a[V]}},releaseStatesOfGeometry:function S(V){if(void 0===a[V.id])return;const G=a[V.id];for(const O in G){const N=G[O];for(const F in N)p(N[F].object),delete N[F];delete G[O]}delete a[V.id]},releaseStatesOfProgram:function W(V){for(const G in a){const O=a[G];if(void 0===O[V.id])continue;const N=O[V.id];for(const F in N)p(N[F].object),delete N[F];delete O[V.id]}},initAttributes:v,enableAttribute:b,disableUnusedAttributes:E}}function hY(n,e,t,i){const r=i.isWebGL2;let s;this.setMode=function o(l){s=l},this.render=function a(l,u){n.drawArrays(s,l,u),t.update(u,s,1)},this.renderInstances=function c(l,u,d){if(0===d)return;let h,f;if(r)h=n,f="drawArraysInstanced";else if(h=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",null===h)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[f](s,l,u,d),t.update(u,s,d)}}function fY(n,e,t){let i;function s(T){if("highp"===T){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";T="mediump"}return"mediump"===T&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&"WebGL2RenderingContext"===n.constructor.name;let a=void 0!==t.precision?t.precision:"highp";const c=s(a);c!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",c,"instead."),a=c);const l=o||e.has("WEBGL_draw_buffers"),u=!0===t.logarithmicDepthBuffer,d=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),h=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),f=n.getParameter(n.MAX_TEXTURE_SIZE),p=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),_=n.getParameter(n.MAX_VERTEX_ATTRIBS),g=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),m=n.getParameter(n.MAX_VARYING_VECTORS),y=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),v=h>0,b=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:l,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const T=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:d,maxVertexTextures:h,maxTextureSize:f,maxCubemapSize:p,maxAttributes:_,maxVertexUniforms:g,maxVaryings:m,maxFragmentUniforms:y,vertexTextures:v,floatFragmentTextures:b,floatVertexTextures:v&&b,maxSamples:o?n.getParameter(n.MAX_SAMPLES):0}}function pY(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new wa,a=new dt,c={value:null,needsUpdate:!1};function u(d,h,f,p){const _=null!==d?d.length:0;let g=null;if(0!==_){if(g=c.value,!0!==p||null===g){const m=f+4*_,y=h.matrixWorldInverse;a.getNormalMatrix(y),(null===g||g.length<m)&&(g=new Float32Array(m));for(let v=0,b=f;v!==_;++v,b+=4)o.copy(d[v]).applyMatrix4(y,a),o.normal.toArray(g,b),g[b+3]=o.constant}c.value=g,c.needsUpdate=!0}return e.numPlanes=_,e.numIntersection=0,g}this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(d,h){const f=0!==d.length||h||0!==i||r;return r=h,i=d.length,f},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,h){t=u(d,h,0)},this.setState=function(d,h,f){const p=d.clippingPlanes,_=d.clipIntersection,g=d.clipShadows,m=n.get(d);if(!r||null===p||0===p.length||s&&!g)s?u(null):function l(){c.value!==t&&(c.value=t,c.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}();else{const y=s?0:i,v=4*y;let b=m.clippingState||null;c.value=b,b=u(p,h,v,f);for(let x=0;x!==v;++x)b[x]=t[x];m.clippingState=b,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=y}}}function mY(n){let e=new WeakMap;function t(o,a){return 303===a?o.mapping=vo:304===a&&(o.mapping=ua),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const c=e.get(a);void 0!==c&&(e.delete(a),c.dispose())}return{get:function i(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(303===a||304===a){if(e.has(o))return t(e.get(o).texture,o.mapping);{const c=o.image;if(c&&c.height>0){const l=new lq(c.height/2);return l.fromEquirectangularTexture(n,o),e.set(o,l),o.addEventListener("dispose",r),t(l.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}class Ub extends Ob{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,c=r-t;if(null!==this.view&&this.view.enabled){const l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=l*this.view.offsetX,o=s+l*this.view.width,a-=u*this.view.offsetY,c=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,c,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const cP=[.125,.215,.35,.446,.526,.582],Bb=new Ub,lP=new Te;let Vb=null;const Ea=(1+Math.sqrt(5))/2,El=1/Ea,uP=[new C(1,1,1),new C(-1,1,1),new C(1,1,-1),new C(-1,1,-1),new C(0,Ea,El),new C(0,Ea,-El),new C(El,0,Ea),new C(-El,0,Ea),new C(Ea,El,0),new C(-Ea,El,0)];class dP{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){Vb=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=pP(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=fP(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Vb),e.scissorTest=!1,bm(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===vo||e.mapping===ua?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),Vb=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:cn,minFilter:cn,generateMipmaps:!1,type:pd,format:rr,colorSpace:Tr,depthBuffer:!1},r=hP(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=hP(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function gY(n){const e=[],t=[],i=[];let r=n;const s=n-4+1+cP.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let c=1/a;o>n-4?c=cP[o-n+4-1]:0===o&&(c=0),i.push(c);const l=1/(a-2),u=-l,d=1+l,h=[u,u,d,u,d,d,u,u,d,d,u,d],f=6,p=6,_=3,g=2,m=1,y=new Float32Array(_*p*f),v=new Float32Array(g*p*f),b=new Float32Array(m*p*f);for(let E=0;E<f;E++){const T=E%3*2/3-1,P=E>2?0:-1;y.set([T,P,0,T+2/3,P,0,T+2/3,P+1,0,T,P,0,T+2/3,P+1,0,T,P+1,0],_*p*E),v.set(h,g*p*E),b.set([E,E,E,E,E,E],m*p*E)}const x=new ft;x.setAttribute("position",new Un(y,_)),x.setAttribute("uv",new Un(v,g)),x.setAttribute("faceIndex",new Un(b,m)),e.push(x),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(s)),this._blurMaterial=function _Y(n,e,t){const i=new Float32Array(20),r=new C(0,1,0);return new Hs({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:go,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new Ai(this._lodPlanes[0],e);this._renderer.compile(t,Bb)}_sceneToCubeUV(e,t,i,r){const a=new $n(90,1,t,i),c=[1,-1,1,1,1,1],l=[1,1,1,-1,-1,-1],u=this._renderer,d=u.autoClear,h=u.toneMapping;u.getClearColor(lP),u.toneMapping=_o,u.autoClear=!1;const f=new ya({name:"PMREM.Background",side:Si,depthWrite:!1,depthTest:!1}),p=new Ai(new yl,f);let _=!1;const g=e.background;g?g.isColor&&(f.color.copy(g),e.background=null,_=!0):(f.color.copy(lP),_=!0);for(let m=0;m<6;m++){const y=m%3;0===y?(a.up.set(0,c[m],0),a.lookAt(l[m],0,0)):1===y?(a.up.set(0,0,c[m]),a.lookAt(0,l[m],0)):(a.up.set(0,c[m],0),a.lookAt(0,0,l[m]));const v=this._cubeSize;bm(r,y*v,m>2?v:0,v,v),u.setRenderTarget(r),_&&u.render(p,a),u.render(e,a)}p.geometry.dispose(),p.material.dispose(),u.toneMapping=h,u.autoClear=d,e.background=g}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===vo||e.mapping===ua;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=pP()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=fP());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Ai(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const c=this._cubeSize;bm(t,0,0,3*c,2*c),i.setRenderTarget(t),i.render(o,Bb)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,uP[(r-1)%uP.length])}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const c=this._renderer,l=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const d=new Ai(this._lodPlanes[r],l),h=l.uniforms,f=this._sizeLods[i]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/39,_=s/p,g=isFinite(s)?1+Math.floor(3*_):20;g>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to 20`);const m=[];let y=0;for(let T=0;T<20;++T){const P=T/_,w=Math.exp(-P*P/2);m.push(w),0===T?y+=w:T<g&&(y+=2*w)}for(let T=0;T<m.length;T++)m[T]=m[T]/y;h.envMap.value=e.texture,h.samples.value=g,h.weights.value=m,h.latitudinal.value="latitudinal"===o,a&&(h.poleAxis.value=a);const{_lodMax:v}=this;h.dTheta.value=p,h.mipInt.value=v-i;const b=this._sizeLods[r];bm(t,3*b*(r>v-4?r-v+4:0),4*(this._cubeSize-b),3*b,2*b),c.setRenderTarget(t),c.render(d,Bb)}}function hP(n,e,t){const i=new xo(n,e,t);return i.texture.mapping=fd,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function bm(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function fP(){return new Hs({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:go,depthTest:!1,depthWrite:!1})}function pP(){return new Hs({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:go,depthTest:!1,depthWrite:!1})}function vY(n){let e=new WeakMap,t=null;function s(a){const c=a.target;c.removeEventListener("dispose",s);const l=e.get(c);void 0!==l&&(e.delete(c),l.dispose())}return{get:function i(a){if(a&&a.isTexture){const c=a.mapping,l=303===c||304===c,u=c===vo||c===ua;if(l||u){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let d=e.get(a);return null===t&&(t=new dP(n)),d=l?t.fromEquirectangular(a,d):t.fromCubemap(a,d),e.set(a,d),d.texture}if(e.has(a))return e.get(a).texture;{const d=a.image;if(l&&d&&d.height>0||u&&d&&function r(a){let c=0;for(let u=0;u<6;u++)void 0!==a[u]&&c++;return 6===c}(d)){null===t&&(t=new dP(n));const h=l?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,h),a.addEventListener("dispose",s),h.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function yY(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function bY(n,e,t,i){const r={},s=new WeakMap;function o(d){const h=d.target;null!==h.index&&e.remove(h.index);for(const p in h.attributes)e.remove(h.attributes[p]);for(const p in h.morphAttributes){const _=h.morphAttributes[p];for(let g=0,m=_.length;g<m;g++)e.remove(_[g])}h.removeEventListener("dispose",o),delete r[h.id];const f=s.get(h);f&&(e.remove(f),s.delete(h)),i.releaseStatesOfGeometry(h),!0===h.isInstancedBufferGeometry&&delete h._maxInstanceCount,t.memory.geometries--}function l(d){const h=[],f=d.index,p=d.attributes.position;let _=0;if(null!==f){const y=f.array;_=f.version;for(let v=0,b=y.length;v<b;v+=3){const x=y[v+0],E=y[v+1],T=y[v+2];h.push(x,E,E,T,T,x)}}else{if(void 0===p)return;_=p.version;for(let v=0,b=p.array.length/3-1;v<b;v+=3){const x=v+0,E=v+1,T=v+2;h.push(x,E,E,T,T,x)}}const g=new(VR(h)?eP:QR)(h,1);g.version=_;const m=s.get(d);m&&e.remove(m),s.set(d,g)}return{get:function a(d,h){return!0===r[h.id]||(h.addEventListener("dispose",o),r[h.id]=!0,t.memory.geometries++),h},update:function c(d){const h=d.attributes;for(const p in h)e.update(h[p],n.ARRAY_BUFFER);const f=d.morphAttributes;for(const p in f){const _=f[p];for(let g=0,m=_.length;g<m;g++)e.update(_[g],n.ARRAY_BUFFER)}},getWireframeAttribute:function u(d){const h=s.get(d);if(h){const f=d.index;null!==f&&h.version<f.version&&l(d)}else l(d);return s.get(d)}}}function wY(n,e,t,i){const r=i.isWebGL2;let s,a,c;this.setMode=function o(h){s=h},this.setIndex=function l(h){a=h.type,c=h.bytesPerElement},this.render=function u(h,f){n.drawElements(s,f,a,h*c),t.update(f,s,1)},this.renderInstances=function d(h,f,p){if(0===p)return;let _,g;if(r)_=n,g="drawElementsInstanced";else if(_=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",null===_)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");_[g](s,f,a,h*c,p),t.update(f,s,p)}}function xY(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function MY(n,e){return n[0]-e[0]}function EY(n,e){return Math.abs(e[1])-Math.abs(n[1])}function SY(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new Rt,a=[];for(let l=0;l<8;l++)a[l]=[l,0];return{update:function c(l,u,d){const h=l.morphTargetInfluences;if(!0===e.isWebGL2){const f=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,p=void 0!==f?f.length:0;let _=s.get(u);if(void 0===_||_.count!==p){let V=function(){te.dispose(),s.delete(u),u.removeEventListener("dispose",V)};void 0!==_&&_.texture.dispose();const y=void 0!==u.morphAttributes.position,v=void 0!==u.morphAttributes.normal,b=void 0!==u.morphAttributes.color,x=u.morphAttributes.position||[],E=u.morphAttributes.normal||[],T=u.morphAttributes.color||[];let P=0;!0===y&&(P=1),!0===v&&(P=2),!0===b&&(P=3);let w=u.attributes.position.count*P,S=1;w>e.maxTextureSize&&(S=Math.ceil(w/e.maxTextureSize),w=e.maxTextureSize);const W=new Float32Array(w*S*4*p),te=new yb(W,w,S,p);te.type=Rs,te.needsUpdate=!0;const U=4*P;for(let G=0;G<p;G++){const O=x[G],N=E[G],F=T[G],$=w*S*4*G;for(let Q=0;Q<O.count;Q++){const k=Q*U;!0===y&&(o.fromBufferAttribute(O,Q),W[$+k+0]=o.x,W[$+k+1]=o.y,W[$+k+2]=o.z,W[$+k+3]=0),!0===v&&(o.fromBufferAttribute(N,Q),W[$+k+4]=o.x,W[$+k+5]=o.y,W[$+k+6]=o.z,W[$+k+7]=0),!0===b&&(o.fromBufferAttribute(F,Q),W[$+k+8]=o.x,W[$+k+9]=o.y,W[$+k+10]=o.z,W[$+k+11]=4===F.itemSize?o.w:1)}}_={count:p,texture:te,size:new ie(w,S)},s.set(u,_),u.addEventListener("dispose",V)}let g=0;for(let y=0;y<h.length;y++)g+=h[y];const m=u.morphTargetsRelative?1:1-g;d.getUniforms().setValue(n,"morphTargetBaseInfluence",m),d.getUniforms().setValue(n,"morphTargetInfluences",h),d.getUniforms().setValue(n,"morphTargetsTexture",_.texture,t),d.getUniforms().setValue(n,"morphTargetsTextureSize",_.size)}else{const f=void 0===h?0:h.length;let p=i[u.id];if(void 0===p||p.length!==f){p=[];for(let v=0;v<f;v++)p[v]=[v,0];i[u.id]=p}for(let v=0;v<f;v++){const b=p[v];b[0]=v,b[1]=h[v]}p.sort(EY);for(let v=0;v<8;v++)v<f&&p[v][1]?(a[v][0]=p[v][0],a[v][1]=p[v][1]):(a[v][0]=Number.MAX_SAFE_INTEGER,a[v][1]=0);a.sort(MY);const _=u.morphAttributes.position,g=u.morphAttributes.normal;let m=0;for(let v=0;v<8;v++){const b=a[v],x=b[0],E=b[1];x!==Number.MAX_SAFE_INTEGER&&E?(_&&u.getAttribute("morphTarget"+v)!==_[x]&&u.setAttribute("morphTarget"+v,_[x]),g&&u.getAttribute("morphNormal"+v)!==g[x]&&u.setAttribute("morphNormal"+v,g[x]),r[v]=E,m+=E):(_&&!0===u.hasAttribute("morphTarget"+v)&&u.deleteAttribute("morphTarget"+v),g&&!0===u.hasAttribute("morphNormal"+v)&&u.deleteAttribute("morphNormal"+v),r[v]=0)}const y=u.morphTargetsRelative?1:1-m;d.getUniforms().setValue(n,"morphTargetBaseInfluence",y),d.getUniforms().setValue(n,"morphTargetInfluences",r)}}}}function TY(n,e,t,i){let r=new WeakMap;function a(c){const l=c.target;l.removeEventListener("dispose",a),t.remove(l.instanceMatrix),null!==l.instanceColor&&t.remove(l.instanceColor)}return{update:function s(c){const l=i.render.frame,d=e.get(c,c.geometry);if(r.get(d)!==l&&(e.update(d),r.set(d,l)),c.isInstancedMesh&&(!1===c.hasEventListener("dispose",a)&&c.addEventListener("dispose",a),r.get(c)!==l&&(t.update(c.instanceMatrix,n.ARRAY_BUFFER),null!==c.instanceColor&&t.update(c.instanceColor,n.ARRAY_BUFFER),r.set(c,l))),c.isSkinnedMesh){const h=c.skeleton;r.get(h)!==l&&(h.update(),r.set(h,l))}return d},dispose:function o(){r=new WeakMap}}}const mP=new Ls,gP=new yb,_P=new GR,vP=new gm,yP=[],bP=[],wP=new Float32Array(16),xP=new Float32Array(9),MP=new Float32Array(4);function Sl(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=yP[r];if(void 0===s&&(s=new Float32Array(r),yP[r]=s),0!==e){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function An(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Dn(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function wm(n,e){let t=bP[e];void 0===t&&(t=new Int32Array(e),bP[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function CY(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function AY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(An(t,e))return;n.uniform2fv(this.addr,e),Dn(t,e)}}function DY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(An(t,e))return;n.uniform3fv(this.addr,e),Dn(t,e)}}function IY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(An(t,e))return;n.uniform4fv(this.addr,e),Dn(t,e)}}function RY(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(An(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Dn(t,e)}else{if(An(t,i))return;MP.set(i),n.uniformMatrix2fv(this.addr,!1,MP),Dn(t,i)}}function PY(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(An(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Dn(t,e)}else{if(An(t,i))return;xP.set(i),n.uniformMatrix3fv(this.addr,!1,xP),Dn(t,i)}}function LY(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(An(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Dn(t,e)}else{if(An(t,i))return;wP.set(i),n.uniformMatrix4fv(this.addr,!1,wP),Dn(t,i)}}function NY(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function OY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(An(t,e))return;n.uniform2iv(this.addr,e),Dn(t,e)}}function FY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(An(t,e))return;n.uniform3iv(this.addr,e),Dn(t,e)}}function kY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(An(t,e))return;n.uniform4iv(this.addr,e),Dn(t,e)}}function UY(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function BY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(An(t,e))return;n.uniform2uiv(this.addr,e),Dn(t,e)}}function VY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(An(t,e))return;n.uniform3uiv(this.addr,e),Dn(t,e)}}function zY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(An(t,e))return;n.uniform4uiv(this.addr,e),Dn(t,e)}}function HY(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||mP,r)}function GY(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||_P,r)}function WY(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||vP,r)}function jY(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||gP,r)}function qY(n,e){n.uniform1fv(this.addr,e)}function XY(n,e){const t=Sl(e,this.size,2);n.uniform2fv(this.addr,t)}function YY(n,e){const t=Sl(e,this.size,3);n.uniform3fv(this.addr,t)}function ZY(n,e){const t=Sl(e,this.size,4);n.uniform4fv(this.addr,t)}function KY(n,e){const t=Sl(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function JY(n,e){const t=Sl(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function QY(n,e){const t=Sl(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function eZ(n,e){n.uniform1iv(this.addr,e)}function tZ(n,e){n.uniform2iv(this.addr,e)}function nZ(n,e){n.uniform3iv(this.addr,e)}function iZ(n,e){n.uniform4iv(this.addr,e)}function rZ(n,e){n.uniform1uiv(this.addr,e)}function sZ(n,e){n.uniform2uiv(this.addr,e)}function oZ(n,e){n.uniform3uiv(this.addr,e)}function aZ(n,e){n.uniform4uiv(this.addr,e)}function cZ(n,e,t){const i=this.cache,r=e.length,s=wm(t,r);An(i,s)||(n.uniform1iv(this.addr,s),Dn(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||mP,s[o])}function lZ(n,e,t){const i=this.cache,r=e.length,s=wm(t,r);An(i,s)||(n.uniform1iv(this.addr,s),Dn(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||_P,s[o])}function uZ(n,e,t){const i=this.cache,r=e.length,s=wm(t,r);An(i,s)||(n.uniform1iv(this.addr,s),Dn(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||vP,s[o])}function dZ(n,e,t){const i=this.cache,r=e.length,s=wm(t,r);An(i,s)||(n.uniform1iv(this.addr,s),Dn(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||gP,s[o])}class fZ{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=function $Y(n){switch(n){case 5126:return CY;case 35664:return AY;case 35665:return DY;case 35666:return IY;case 35674:return RY;case 35675:return PY;case 35676:return LY;case 5124:case 35670:return NY;case 35667:case 35671:return OY;case 35668:case 35672:return FY;case 35669:case 35673:return kY;case 5125:return UY;case 36294:return BY;case 36295:return VY;case 36296:return zY;case 35678:case 36198:case 36298:case 36306:case 35682:return HY;case 35679:case 36299:case 36307:return GY;case 35680:case 36300:case 36308:case 36293:return WY;case 36289:case 36303:case 36311:case 36292:return jY}}(t.type)}}class pZ{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function hZ(n){switch(n){case 5126:return qY;case 35664:return XY;case 35665:return YY;case 35666:return ZY;case 35674:return KY;case 35675:return JY;case 35676:return QY;case 5124:case 35670:return eZ;case 35667:case 35671:return tZ;case 35668:case 35672:return nZ;case 35669:case 35673:return iZ;case 5125:return rZ;case 36294:return sZ;case 36295:return oZ;case 36296:return aZ;case 35678:case 36198:case 36298:case 36306:case 35682:return cZ;case 35679:case 36299:case 36307:return lZ;case 35680:case 36300:case 36308:case 36293:return uZ;case 36289:case 36303:case 36311:case 36292:return dZ}}(t.type)}}class mZ{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const Hb=/(\w+)(\])?(\[|\.)?/g;function EP(n,e){n.seq.push(e),n.map[e.id]=e}function gZ(n,e,t){const i=n.name,r=i.length;for(Hb.lastIndex=0;;){const s=Hb.exec(i);let a=s[1];const l=s[3];if("]"===s[2]&&(a|=0),void 0===l||"["===l&&Hb.lastIndex+2===r){EP(t,void 0===l?new fZ(a,n,e):new pZ(a,n,e));break}{let d=t.map[a];void 0===d&&(d=new mZ(a),EP(t,d)),t=d}}}class xm{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r);gZ(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,i,r){const s=this.map[t];void 0!==s&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];void 0!==r&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],c=i[a.id];!1!==c.needsUpdate&&a.setValue(e,c.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function SP(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}let _Z=0;function TP(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function vZ(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join("\n")}(n.getShaderSource(e),o)}return r}function bZ(n,e){const t=function yZ(n){switch(n){case Tr:return["Linear","( value )"];case Bt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),["Linear","( value )"]}}(e);return"vec4 "+n+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function wZ(n,e){let t;switch(e){case q9:t="Linear";break;case X9:t="Reinhard";break;case Y9:t="OptimizedCineon";break;case Z9:t="ACESFilmic";break;case K9:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Sd(n){return""!==n}function CP(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function AP(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const SZ=/^[ \t]*#include +<([\w\d./]+)>/gm;function Gb(n){return n.replace(SZ,CZ)}const TZ=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function CZ(n,e){let t=ct[e];if(void 0===t){const i=TZ.get(e);if(void 0===i)throw new Error("Can not resolve #include <"+e+">");t=ct[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i)}return Gb(t)}const AZ=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function DP(n){return n.replace(AZ,DZ)}function DZ(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function IP(n){let e="precision "+n.precision+" float;\nprecision "+n.precision+" int;";return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function OZ(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const c=function IZ(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===YI?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===S9?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Ds&&(e="SHADOWMAP_TYPE_VSM"),e}(t),l=function RZ(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case vo:case ua:e="ENVMAP_TYPE_CUBE";break;case fd:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),u=function PZ(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&n.envMapMode===ua&&(e="ENVMAP_MODE_REFRACTION"),e}(t),d=function LZ(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case Vp:e="ENVMAP_BLENDING_MULTIPLY";break;case j9:e="ENVMAP_BLENDING_MIX";break;case $9:e="ENVMAP_BLENDING_ADD"}return e}(t),h=function NZ(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),f=t.isWebGL2?"":function xZ(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||"physical"===n.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Sd).join("\n")}(t),p=function MZ(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(s),_=r.createProgram();let g,m,y=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(g=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(Sd).join("\n"),g.length>0&&(g+="\n"),m=[f,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(Sd).join("\n"),m.length>0&&(m+="\n")):(g=[IP(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Sd).join("\n"),m=[f,IP(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+l:"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==_o?"#define TONE_MAPPING":"",t.toneMapping!==_o?ct.tonemapping_pars_fragment:"",t.toneMapping!==_o?wZ("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",ct.colorspace_pars_fragment,bZ("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(Sd).join("\n")),o=Gb(o),o=CP(o,t),o=AP(o,t),a=Gb(a),a=CP(a,t),a=AP(a,t),o=DP(o),a=DP(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(y="#version 300 es\n",g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,m=["#define varying in",t.glslVersion===kR?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===kR?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+m);const b=y+m+a,x=SP(r,r.VERTEX_SHADER,y+g+o),E=SP(r,r.FRAGMENT_SHADER,b);if(r.attachShader(_,x),r.attachShader(_,E),void 0!==t.index0AttributeName?r.bindAttribLocation(_,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(_,0,"position"),r.linkProgram(_),n.debug.checkShaderErrors){const w=r.getProgramInfoLog(_).trim(),S=r.getShaderInfoLog(x).trim(),W=r.getShaderInfoLog(E).trim();let te=!0,U=!0;if(!1===r.getProgramParameter(_,r.LINK_STATUS))if(te=!1,"function"==typeof n.debug.onShaderError)n.debug.onShaderError(r,_,x,E);else{const V=TP(r,x,"vertex"),G=TP(r,E,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(_,r.VALIDATE_STATUS)+"\n\nProgram Info Log: "+w+"\n"+V+"\n"+G)}else""!==w?console.warn("THREE.WebGLProgram: Program Info Log:",w):(""===S||""===W)&&(U=!1);U&&(this.diagnostics={runnable:te,programLog:w,vertexShader:{log:S,prefix:g},fragmentShader:{log:W,prefix:m}})}let T,P;return r.deleteShader(x),r.deleteShader(E),this.getUniforms=function(){return void 0===T&&(T=new xm(r,_)),T},this.getAttributes=function(){return void 0===P&&(P=function EZ(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}(r,_)),P},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(_),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=_Z++,this.cacheKey=e,this.usedTimes=1,this.program=_,this.vertexShader=x,this.fragmentShader=E,this}let FZ=0;class kZ{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new UZ(e),t.set(e,i)),i}}class UZ{constructor(e){this.id=FZ++,this.code=e,this.usedTimes=0}}function BZ(n,e,t,i,r,s,o){const a=new Cb,c=new kZ,l=[],u=r.isWebGL2,d=r.logarithmicDepthBuffer,h=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function _(w){return 0===w?"uv":`uv${w}`}return{getParameters:function g(w,S,W,te,U){const V=te.fog,G=U.geometry,N=(w.isMeshStandardMaterial?t:e).get(w.envMap||(w.isMeshStandardMaterial?te.environment:null)),F=N&&N.mapping===fd?N.image.height:null,$=p[w.type];null!==w.precision&&(f=r.getMaxPrecision(w.precision),f!==w.precision&&console.warn("THREE.WebGLProgram.getParameters:",w.precision,"not supported, using",f,"instead."));const Q=G.morphAttributes.position||G.morphAttributes.normal||G.morphAttributes.color,k=void 0!==Q?Q.length:0;let he,ce,Se,Ue,X=0;if(void 0!==G.morphAttributes.position&&(X=1),void 0!==G.morphAttributes.normal&&(X=2),void 0!==G.morphAttributes.color&&(X=3),$){const zt=ts[$];he=zt.vertexShader,ce=zt.fragmentShader}else he=w.vertexShader,ce=w.fragmentShader,c.update(w),Se=c.getVertexShaderID(w),Ue=c.getFragmentShaderID(w);const Me=n.getRenderTarget(),Re=!0===U.isInstancedMesh,Ze=!!w.map,Be=!!N,R=!!w.aoMap,me=!!w.lightMap,ee=!!w.bumpMap,de=!!w.normalMap,se=!!w.displacementMap,Fe=!!w.emissiveMap,Ce=!!w.metalnessMap,De=!!w.roughnessMap,nt=w.anisotropy>0,yt=w.clearcoat>0,nn=w.iridescence>0,I=w.sheen>0,M=w.transmission>0,H=nt&&!!w.anisotropyMap,le=yt&&!!w.clearcoatMap,ae=yt&&!!w.clearcoatNormalMap,ue=yt&&!!w.clearcoatRoughnessMap,Ne=nn&&!!w.iridescenceMap,fe=nn&&!!w.iridescenceThicknessMap,j=I&&!!w.sheenColorMap,He=I&&!!w.sheenRoughnessMap,ke=!!w.specularMap,Ve=!!w.specularColorMap,Pe=!!w.specularIntensityMap,Le=M&&!!w.transmissionMap,pt=M&&!!w.thicknessMap,L=!!w.alphaMap,ge=!!w.extensions,Ee=!!G.attributes.uv1,xt=!!G.attributes.uv2,Zt=!!G.attributes.uv3;let yn=_o;return w.toneMapped&&(null===Me||!0===Me.isXRRenderTarget)&&(yn=n.toneMapping),{isWebGL2:u,shaderID:$,shaderType:w.type,shaderName:w.name,vertexShader:he,fragmentShader:ce,defines:w.defines,customVertexShaderID:Se,customFragmentShaderID:Ue,isRawShaderMaterial:!0===w.isRawShaderMaterial,glslVersion:w.glslVersion,precision:f,instancing:Re,instancingColor:Re&&null!==U.instanceColor,supportsVertexTextures:h,outputColorSpace:null===Me?n.outputColorSpace:!0===Me.isXRRenderTarget?Me.texture.colorSpace:Tr,map:Ze,matcap:!!w.matcap,envMap:Be,envMapMode:Be&&N.mapping,envMapCubeUVHeight:F,aoMap:R,lightMap:me,bumpMap:ee,normalMap:de,displacementMap:h&&se,emissiveMap:Fe,normalMapObjectSpace:de&&1===w.normalMapType,normalMapTangentSpace:de&&0===w.normalMapType,metalnessMap:Ce,roughnessMap:De,anisotropy:nt,anisotropyMap:H,clearcoat:yt,clearcoatMap:le,clearcoatNormalMap:ae,clearcoatRoughnessMap:ue,iridescence:nn,iridescenceMap:Ne,iridescenceThicknessMap:fe,sheen:I,sheenColorMap:j,sheenRoughnessMap:He,specularMap:ke,specularColorMap:Ve,specularIntensityMap:Pe,transmission:M,transmissionMap:Le,thicknessMap:pt,gradientMap:!!w.gradientMap,opaque:!1===w.transparent&&1===w.blending,alphaMap:L,alphaTest:w.alphaTest>0,alphaHash:!!w.alphaHash,combine:w.combine,mapUv:Ze&&_(w.map.channel),aoMapUv:R&&_(w.aoMap.channel),lightMapUv:me&&_(w.lightMap.channel),bumpMapUv:ee&&_(w.bumpMap.channel),normalMapUv:de&&_(w.normalMap.channel),displacementMapUv:se&&_(w.displacementMap.channel),emissiveMapUv:Fe&&_(w.emissiveMap.channel),metalnessMapUv:Ce&&_(w.metalnessMap.channel),roughnessMapUv:De&&_(w.roughnessMap.channel),anisotropyMapUv:H&&_(w.anisotropyMap.channel),clearcoatMapUv:le&&_(w.clearcoatMap.channel),clearcoatNormalMapUv:ae&&_(w.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ue&&_(w.clearcoatRoughnessMap.channel),iridescenceMapUv:Ne&&_(w.iridescenceMap.channel),iridescenceThicknessMapUv:fe&&_(w.iridescenceThicknessMap.channel),sheenColorMapUv:j&&_(w.sheenColorMap.channel),sheenRoughnessMapUv:He&&_(w.sheenRoughnessMap.channel),specularMapUv:ke&&_(w.specularMap.channel),specularColorMapUv:Ve&&_(w.specularColorMap.channel),specularIntensityMapUv:Pe&&_(w.specularIntensityMap.channel),transmissionMapUv:Le&&_(w.transmissionMap.channel),thicknessMapUv:pt&&_(w.thicknessMap.channel),alphaMapUv:L&&_(w.alphaMap.channel),vertexTangents:!!G.attributes.tangent&&(de||nt),vertexColors:w.vertexColors,vertexAlphas:!0===w.vertexColors&&!!G.attributes.color&&4===G.attributes.color.itemSize,vertexUv1s:Ee,vertexUv2s:xt,vertexUv3s:Zt,pointsUvs:!0===U.isPoints&&!!G.attributes.uv&&(Ze||L),fog:!!V,useFog:!0===w.fog,fogExp2:V&&V.isFogExp2,flatShading:!0===w.flatShading,sizeAttenuation:!0===w.sizeAttenuation,logarithmicDepthBuffer:d,skinning:!0===U.isSkinnedMesh,morphTargets:void 0!==G.morphAttributes.position,morphNormals:void 0!==G.morphAttributes.normal,morphColors:void 0!==G.morphAttributes.color,morphTargetsCount:k,morphTextureStride:X,numDirLights:S.directional.length,numPointLights:S.point.length,numSpotLights:S.spot.length,numSpotLightMaps:S.spotLightMap.length,numRectAreaLights:S.rectArea.length,numHemiLights:S.hemi.length,numDirLightShadows:S.directionalShadowMap.length,numPointLightShadows:S.pointShadowMap.length,numSpotLightShadows:S.spotShadowMap.length,numSpotLightShadowsWithMaps:S.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:w.dithering,shadowMapEnabled:n.shadowMap.enabled&&W.length>0,shadowMapType:n.shadowMap.type,toneMapping:yn,useLegacyLights:n._useLegacyLights,decodeVideoTexture:Ze&&!0===w.map.isVideoTexture&&w.map.colorSpace===Bt,premultipliedAlpha:w.premultipliedAlpha,doubleSided:w.side===Is,flipSided:w.side===Si,useDepthPacking:w.depthPacking>=0,depthPacking:w.depthPacking||0,index0AttributeName:w.index0AttributeName,extensionDerivatives:ge&&!0===w.extensions.derivatives,extensionFragDepth:ge&&!0===w.extensions.fragDepth,extensionDrawBuffers:ge&&!0===w.extensions.drawBuffers,extensionShaderTextureLOD:ge&&!0===w.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:w.customProgramCacheKey()}},getProgramCacheKey:function m(w){const S=[];if(w.shaderID?S.push(w.shaderID):(S.push(w.customVertexShaderID),S.push(w.customFragmentShaderID)),void 0!==w.defines)for(const W in w.defines)S.push(W),S.push(w.defines[W]);return!1===w.isRawShaderMaterial&&(function y(w,S){w.push(S.precision),w.push(S.outputColorSpace),w.push(S.envMapMode),w.push(S.envMapCubeUVHeight),w.push(S.mapUv),w.push(S.alphaMapUv),w.push(S.lightMapUv),w.push(S.aoMapUv),w.push(S.bumpMapUv),w.push(S.normalMapUv),w.push(S.displacementMapUv),w.push(S.emissiveMapUv),w.push(S.metalnessMapUv),w.push(S.roughnessMapUv),w.push(S.anisotropyMapUv),w.push(S.clearcoatMapUv),w.push(S.clearcoatNormalMapUv),w.push(S.clearcoatRoughnessMapUv),w.push(S.iridescenceMapUv),w.push(S.iridescenceThicknessMapUv),w.push(S.sheenColorMapUv),w.push(S.sheenRoughnessMapUv),w.push(S.specularMapUv),w.push(S.specularColorMapUv),w.push(S.specularIntensityMapUv),w.push(S.transmissionMapUv),w.push(S.thicknessMapUv),w.push(S.combine),w.push(S.fogExp2),w.push(S.sizeAttenuation),w.push(S.morphTargetsCount),w.push(S.morphAttributeCount),w.push(S.numDirLights),w.push(S.numPointLights),w.push(S.numSpotLights),w.push(S.numSpotLightMaps),w.push(S.numHemiLights),w.push(S.numRectAreaLights),w.push(S.numDirLightShadows),w.push(S.numPointLightShadows),w.push(S.numSpotLightShadows),w.push(S.numSpotLightShadowsWithMaps),w.push(S.shadowMapType),w.push(S.toneMapping),w.push(S.numClippingPlanes),w.push(S.numClipIntersection),w.push(S.depthPacking)}(S,w),function v(w,S){a.disableAll(),S.isWebGL2&&a.enable(0),S.supportsVertexTextures&&a.enable(1),S.instancing&&a.enable(2),S.instancingColor&&a.enable(3),S.matcap&&a.enable(4),S.envMap&&a.enable(5),S.normalMapObjectSpace&&a.enable(6),S.normalMapTangentSpace&&a.enable(7),S.clearcoat&&a.enable(8),S.iridescence&&a.enable(9),S.alphaTest&&a.enable(10),S.vertexColors&&a.enable(11),S.vertexAlphas&&a.enable(12),S.vertexUv1s&&a.enable(13),S.vertexUv2s&&a.enable(14),S.vertexUv3s&&a.enable(15),S.vertexTangents&&a.enable(16),S.anisotropy&&a.enable(17),w.push(a.mask),a.disableAll(),S.fog&&a.enable(0),S.useFog&&a.enable(1),S.flatShading&&a.enable(2),S.logarithmicDepthBuffer&&a.enable(3),S.skinning&&a.enable(4),S.morphTargets&&a.enable(5),S.morphNormals&&a.enable(6),S.morphColors&&a.enable(7),S.premultipliedAlpha&&a.enable(8),S.shadowMapEnabled&&a.enable(9),S.useLegacyLights&&a.enable(10),S.doubleSided&&a.enable(11),S.flipSided&&a.enable(12),S.useDepthPacking&&a.enable(13),S.dithering&&a.enable(14),S.transmission&&a.enable(15),S.sheen&&a.enable(16),S.opaque&&a.enable(17),S.pointsUvs&&a.enable(18),S.decodeVideoTexture&&a.enable(19),w.push(a.mask)}(S,w),S.push(n.outputColorSpace)),S.push(w.customProgramCacheKey),S.join()},getUniforms:function b(w){const S=p[w.type];let W;return W=S?sq.clone(ts[S].uniforms):w.uniforms,W},acquireProgram:function x(w,S){let W;for(let te=0,U=l.length;te<U;te++){const V=l[te];if(V.cacheKey===S){W=V,++W.usedTimes;break}}return void 0===W&&(W=new OZ(n,S,w,s),l.push(W)),W},releaseProgram:function E(w){if(0==--w.usedTimes){const S=l.indexOf(w);l[S]=l[l.length-1],l.pop(),w.destroy()}},releaseShaderCache:function T(w){c.remove(w)},programs:l,dispose:function P(){c.dispose()}}}function VZ(){let n=new WeakMap;return{get:function e(s){let o=n.get(s);return void 0===o&&(o={},n.set(s,o)),o},remove:function t(s){n.delete(s)},update:function i(s,o,a){n.get(s)[o]=a},dispose:function r(){n=new WeakMap}}}function zZ(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function RP(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function PP(){const n=[];let e=0;const t=[],i=[],r=[];function o(d,h,f,p,_,g){let m=n[e];return void 0===m?(m={id:d.id,object:d,geometry:h,material:f,groupOrder:p,renderOrder:d.renderOrder,z:_,group:g},n[e]=m):(m.id=d.id,m.object=d,m.geometry=h,m.material=f,m.groupOrder=p,m.renderOrder=d.renderOrder,m.z=_,m.group=g),e++,m}return{opaque:t,transmissive:i,transparent:r,init:function s(){e=0,t.length=0,i.length=0,r.length=0},push:function a(d,h,f,p,_,g){const m=o(d,h,f,p,_,g);f.transmission>0?i.push(m):!0===f.transparent?r.push(m):t.push(m)},unshift:function c(d,h,f,p,_,g){const m=o(d,h,f,p,_,g);f.transmission>0?i.unshift(m):!0===f.transparent?r.unshift(m):t.unshift(m)},finish:function u(){for(let d=e,h=n.length;d<h;d++){const f=n[d];if(null===f.id)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}},sort:function l(d,h){t.length>1&&t.sort(d||zZ),i.length>1&&i.sort(h||RP),r.length>1&&r.sort(h||RP)}}}function HZ(){let n=new WeakMap;return{get:function e(i,r){const s=n.get(i);let o;return void 0===s?(o=new PP,n.set(i,[o])):r>=s.length?(o=new PP,s.push(o)):o=s[r],o},dispose:function t(){n=new WeakMap}}}function GZ(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new C,color:new Te};break;case"SpotLight":t={position:new C,direction:new C,color:new Te,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new C,color:new Te,distance:0,decay:0};break;case"HemisphereLight":t={direction:new C,skyColor:new Te,groundColor:new Te};break;case"RectAreaLight":t={color:new Te,position:new C,halfWidth:new C,halfHeight:new C}}return n[e.id]=t,t}}}let jZ=0;function $Z(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function qZ(n,e){const t=new GZ,i=function WZ(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ie};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ie,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let u=0;u<9;u++)r.probe.push(new C);const s=new C,o=new rt,a=new rt;return{setup:function c(u,d){let h=0,f=0,p=0;for(let W=0;W<9;W++)r.probe[W].set(0,0,0);let _=0,g=0,m=0,y=0,v=0,b=0,x=0,E=0,T=0,P=0;u.sort($Z);const w=!0===d?Math.PI:1;for(let W=0,te=u.length;W<te;W++){const U=u[W],V=U.color,G=U.intensity,O=U.distance,N=U.shadow&&U.shadow.map?U.shadow.map.texture:null;if(U.isAmbientLight)h+=V.r*G*w,f+=V.g*G*w,p+=V.b*G*w;else if(U.isLightProbe)for(let F=0;F<9;F++)r.probe[F].addScaledVector(U.sh.coefficients[F],G);else if(U.isDirectionalLight){const F=t.get(U);if(F.color.copy(U.color).multiplyScalar(U.intensity*w),U.castShadow){const $=U.shadow,Q=i.get(U);Q.shadowBias=$.bias,Q.shadowNormalBias=$.normalBias,Q.shadowRadius=$.radius,Q.shadowMapSize=$.mapSize,r.directionalShadow[_]=Q,r.directionalShadowMap[_]=N,r.directionalShadowMatrix[_]=U.shadow.matrix,b++}r.directional[_]=F,_++}else if(U.isSpotLight){const F=t.get(U);F.position.setFromMatrixPosition(U.matrixWorld),F.color.copy(V).multiplyScalar(G*w),F.distance=O,F.coneCos=Math.cos(U.angle),F.penumbraCos=Math.cos(U.angle*(1-U.penumbra)),F.decay=U.decay,r.spot[m]=F;const $=U.shadow;if(U.map&&(r.spotLightMap[T]=U.map,T++,$.updateMatrices(U),U.castShadow&&P++),r.spotLightMatrix[m]=$.matrix,U.castShadow){const Q=i.get(U);Q.shadowBias=$.bias,Q.shadowNormalBias=$.normalBias,Q.shadowRadius=$.radius,Q.shadowMapSize=$.mapSize,r.spotShadow[m]=Q,r.spotShadowMap[m]=N,E++}m++}else if(U.isRectAreaLight){const F=t.get(U);F.color.copy(V).multiplyScalar(G),F.halfWidth.set(.5*U.width,0,0),F.halfHeight.set(0,.5*U.height,0),r.rectArea[y]=F,y++}else if(U.isPointLight){const F=t.get(U);if(F.color.copy(U.color).multiplyScalar(U.intensity*w),F.distance=U.distance,F.decay=U.decay,U.castShadow){const $=U.shadow,Q=i.get(U);Q.shadowBias=$.bias,Q.shadowNormalBias=$.normalBias,Q.shadowRadius=$.radius,Q.shadowMapSize=$.mapSize,Q.shadowCameraNear=$.camera.near,Q.shadowCameraFar=$.camera.far,r.pointShadow[g]=Q,r.pointShadowMap[g]=N,r.pointShadowMatrix[g]=U.shadow.matrix,x++}r.point[g]=F,g++}else if(U.isHemisphereLight){const F=t.get(U);F.skyColor.copy(U.color).multiplyScalar(G*w),F.groundColor.copy(U.groundColor).multiplyScalar(G*w),r.hemi[v]=F,v++}}y>0&&(e.isWebGL2||!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=ve.LTC_FLOAT_1,r.rectAreaLTC2=ve.LTC_FLOAT_2):!0===n.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=ve.LTC_HALF_1,r.rectAreaLTC2=ve.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=h,r.ambient[1]=f,r.ambient[2]=p;const S=r.hash;(S.directionalLength!==_||S.pointLength!==g||S.spotLength!==m||S.rectAreaLength!==y||S.hemiLength!==v||S.numDirectionalShadows!==b||S.numPointShadows!==x||S.numSpotShadows!==E||S.numSpotMaps!==T)&&(r.directional.length=_,r.spot.length=m,r.rectArea.length=y,r.point.length=g,r.hemi.length=v,r.directionalShadow.length=b,r.directionalShadowMap.length=b,r.pointShadow.length=x,r.pointShadowMap.length=x,r.spotShadow.length=E,r.spotShadowMap.length=E,r.directionalShadowMatrix.length=b,r.pointShadowMatrix.length=x,r.spotLightMatrix.length=E+T-P,r.spotLightMap.length=T,r.numSpotLightShadowsWithMaps=P,S.directionalLength=_,S.pointLength=g,S.spotLength=m,S.rectAreaLength=y,S.hemiLength=v,S.numDirectionalShadows=b,S.numPointShadows=x,S.numSpotShadows=E,S.numSpotMaps=T,r.version=jZ++)},setupView:function l(u,d){let h=0,f=0,p=0,_=0,g=0;const m=d.matrixWorldInverse;for(let y=0,v=u.length;y<v;y++){const b=u[y];if(b.isDirectionalLight){const x=r.directional[h];x.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),x.direction.sub(s),x.direction.transformDirection(m),h++}else if(b.isSpotLight){const x=r.spot[p];x.position.setFromMatrixPosition(b.matrixWorld),x.position.applyMatrix4(m),x.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),x.direction.sub(s),x.direction.transformDirection(m),p++}else if(b.isRectAreaLight){const x=r.rectArea[_];x.position.setFromMatrixPosition(b.matrixWorld),x.position.applyMatrix4(m),a.identity(),o.copy(b.matrixWorld),o.premultiply(m),a.extractRotation(o),x.halfWidth.set(.5*b.width,0,0),x.halfHeight.set(0,.5*b.height,0),x.halfWidth.applyMatrix4(a),x.halfHeight.applyMatrix4(a),_++}else if(b.isPointLight){const x=r.point[f];x.position.setFromMatrixPosition(b.matrixWorld),x.position.applyMatrix4(m),f++}else if(b.isHemisphereLight){const x=r.hemi[g];x.direction.setFromMatrixPosition(b.matrixWorld),x.direction.transformDirection(m),g++}}},state:r}}function LP(n,e){const t=new qZ(n,e),i=[],r=[];return{init:function s(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:function c(d){t.setup(i,d)},setupLightsView:function l(d){t.setupView(i,d)},pushLight:function o(d){i.push(d)},pushShadow:function a(d){r.push(d)}}}function XZ(n,e){let t=new WeakMap;return{get:function i(s,o=0){const a=t.get(s);let c;return void 0===a?(c=new LP(n,e),t.set(s,[c])):o>=a.length?(c=new LP(n,e),a.push(c)):c=a[o],c},dispose:function r(){t=new WeakMap}}}class NP extends xd{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class OP extends xd{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function KZ(n,e,t){let i=new kb;const r=new ie,s=new ie,o=new Rt,a=new NP({depthPacking:3201}),c=new OP,l={},u=t.maxTextureSize,d={[mo]:Si,[Si]:mo,[Is]:Is},h=new Hs({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ie},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=h.clone();f.defines.HORIZONTAL_PASS=1;const p=new ft;p.setAttribute("position",new Un(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const _=new Ai(p,h),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=YI;let m=this.type;function y(x,E){const T=e.update(_);h.defines.VSM_SAMPLES!==x.blurSamples&&(h.defines.VSM_SAMPLES=x.blurSamples,f.defines.VSM_SAMPLES=x.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),null===x.mapPass&&(x.mapPass=new xo(r.x,r.y)),h.uniforms.shadow_pass.value=x.map.texture,h.uniforms.resolution.value=x.mapSize,h.uniforms.radius.value=x.radius,n.setRenderTarget(x.mapPass),n.clear(),n.renderBufferDirect(E,null,T,h,_,null),f.uniforms.shadow_pass.value=x.mapPass.texture,f.uniforms.resolution.value=x.mapSize,f.uniforms.radius.value=x.radius,n.setRenderTarget(x.map),n.clear(),n.renderBufferDirect(E,null,T,f,_,null)}function v(x,E,T,P){let w=null;const S=!0===T.isPointLight?x.customDistanceMaterial:x.customDepthMaterial;if(void 0!==S)w=S;else if(w=!0===T.isPointLight?c:a,n.localClippingEnabled&&!0===E.clipShadows&&Array.isArray(E.clippingPlanes)&&0!==E.clippingPlanes.length||E.displacementMap&&0!==E.displacementScale||E.alphaMap&&E.alphaTest>0||E.map&&E.alphaTest>0){const W=w.uuid,te=E.uuid;let U=l[W];void 0===U&&(U={},l[W]=U);let V=U[te];void 0===V&&(V=w.clone(),U[te]=V),w=V}return w.visible=E.visible,w.wireframe=E.wireframe,w.side=P===Ds?null!==E.shadowSide?E.shadowSide:E.side:null!==E.shadowSide?E.shadowSide:d[E.side],w.alphaMap=E.alphaMap,w.alphaTest=E.alphaTest,w.map=E.map,w.clipShadows=E.clipShadows,w.clippingPlanes=E.clippingPlanes,w.clipIntersection=E.clipIntersection,w.displacementMap=E.displacementMap,w.displacementScale=E.displacementScale,w.displacementBias=E.displacementBias,w.wireframeLinewidth=E.wireframeLinewidth,w.linewidth=E.linewidth,!0===T.isPointLight&&!0===w.isMeshDistanceMaterial&&(n.properties.get(w).light=T),w}function b(x,E,T,P,w){if(!1===x.visible)return;if(x.layers.test(E.layers)&&(x.isMesh||x.isLine||x.isPoints)&&(x.castShadow||x.receiveShadow&&w===Ds)&&(!x.frustumCulled||i.intersectsObject(x))){x.modelViewMatrix.multiplyMatrices(T.matrixWorldInverse,x.matrixWorld);const te=e.update(x),U=x.material;if(Array.isArray(U)){const V=te.groups;for(let G=0,O=V.length;G<O;G++){const N=V[G],F=U[N.materialIndex];if(F&&F.visible){const $=v(x,F,P,w);n.renderBufferDirect(T,null,te,$,x,N)}}}else if(U.visible){const V=v(x,U,P,w);n.renderBufferDirect(T,null,te,V,x,null)}}const W=x.children;for(let te=0,U=W.length;te<U;te++)b(W[te],E,T,P,w)}this.render=function(x,E,T){if(!1===g.enabled||!1===g.autoUpdate&&!1===g.needsUpdate||0===x.length)return;const P=n.getRenderTarget(),w=n.getActiveCubeFace(),S=n.getActiveMipmapLevel(),W=n.state;W.setBlending(go),W.buffers.color.setClear(1,1,1,1),W.buffers.depth.setTest(!0),W.setScissorTest(!1);const te=m!==Ds&&this.type===Ds,U=m===Ds&&this.type!==Ds;for(let V=0,G=x.length;V<G;V++){const O=x[V],N=O.shadow;if(void 0===N){console.warn("THREE.WebGLShadowMap:",O,"has no shadow.");continue}if(!1===N.autoUpdate&&!1===N.needsUpdate)continue;r.copy(N.mapSize);const F=N.getFrameExtents();if(r.multiply(F),s.copy(N.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/F.x),r.x=s.x*F.x,N.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/F.y),r.y=s.y*F.y,N.mapSize.y=s.y)),null===N.map||!0===te||!0===U){const Q=this.type!==Ds?{minFilter:gn,magFilter:gn}:{};null!==N.map&&N.map.dispose(),N.map=new xo(r.x,r.y,Q),N.map.texture.name=O.name+".shadowMap",N.camera.updateProjectionMatrix()}n.setRenderTarget(N.map),n.clear();const $=N.getViewportCount();for(let Q=0;Q<$;Q++){const k=N.getViewport(Q);o.set(s.x*k.x,s.y*k.y,s.x*k.z,s.y*k.w),W.viewport(o),N.updateMatrices(O,Q),i=N.getFrustum(),b(E,T,N.camera,O,this.type)}!0!==N.isPointLightShadow&&this.type===Ds&&y(N,T),N.needsUpdate=!1}m=this.type,g.needsUpdate=!1,n.setRenderTarget(P,w,S)}}function JZ(n,e,t){const i=t.isWebGL2,a=new function r(){let L=!1;const ye=new Rt;let q=null;const ge=new Rt(0,0,0,0);return{setMask:function(Ee){q!==Ee&&!L&&(n.colorMask(Ee,Ee,Ee,Ee),q=Ee)},setLocked:function(Ee){L=Ee},setClear:function(Ee,xt,Zt,yn,Bo){!0===Bo&&(Ee*=yn,xt*=yn,Zt*=yn),ye.set(Ee,xt,Zt,yn),!1===ge.equals(ye)&&(n.clearColor(Ee,xt,Zt,yn),ge.copy(ye))},reset:function(){L=!1,q=null,ge.set(-1,0,0,0)}}},c=new function s(){let L=!1,ye=null,q=null,ge=null;return{setTest:function(Ee){Ee?Me(n.DEPTH_TEST):Re(n.DEPTH_TEST)},setMask:function(Ee){ye!==Ee&&!L&&(n.depthMask(Ee),ye=Ee)},setFunc:function(Ee){if(q!==Ee){switch(Ee){case 0:n.depthFunc(n.NEVER);break;case 1:n.depthFunc(n.ALWAYS);break;case 2:n.depthFunc(n.LESS);break;case 3:default:n.depthFunc(n.LEQUAL);break;case 4:n.depthFunc(n.EQUAL);break;case 5:n.depthFunc(n.GEQUAL);break;case 6:n.depthFunc(n.GREATER);break;case 7:n.depthFunc(n.NOTEQUAL)}q=Ee}},setLocked:function(Ee){L=Ee},setClear:function(Ee){ge!==Ee&&(n.clearDepth(Ee),ge=Ee)},reset:function(){L=!1,ye=null,q=null,ge=null}}},l=new function o(){let L=!1,ye=null,q=null,ge=null,Ee=null,xt=null,Zt=null,yn=null,Bo=null;return{setTest:function(zt){L||(zt?Me(n.STENCIL_TEST):Re(n.STENCIL_TEST))},setMask:function(zt){ye!==zt&&!L&&(n.stencilMask(zt),ye=zt)},setFunc:function(zt,ls,hi){(q!==zt||ge!==ls||Ee!==hi)&&(n.stencilFunc(zt,ls,hi),q=zt,ge=ls,Ee=hi)},setOp:function(zt,ls,hi){(xt!==zt||Zt!==ls||yn!==hi)&&(n.stencilOp(zt,ls,hi),xt=zt,Zt=ls,yn=hi)},setLocked:function(zt){L=zt},setClear:function(zt){Bo!==zt&&(n.clearStencil(zt),Bo=zt)},reset:function(){L=!1,ye=null,q=null,ge=null,Ee=null,xt=null,Zt=null,yn=null,Bo=null}}},u=new WeakMap,d=new WeakMap;let h={},f={},p=new WeakMap,_=[],g=null,m=!1,y=null,v=null,b=null,x=null,E=null,T=null,P=null,w=!1,S=null,W=null,te=null,U=null,V=null;const G=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let O=!1,N=0;const F=n.getParameter(n.VERSION);-1!==F.indexOf("WebGL")?(N=parseFloat(/^WebGL (\d)/.exec(F)[1]),O=N>=1):-1!==F.indexOf("OpenGL ES")&&(N=parseFloat(/^OpenGL ES (\d)/.exec(F)[1]),O=N>=2);let $=null,Q={};const k=n.getParameter(n.SCISSOR_BOX),X=n.getParameter(n.VIEWPORT),he=(new Rt).fromArray(k),ce=(new Rt).fromArray(X);function Se(L,ye,q,ge){const Ee=new Uint8Array(4),xt=n.createTexture();n.bindTexture(L,xt),n.texParameteri(L,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(L,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Zt=0;Zt<q;Zt++)!i||L!==n.TEXTURE_3D&&L!==n.TEXTURE_2D_ARRAY?n.texImage2D(ye+Zt,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Ee):n.texImage3D(ye,0,n.RGBA,1,1,ge,0,n.RGBA,n.UNSIGNED_BYTE,Ee);return xt}const Ue={};function Me(L){!0!==h[L]&&(n.enable(L),h[L]=!0)}function Re(L){!1!==h[L]&&(n.disable(L),h[L]=!1)}Ue[n.TEXTURE_2D]=Se(n.TEXTURE_2D,n.TEXTURE_2D,1),Ue[n.TEXTURE_CUBE_MAP]=Se(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(Ue[n.TEXTURE_2D_ARRAY]=Se(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Ue[n.TEXTURE_3D]=Se(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),c.setClear(1),l.setClear(0),Me(n.DEPTH_TEST),c.setFunc(3),se(!1),Fe(1),Me(n.CULL_FACE),ee(go);const R={100:n.FUNC_ADD,101:n.FUNC_SUBTRACT,102:n.FUNC_REVERSE_SUBTRACT};if(i)R[103]=n.MIN,R[104]=n.MAX;else{const L=e.get("EXT_blend_minmax");null!==L&&(R[103]=L.MIN_EXT,R[104]=L.MAX_EXT)}const me={200:n.ZERO,201:n.ONE,202:n.SRC_COLOR,204:n.SRC_ALPHA,210:n.SRC_ALPHA_SATURATE,208:n.DST_COLOR,206:n.DST_ALPHA,203:n.ONE_MINUS_SRC_COLOR,205:n.ONE_MINUS_SRC_ALPHA,209:n.ONE_MINUS_DST_COLOR,207:n.ONE_MINUS_DST_ALPHA};function ee(L,ye,q,ge,Ee,xt,Zt,yn){if(L!==go){if(!1===m&&(Me(n.BLEND),m=!0),5===L)Ee=Ee||ye,xt=xt||q,Zt=Zt||ge,(ye!==v||Ee!==E)&&(n.blendEquationSeparate(R[ye],R[Ee]),v=ye,E=Ee),(q!==b||ge!==x||xt!==T||Zt!==P)&&(n.blendFuncSeparate(me[q],me[ge],me[xt],me[Zt]),b=q,x=ge,T=xt,P=Zt),y=L,w=!1;else if(L!==y||yn!==w){if((100!==v||100!==E)&&(n.blendEquation(n.FUNC_ADD),v=100,E=100),yn)switch(L){case 1:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.ONE,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",L)}else switch(L){case 1:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",L)}b=null,x=null,T=null,P=null,y=L,w=yn}}else!0===m&&(Re(n.BLEND),m=!1)}function se(L){S!==L&&(n.frontFace(L?n.CW:n.CCW),S=L)}function Fe(L){0!==L?(Me(n.CULL_FACE),L!==W&&n.cullFace(1===L?n.BACK:2===L?n.FRONT:n.FRONT_AND_BACK)):Re(n.CULL_FACE),W=L}function De(L,ye,q){L?(Me(n.POLYGON_OFFSET_FILL),(U!==ye||V!==q)&&(n.polygonOffset(ye,q),U=ye,V=q)):Re(n.POLYGON_OFFSET_FILL)}return{buffers:{color:a,depth:c,stencil:l},enable:Me,disable:Re,bindFramebuffer:function Ze(L,ye){return f[L]!==ye&&(n.bindFramebuffer(L,ye),f[L]=ye,i&&(L===n.DRAW_FRAMEBUFFER&&(f[n.FRAMEBUFFER]=ye),L===n.FRAMEBUFFER&&(f[n.DRAW_FRAMEBUFFER]=ye)),!0)},drawBuffers:function It(L,ye){let q=_,ge=!1;if(L)if(q=p.get(ye),void 0===q&&(q=[],p.set(ye,q)),L.isWebGLMultipleRenderTargets){const Ee=L.texture;if(q.length!==Ee.length||q[0]!==n.COLOR_ATTACHMENT0){for(let xt=0,Zt=Ee.length;xt<Zt;xt++)q[xt]=n.COLOR_ATTACHMENT0+xt;q.length=Ee.length,ge=!0}}else q[0]!==n.COLOR_ATTACHMENT0&&(q[0]=n.COLOR_ATTACHMENT0,ge=!0);else q[0]!==n.BACK&&(q[0]=n.BACK,ge=!0);ge&&(t.isWebGL2?n.drawBuffers(q):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(q))},useProgram:function Be(L){return g!==L&&(n.useProgram(L),g=L,!0)},setBlending:ee,setMaterial:function de(L,ye){L.side===Is?Re(n.CULL_FACE):Me(n.CULL_FACE);let q=L.side===Si;ye&&(q=!q),se(q),1===L.blending&&!1===L.transparent?ee(go):ee(L.blending,L.blendEquation,L.blendSrc,L.blendDst,L.blendEquationAlpha,L.blendSrcAlpha,L.blendDstAlpha,L.premultipliedAlpha),c.setFunc(L.depthFunc),c.setTest(L.depthTest),c.setMask(L.depthWrite),a.setMask(L.colorWrite);const ge=L.stencilWrite;l.setTest(ge),ge&&(l.setMask(L.stencilWriteMask),l.setFunc(L.stencilFunc,L.stencilRef,L.stencilFuncMask),l.setOp(L.stencilFail,L.stencilZFail,L.stencilZPass)),De(L.polygonOffset,L.polygonOffsetFactor,L.polygonOffsetUnits),!0===L.alphaToCoverage?Me(n.SAMPLE_ALPHA_TO_COVERAGE):Re(n.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:se,setCullFace:Fe,setLineWidth:function Ce(L){L!==te&&(O&&n.lineWidth(L),te=L)},setPolygonOffset:De,setScissorTest:function nt(L){L?Me(n.SCISSOR_TEST):Re(n.SCISSOR_TEST)},activeTexture:function yt(L){void 0===L&&(L=n.TEXTURE0+G-1),$!==L&&(n.activeTexture(L),$=L)},bindTexture:function nn(L,ye,q){void 0===q&&(q=null===$?n.TEXTURE0+G-1:$);let ge=Q[q];void 0===ge&&(ge={type:void 0,texture:void 0},Q[q]=ge),(ge.type!==L||ge.texture!==ye)&&($!==q&&(n.activeTexture(q),$=q),n.bindTexture(L,ye||Ue[L]),ge.type=L,ge.texture=ye)},unbindTexture:function I(){const L=Q[$];void 0!==L&&void 0!==L.type&&(n.bindTexture(L.type,null),L.type=void 0,L.texture=void 0)},compressedTexImage2D:function M(){try{n.compressedTexImage2D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},compressedTexImage3D:function H(){try{n.compressedTexImage3D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},texImage2D:function He(){try{n.texImage2D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},texImage3D:function ke(){try{n.texImage3D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},updateUBOMapping:function Le(L,ye){let q=d.get(ye);void 0===q&&(q=new WeakMap,d.set(ye,q));let ge=q.get(L);void 0===ge&&(ge=n.getUniformBlockIndex(ye,L.name),q.set(L,ge))},uniformBlockBinding:function pt(L,ye){const ge=d.get(ye).get(L);u.get(ye)!==ge&&(n.uniformBlockBinding(ye,ge,L.__bindingPointIndex),u.set(ye,ge))},texStorage2D:function fe(){try{n.texStorage2D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},texStorage3D:function j(){try{n.texStorage3D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},texSubImage2D:function le(){try{n.texSubImage2D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},texSubImage3D:function ae(){try{n.texSubImage3D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},compressedTexSubImage2D:function ue(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},compressedTexSubImage3D:function Ne(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},scissor:function Ve(L){!1===he.equals(L)&&(n.scissor(L.x,L.y,L.z,L.w),he.copy(L))},viewport:function Pe(L){!1===ce.equals(L)&&(n.viewport(L.x,L.y,L.z,L.w),ce.copy(L))},reset:function kt(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),!0===i&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),h={},$=null,Q={},f={},p=new WeakMap,_=[],g=null,m=!1,y=null,v=null,b=null,x=null,E=null,T=null,P=null,w=!1,S=null,W=null,te=null,U=null,V=null,he.set(0,0,n.canvas.width,n.canvas.height),ce.set(0,0,n.canvas.width,n.canvas.height),a.reset(),c.reset(),l.reset()}}}function QZ(n,e,t,i,r,s,o){const a=r.isWebGL2,c=r.maxTextures,l=r.maxCubemapSize,u=r.maxTextureSize,d=r.maxSamples,h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let _;const g=new WeakMap;let m=!1;try{m=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function y(I,M){return m?new OffscreenCanvas(I,M):gd("canvas")}function v(I,M,H,le){let ae=1;if((I.width>le||I.height>le)&&(ae=le/Math.max(I.width,I.height)),ae<1||!0===M){if(typeof HTMLImageElement<"u"&&I instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&I instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&I instanceof ImageBitmap){const ue=M?Jp:Math.floor,Ne=ue(ae*I.width),fe=ue(ae*I.height);void 0===_&&(_=y(Ne,fe));const j=H?y(Ne,fe):_;return j.width=Ne,j.height=fe,j.getContext("2d").drawImage(I,0,0,Ne,fe),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+I.width+"x"+I.height+") to ("+Ne+"x"+fe+")."),j}return"data"in I&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+I.width+"x"+I.height+")."),I}return I}function b(I){return mb(I.width)&&mb(I.height)}function E(I,M){return I.generateMipmaps&&M&&I.minFilter!==gn&&I.minFilter!==cn}function T(I){n.generateMipmap(I)}function P(I,M,H,le,ae=!1){if(!1===a)return M;if(null!==I){if(void 0!==n[I])return n[I];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+I+"'")}let ue=M;return M===n.RED&&(H===n.FLOAT&&(ue=n.R32F),H===n.HALF_FLOAT&&(ue=n.R16F),H===n.UNSIGNED_BYTE&&(ue=n.R8)),M===n.RED_INTEGER&&(H===n.UNSIGNED_BYTE&&(ue=n.R8UI),H===n.UNSIGNED_SHORT&&(ue=n.R16UI),H===n.UNSIGNED_INT&&(ue=n.R32UI),H===n.BYTE&&(ue=n.R8I),H===n.SHORT&&(ue=n.R16I),H===n.INT&&(ue=n.R32I)),M===n.RG&&(H===n.FLOAT&&(ue=n.RG32F),H===n.HALF_FLOAT&&(ue=n.RG16F),H===n.UNSIGNED_BYTE&&(ue=n.RG8)),M===n.RGBA&&(H===n.FLOAT&&(ue=n.RGBA32F),H===n.HALF_FLOAT&&(ue=n.RGBA16F),H===n.UNSIGNED_BYTE&&(ue=le===Bt&&!1===ae?n.SRGB8_ALPHA8:n.RGBA8),H===n.UNSIGNED_SHORT_4_4_4_4&&(ue=n.RGBA4),H===n.UNSIGNED_SHORT_5_5_5_1&&(ue=n.RGB5_A1)),(ue===n.R16F||ue===n.R32F||ue===n.RG16F||ue===n.RG32F||ue===n.RGBA16F||ue===n.RGBA32F)&&e.get("EXT_color_buffer_float"),ue}function w(I,M,H){return!0===E(I,H)||I.isFramebufferTexture&&I.minFilter!==gn&&I.minFilter!==cn?Math.log2(Math.max(M.width,M.height))+1:void 0!==I.mipmaps&&I.mipmaps.length>0?I.mipmaps.length:I.isCompressedTexture&&Array.isArray(I.image)?M.mipmaps.length:1}function S(I){return I===gn||1004===I||1005===I?n.NEAREST:n.LINEAR}function W(I){const M=I.target;M.removeEventListener("dispose",W),function U(I){const M=i.get(I);if(void 0===M.__webglInit)return;const H=I.source,le=g.get(H);if(le){const ae=le[M.__cacheKey];ae.usedTimes--,0===ae.usedTimes&&V(I),0===Object.keys(le).length&&g.delete(H)}i.remove(I)}(M),M.isVideoTexture&&p.delete(M)}function te(I){const M=I.target;M.removeEventListener("dispose",te),function G(I){const M=I.texture,H=i.get(I),le=i.get(M);if(void 0!==le.__webglTexture&&(n.deleteTexture(le.__webglTexture),o.memory.textures--),I.depthTexture&&I.depthTexture.dispose(),I.isWebGLCubeRenderTarget)for(let ae=0;ae<6;ae++){if(Array.isArray(H.__webglFramebuffer[ae]))for(let ue=0;ue<H.__webglFramebuffer[ae].length;ue++)n.deleteFramebuffer(H.__webglFramebuffer[ae][ue]);else n.deleteFramebuffer(H.__webglFramebuffer[ae]);H.__webglDepthbuffer&&n.deleteRenderbuffer(H.__webglDepthbuffer[ae])}else{if(Array.isArray(H.__webglFramebuffer))for(let ae=0;ae<H.__webglFramebuffer.length;ae++)n.deleteFramebuffer(H.__webglFramebuffer[ae]);else n.deleteFramebuffer(H.__webglFramebuffer);if(H.__webglDepthbuffer&&n.deleteRenderbuffer(H.__webglDepthbuffer),H.__webglMultisampledFramebuffer&&n.deleteFramebuffer(H.__webglMultisampledFramebuffer),H.__webglColorRenderbuffer)for(let ae=0;ae<H.__webglColorRenderbuffer.length;ae++)H.__webglColorRenderbuffer[ae]&&n.deleteRenderbuffer(H.__webglColorRenderbuffer[ae]);H.__webglDepthRenderbuffer&&n.deleteRenderbuffer(H.__webglDepthRenderbuffer)}if(I.isWebGLMultipleRenderTargets)for(let ae=0,ue=M.length;ae<ue;ae++){const Ne=i.get(M[ae]);Ne.__webglTexture&&(n.deleteTexture(Ne.__webglTexture),o.memory.textures--),i.remove(M[ae])}i.remove(M),i.remove(I)}(M)}function V(I){const M=i.get(I);n.deleteTexture(M.__webglTexture),delete g.get(I.source)[M.__cacheKey],o.memory.textures--}let O=0;function Q(I,M){const H=i.get(I);if(I.isVideoTexture&&function yt(I){const M=o.render.frame;p.get(I)!==M&&(p.set(I,M),I.update())}(I),!1===I.isRenderTargetTexture&&I.version>0&&H.__version!==I.version){const le=I.image;if(null===le)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==le.complete)return void Ze(H,I,M);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(n.TEXTURE_2D,H.__webglTexture,n.TEXTURE0+M)}const ce={1e3:n.REPEAT,[li]:n.CLAMP_TO_EDGE,1002:n.MIRRORED_REPEAT},Se={[gn]:n.NEAREST,1004:n.NEAREST_MIPMAP_NEAREST,1005:n.NEAREST_MIPMAP_LINEAR,[cn]:n.LINEAR,1007:n.LINEAR_MIPMAP_NEAREST,[yo]:n.LINEAR_MIPMAP_LINEAR},Ue={512:n.NEVER,519:n.ALWAYS,513:n.LESS,515:n.LEQUAL,514:n.EQUAL,518:n.GEQUAL,516:n.GREATER,517:n.NOTEQUAL};function Me(I,M,H){if(H?(n.texParameteri(I,n.TEXTURE_WRAP_S,ce[M.wrapS]),n.texParameteri(I,n.TEXTURE_WRAP_T,ce[M.wrapT]),(I===n.TEXTURE_3D||I===n.TEXTURE_2D_ARRAY)&&n.texParameteri(I,n.TEXTURE_WRAP_R,ce[M.wrapR]),n.texParameteri(I,n.TEXTURE_MAG_FILTER,Se[M.magFilter]),n.texParameteri(I,n.TEXTURE_MIN_FILTER,Se[M.minFilter])):(n.texParameteri(I,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(I,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(I===n.TEXTURE_3D||I===n.TEXTURE_2D_ARRAY)&&n.texParameteri(I,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(M.wrapS!==li||M.wrapT!==li)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(I,n.TEXTURE_MAG_FILTER,S(M.magFilter)),n.texParameteri(I,n.TEXTURE_MIN_FILTER,S(M.minFilter)),M.minFilter!==gn&&M.minFilter!==cn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),M.compareFunction&&(n.texParameteri(I,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(I,n.TEXTURE_COMPARE_FUNC,Ue[M.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){const le=e.get("EXT_texture_filter_anisotropic");if(M.magFilter===gn||1005!==M.minFilter&&M.minFilter!==yo||M.type===Rs&&!1===e.has("OES_texture_float_linear")||!1===a&&M.type===pd&&!1===e.has("OES_texture_half_float_linear"))return;(M.anisotropy>1||i.get(M).__currentAnisotropy)&&(n.texParameterf(I,le.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(M.anisotropy,r.getMaxAnisotropy())),i.get(M).__currentAnisotropy=M.anisotropy)}}function Re(I,M){let H=!1;void 0===I.__webglInit&&(I.__webglInit=!0,M.addEventListener("dispose",W));const le=M.source;let ae=g.get(le);void 0===ae&&(ae={},g.set(le,ae));const ue=function $(I){const M=[];return M.push(I.wrapS),M.push(I.wrapT),M.push(I.wrapR||0),M.push(I.magFilter),M.push(I.minFilter),M.push(I.anisotropy),M.push(I.internalFormat),M.push(I.format),M.push(I.type),M.push(I.generateMipmaps),M.push(I.premultiplyAlpha),M.push(I.flipY),M.push(I.unpackAlignment),M.push(I.colorSpace),M.join()}(M);if(ue!==I.__cacheKey){void 0===ae[ue]&&(ae[ue]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,H=!0),ae[ue].usedTimes++;const Ne=ae[I.__cacheKey];void 0!==Ne&&(ae[I.__cacheKey].usedTimes--,0===Ne.usedTimes&&V(M)),I.__cacheKey=ue,I.__webglTexture=ae[ue].texture}return H}function Ze(I,M,H){let le=n.TEXTURE_2D;(M.isDataArrayTexture||M.isCompressedArrayTexture)&&(le=n.TEXTURE_2D_ARRAY),M.isData3DTexture&&(le=n.TEXTURE_3D);const ae=Re(I,M),ue=M.source;t.bindTexture(le,I.__webglTexture,n.TEXTURE0+H);const Ne=i.get(ue);if(ue.version!==Ne.__version||!0===ae){t.activeTexture(n.TEXTURE0+H),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,M.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,M.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,M.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,n.NONE);const fe=function x(I){return!a&&(I.wrapS!==li||I.wrapT!==li||I.minFilter!==gn&&I.minFilter!==cn)}(M)&&!1===b(M.image);let j=v(M.image,fe,!1,u);j=nn(M,j);const He=b(j)||a,ke=s.convert(M.format,M.colorSpace);let Le,Ve=s.convert(M.type),Pe=P(M.internalFormat,ke,Ve,M.colorSpace,M.isVideoTexture);Me(le,M,He);const pt=M.mipmaps,kt=a&&!0!==M.isVideoTexture,L=void 0===Ne.__version||!0===ae,ye=w(M,j,He);if(M.isDepthTexture)Pe=n.DEPTH_COMPONENT,a?Pe=M.type===Rs?n.DEPTH_COMPONENT32F:M.type===wo?n.DEPTH_COMPONENT24:M.type===da?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT16:M.type===Rs&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),M.format===ha&&Pe===n.DEPTH_COMPONENT&&M.type!==rb&&M.type!==wo&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),M.type=wo,Ve=s.convert(M.type)),M.format===Jc&&Pe===n.DEPTH_COMPONENT&&(Pe=n.DEPTH_STENCIL,M.type!==da&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),M.type=da,Ve=s.convert(M.type))),L&&(kt?t.texStorage2D(n.TEXTURE_2D,1,Pe,j.width,j.height):t.texImage2D(n.TEXTURE_2D,0,Pe,j.width,j.height,0,ke,Ve,null));else if(M.isDataTexture)if(pt.length>0&&He){kt&&L&&t.texStorage2D(n.TEXTURE_2D,ye,Pe,pt[0].width,pt[0].height);for(let q=0,ge=pt.length;q<ge;q++)Le=pt[q],kt?t.texSubImage2D(n.TEXTURE_2D,q,0,0,Le.width,Le.height,ke,Ve,Le.data):t.texImage2D(n.TEXTURE_2D,q,Pe,Le.width,Le.height,0,ke,Ve,Le.data);M.generateMipmaps=!1}else kt?(L&&t.texStorage2D(n.TEXTURE_2D,ye,Pe,j.width,j.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,j.width,j.height,ke,Ve,j.data)):t.texImage2D(n.TEXTURE_2D,0,Pe,j.width,j.height,0,ke,Ve,j.data);else if(M.isCompressedTexture)if(M.isCompressedArrayTexture){kt&&L&&t.texStorage3D(n.TEXTURE_2D_ARRAY,ye,Pe,pt[0].width,pt[0].height,j.depth);for(let q=0,ge=pt.length;q<ge;q++)Le=pt[q],M.format!==rr?null!==ke?kt?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,q,0,0,0,Le.width,Le.height,j.depth,ke,Le.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,q,Pe,Le.width,Le.height,j.depth,0,Le.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):kt?t.texSubImage3D(n.TEXTURE_2D_ARRAY,q,0,0,0,Le.width,Le.height,j.depth,ke,Ve,Le.data):t.texImage3D(n.TEXTURE_2D_ARRAY,q,Pe,Le.width,Le.height,j.depth,0,ke,Ve,Le.data)}else{kt&&L&&t.texStorage2D(n.TEXTURE_2D,ye,Pe,pt[0].width,pt[0].height);for(let q=0,ge=pt.length;q<ge;q++)Le=pt[q],M.format!==rr?null!==ke?kt?t.compressedTexSubImage2D(n.TEXTURE_2D,q,0,0,Le.width,Le.height,ke,Le.data):t.compressedTexImage2D(n.TEXTURE_2D,q,Pe,Le.width,Le.height,0,Le.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):kt?t.texSubImage2D(n.TEXTURE_2D,q,0,0,Le.width,Le.height,ke,Ve,Le.data):t.texImage2D(n.TEXTURE_2D,q,Pe,Le.width,Le.height,0,ke,Ve,Le.data)}else if(M.isDataArrayTexture)kt?(L&&t.texStorage3D(n.TEXTURE_2D_ARRAY,ye,Pe,j.width,j.height,j.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,j.width,j.height,j.depth,ke,Ve,j.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,Pe,j.width,j.height,j.depth,0,ke,Ve,j.data);else if(M.isData3DTexture)kt?(L&&t.texStorage3D(n.TEXTURE_3D,ye,Pe,j.width,j.height,j.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,j.width,j.height,j.depth,ke,Ve,j.data)):t.texImage3D(n.TEXTURE_3D,0,Pe,j.width,j.height,j.depth,0,ke,Ve,j.data);else if(M.isFramebufferTexture){if(L)if(kt)t.texStorage2D(n.TEXTURE_2D,ye,Pe,j.width,j.height);else{let q=j.width,ge=j.height;for(let Ee=0;Ee<ye;Ee++)t.texImage2D(n.TEXTURE_2D,Ee,Pe,q,ge,0,ke,Ve,null),q>>=1,ge>>=1}}else if(pt.length>0&&He){kt&&L&&t.texStorage2D(n.TEXTURE_2D,ye,Pe,pt[0].width,pt[0].height);for(let q=0,ge=pt.length;q<ge;q++)Le=pt[q],kt?t.texSubImage2D(n.TEXTURE_2D,q,0,0,ke,Ve,Le):t.texImage2D(n.TEXTURE_2D,q,Pe,ke,Ve,Le);M.generateMipmaps=!1}else kt?(L&&t.texStorage2D(n.TEXTURE_2D,ye,Pe,j.width,j.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,ke,Ve,j)):t.texImage2D(n.TEXTURE_2D,0,Pe,ke,Ve,j);E(M,He)&&T(le),Ne.__version=ue.version,M.onUpdate&&M.onUpdate(M)}I.__version=M.version}function Be(I,M,H,le,ae,ue){const Ne=s.convert(H.format,H.colorSpace),fe=s.convert(H.type),j=P(H.internalFormat,Ne,fe,H.colorSpace);if(!i.get(M).__hasExternalTextures){const ke=Math.max(1,M.width>>ue),Ve=Math.max(1,M.height>>ue);ae===n.TEXTURE_3D||ae===n.TEXTURE_2D_ARRAY?t.texImage3D(ae,ue,j,ke,Ve,M.depth,0,Ne,fe,null):t.texImage2D(ae,ue,j,ke,Ve,0,Ne,fe,null)}t.bindFramebuffer(n.FRAMEBUFFER,I),nt(M)?h.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,le,ae,i.get(H).__webglTexture,0,De(M)):(ae===n.TEXTURE_2D||ae>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&ae<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,le,ae,i.get(H).__webglTexture,ue),t.bindFramebuffer(n.FRAMEBUFFER,null)}function R(I,M,H){if(n.bindRenderbuffer(n.RENDERBUFFER,I),M.depthBuffer&&!M.stencilBuffer){let le=n.DEPTH_COMPONENT16;if(H||nt(M)){const ae=M.depthTexture;ae&&ae.isDepthTexture&&(ae.type===Rs?le=n.DEPTH_COMPONENT32F:ae.type===wo&&(le=n.DEPTH_COMPONENT24));const ue=De(M);nt(M)?h.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ue,le,M.width,M.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,ue,le,M.width,M.height)}else n.renderbufferStorage(n.RENDERBUFFER,le,M.width,M.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,I)}else if(M.depthBuffer&&M.stencilBuffer){const le=De(M);H&&!1===nt(M)?n.renderbufferStorageMultisample(n.RENDERBUFFER,le,n.DEPTH24_STENCIL8,M.width,M.height):nt(M)?h.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,le,n.DEPTH24_STENCIL8,M.width,M.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,M.width,M.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,I)}else{const le=!0===M.isWebGLMultipleRenderTargets?M.texture:[M.texture];for(let ae=0;ae<le.length;ae++){const ue=le[ae],Ne=s.convert(ue.format,ue.colorSpace),fe=s.convert(ue.type),j=P(ue.internalFormat,Ne,fe,ue.colorSpace),He=De(M);H&&!1===nt(M)?n.renderbufferStorageMultisample(n.RENDERBUFFER,He,j,M.width,M.height):nt(M)?h.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,He,j,M.width,M.height):n.renderbufferStorage(n.RENDERBUFFER,j,M.width,M.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function ee(I){const M=i.get(I),H=!0===I.isWebGLCubeRenderTarget;if(I.depthTexture&&!M.__autoAllocateDepthBuffer){if(H)throw new Error("target.depthTexture not supported in Cube render targets");!function me(I,M){if(M&&M.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,I),!M.depthTexture||!M.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(M.depthTexture).__webglTexture||M.depthTexture.image.width!==M.width||M.depthTexture.image.height!==M.height)&&(M.depthTexture.image.width=M.width,M.depthTexture.image.height=M.height,M.depthTexture.needsUpdate=!0),Q(M.depthTexture,0);const le=i.get(M.depthTexture).__webglTexture,ae=De(M);if(M.depthTexture.format===ha)nt(M)?h.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,le,0,ae):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,le,0);else{if(M.depthTexture.format!==Jc)throw new Error("Unknown depthTexture format");nt(M)?h.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,le,0,ae):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,le,0)}}(M.__webglFramebuffer,I)}else if(H){M.__webglDepthbuffer=[];for(let le=0;le<6;le++)t.bindFramebuffer(n.FRAMEBUFFER,M.__webglFramebuffer[le]),M.__webglDepthbuffer[le]=n.createRenderbuffer(),R(M.__webglDepthbuffer[le],I,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,M.__webglFramebuffer),M.__webglDepthbuffer=n.createRenderbuffer(),R(M.__webglDepthbuffer,I,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function De(I){return Math.min(d,I.samples)}function nt(I){const M=i.get(I);return a&&I.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==M.__useRenderToTexture}function nn(I,M){const H=I.colorSpace,le=I.format,ae=I.type;return!0===I.isCompressedTexture||!0===I.isVideoTexture||1035===I.format||H!==Tr&&""!==H&&(H===Bt||H===Yp?!1===a?!0===e.has("EXT_sRGB")&&le===rr?(I.format=1035,I.minFilter=cn,I.generateMipmaps=!1):M=HR.sRGBToLinear(M):(le!==rr||ae!==bo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",H)),M}this.allocateTextureUnit=function F(){const I=O;return I>=c&&console.warn("THREE.WebGLTextures: Trying to use "+I+" texture units while this GPU supports only "+c),O+=1,I},this.resetTextureUnits=function N(){O=0},this.setTexture2D=Q,this.setTexture2DArray=function k(I,M){const H=i.get(I);I.version>0&&H.__version!==I.version?Ze(H,I,M):t.bindTexture(n.TEXTURE_2D_ARRAY,H.__webglTexture,n.TEXTURE0+M)},this.setTexture3D=function X(I,M){const H=i.get(I);I.version>0&&H.__version!==I.version?Ze(H,I,M):t.bindTexture(n.TEXTURE_3D,H.__webglTexture,n.TEXTURE0+M)},this.setTextureCube=function he(I,M){const H=i.get(I);I.version>0&&H.__version!==I.version?function It(I,M,H){if(6!==M.image.length)return;const le=Re(I,M),ae=M.source;t.bindTexture(n.TEXTURE_CUBE_MAP,I.__webglTexture,n.TEXTURE0+H);const ue=i.get(ae);if(ae.version!==ue.__version||!0===le){t.activeTexture(n.TEXTURE0+H),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,M.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,M.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,M.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,n.NONE);const Ne=M.isCompressedTexture||M.image[0].isCompressedTexture,fe=M.image[0]&&M.image[0].isDataTexture,j=[];for(let q=0;q<6;q++)j[q]=Ne||fe?fe?M.image[q].image:M.image[q]:v(M.image[q],!1,!0,l),j[q]=nn(M,j[q]);const He=j[0],ke=b(He)||a,Ve=s.convert(M.format,M.colorSpace),Pe=s.convert(M.type),Le=P(M.internalFormat,Ve,Pe,M.colorSpace),pt=a&&!0!==M.isVideoTexture,kt=void 0===ue.__version||!0===le;let ye,L=w(M,He,ke);if(Me(n.TEXTURE_CUBE_MAP,M,ke),Ne){pt&&kt&&t.texStorage2D(n.TEXTURE_CUBE_MAP,L,Le,He.width,He.height);for(let q=0;q<6;q++){ye=j[q].mipmaps;for(let ge=0;ge<ye.length;ge++){const Ee=ye[ge];M.format!==rr?null!==Ve?pt?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,ge,0,0,Ee.width,Ee.height,Ve,Ee.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,ge,Le,Ee.width,Ee.height,0,Ee.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):pt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,ge,0,0,Ee.width,Ee.height,Ve,Pe,Ee.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,ge,Le,Ee.width,Ee.height,0,Ve,Pe,Ee.data)}}}else{ye=M.mipmaps,pt&&kt&&(ye.length>0&&L++,t.texStorage2D(n.TEXTURE_CUBE_MAP,L,Le,j[0].width,j[0].height));for(let q=0;q<6;q++)if(fe){pt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,0,0,0,j[q].width,j[q].height,Ve,Pe,j[q].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,0,Le,j[q].width,j[q].height,0,Ve,Pe,j[q].data);for(let ge=0;ge<ye.length;ge++){const xt=ye[ge].image[q].image;pt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,ge+1,0,0,xt.width,xt.height,Ve,Pe,xt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,ge+1,Le,xt.width,xt.height,0,Ve,Pe,xt.data)}}else{pt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,0,0,0,Ve,Pe,j[q]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,0,Le,Ve,Pe,j[q]);for(let ge=0;ge<ye.length;ge++){const Ee=ye[ge];pt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,ge+1,0,0,Ve,Pe,Ee.image[q]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,ge+1,Le,Ve,Pe,Ee.image[q])}}}E(M,ke)&&T(n.TEXTURE_CUBE_MAP),ue.__version=ae.version,M.onUpdate&&M.onUpdate(M)}I.__version=M.version}(H,I,M):t.bindTexture(n.TEXTURE_CUBE_MAP,H.__webglTexture,n.TEXTURE0+M)},this.rebindTextures=function de(I,M,H){const le=i.get(I);void 0!==M&&Be(le.__webglFramebuffer,I,I.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),void 0!==H&&ee(I)},this.setupRenderTarget=function se(I){const M=I.texture,H=i.get(I),le=i.get(M);I.addEventListener("dispose",te),!0!==I.isWebGLMultipleRenderTargets&&(void 0===le.__webglTexture&&(le.__webglTexture=n.createTexture()),le.__version=M.version,o.memory.textures++);const ae=!0===I.isWebGLCubeRenderTarget,ue=!0===I.isWebGLMultipleRenderTargets,Ne=b(I)||a;if(ae){H.__webglFramebuffer=[];for(let fe=0;fe<6;fe++)if(a&&M.mipmaps&&M.mipmaps.length>0){H.__webglFramebuffer[fe]=[];for(let j=0;j<M.mipmaps.length;j++)H.__webglFramebuffer[fe][j]=n.createFramebuffer()}else H.__webglFramebuffer[fe]=n.createFramebuffer()}else{if(a&&M.mipmaps&&M.mipmaps.length>0){H.__webglFramebuffer=[];for(let fe=0;fe<M.mipmaps.length;fe++)H.__webglFramebuffer[fe]=n.createFramebuffer()}else H.__webglFramebuffer=n.createFramebuffer();if(ue)if(r.drawBuffers){const fe=I.texture;for(let j=0,He=fe.length;j<He;j++){const ke=i.get(fe[j]);void 0===ke.__webglTexture&&(ke.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&I.samples>0&&!1===nt(I)){const fe=ue?M:[M];H.__webglMultisampledFramebuffer=n.createFramebuffer(),H.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,H.__webglMultisampledFramebuffer);for(let j=0;j<fe.length;j++){const He=fe[j];H.__webglColorRenderbuffer[j]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,H.__webglColorRenderbuffer[j]);const ke=s.convert(He.format,He.colorSpace),Ve=s.convert(He.type),Pe=P(He.internalFormat,ke,Ve,He.colorSpace,!0===I.isXRRenderTarget),Le=De(I);n.renderbufferStorageMultisample(n.RENDERBUFFER,Le,Pe,I.width,I.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+j,n.RENDERBUFFER,H.__webglColorRenderbuffer[j])}n.bindRenderbuffer(n.RENDERBUFFER,null),I.depthBuffer&&(H.__webglDepthRenderbuffer=n.createRenderbuffer(),R(H.__webglDepthRenderbuffer,I,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(ae){t.bindTexture(n.TEXTURE_CUBE_MAP,le.__webglTexture),Me(n.TEXTURE_CUBE_MAP,M,Ne);for(let fe=0;fe<6;fe++)if(a&&M.mipmaps&&M.mipmaps.length>0)for(let j=0;j<M.mipmaps.length;j++)Be(H.__webglFramebuffer[fe][j],I,M,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+fe,j);else Be(H.__webglFramebuffer[fe],I,M,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+fe,0);E(M,Ne)&&T(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(ue){const fe=I.texture;for(let j=0,He=fe.length;j<He;j++){const ke=fe[j],Ve=i.get(ke);t.bindTexture(n.TEXTURE_2D,Ve.__webglTexture),Me(n.TEXTURE_2D,ke,Ne),Be(H.__webglFramebuffer,I,ke,n.COLOR_ATTACHMENT0+j,n.TEXTURE_2D,0),E(ke,Ne)&&T(n.TEXTURE_2D)}t.unbindTexture()}else{let fe=n.TEXTURE_2D;if((I.isWebGL3DRenderTarget||I.isWebGLArrayRenderTarget)&&(a?fe=I.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(fe,le.__webglTexture),Me(fe,M,Ne),a&&M.mipmaps&&M.mipmaps.length>0)for(let j=0;j<M.mipmaps.length;j++)Be(H.__webglFramebuffer[j],I,M,n.COLOR_ATTACHMENT0,fe,j);else Be(H.__webglFramebuffer,I,M,n.COLOR_ATTACHMENT0,fe,0);E(M,Ne)&&T(fe),t.unbindTexture()}I.depthBuffer&&ee(I)},this.updateRenderTargetMipmap=function Fe(I){const M=b(I)||a,H=!0===I.isWebGLMultipleRenderTargets?I.texture:[I.texture];for(let le=0,ae=H.length;le<ae;le++){const ue=H[le];if(E(ue,M)){const Ne=I.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,fe=i.get(ue).__webglTexture;t.bindTexture(Ne,fe),T(Ne),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function Ce(I){if(a&&I.samples>0&&!1===nt(I)){const M=I.isWebGLMultipleRenderTargets?I.texture:[I.texture],H=I.width,le=I.height;let ae=n.COLOR_BUFFER_BIT;const ue=[],Ne=I.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,fe=i.get(I),j=!0===I.isWebGLMultipleRenderTargets;if(j)for(let He=0;He<M.length;He++)t.bindFramebuffer(n.FRAMEBUFFER,fe.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+He,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,fe.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+He,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,fe.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,fe.__webglFramebuffer);for(let He=0;He<M.length;He++){ue.push(n.COLOR_ATTACHMENT0+He),I.depthBuffer&&ue.push(Ne);const ke=void 0!==fe.__ignoreDepthValues&&fe.__ignoreDepthValues;if(!1===ke&&(I.depthBuffer&&(ae|=n.DEPTH_BUFFER_BIT),I.stencilBuffer&&(ae|=n.STENCIL_BUFFER_BIT)),j&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,fe.__webglColorRenderbuffer[He]),!0===ke&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[Ne]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[Ne])),j){const Ve=i.get(M[He]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,Ve,0)}n.blitFramebuffer(0,0,H,le,0,0,H,le,ae,n.NEAREST),f&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,ue)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),j)for(let He=0;He<M.length;He++){t.bindFramebuffer(n.FRAMEBUFFER,fe.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+He,n.RENDERBUFFER,fe.__webglColorRenderbuffer[He]);const ke=i.get(M[He]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,fe.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+He,n.TEXTURE_2D,ke,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,fe.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=ee,this.setupFrameBufferTexture=Be,this.useMultisampledRTT=nt}function tK(n,e,t){const i=t.isWebGL2;return{convert:function r(s,o=""){let a;const c=o===Bt||o===Yp?1:0;if(s===bo)return n.UNSIGNED_BYTE;if(s===sR)return n.UNSIGNED_SHORT_4_4_4_4;if(s===oR)return n.UNSIGNED_SHORT_5_5_5_1;if(1010===s)return n.BYTE;if(1011===s)return n.SHORT;if(s===rb)return n.UNSIGNED_SHORT;if(1013===s)return n.INT;if(s===wo)return n.UNSIGNED_INT;if(s===Rs)return n.FLOAT;if(s===pd)return i?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(1021===s)return n.ALPHA;if(s===rr)return n.RGBA;if(1024===s)return n.LUMINANCE;if(1025===s)return n.LUMINANCE_ALPHA;if(s===ha)return n.DEPTH_COMPONENT;if(s===Jc)return n.DEPTH_STENCIL;if(1035===s)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(1028===s)return n.RED;if(s===aR)return n.RED_INTEGER;if(1030===s)return n.RG;if(s===cR)return n.RG_INTEGER;if(s===lR)return n.RGBA_INTEGER;if(33776===s||33777===s||33778===s||33779===s)if(1===c){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(33776===s)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(33776===s)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===s||35841===s||35842===s||35843===s){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(35840===s)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===s)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===s)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===s)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===s)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===s||37496===s){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(37492===s)return 1===c?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(37496===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(37808===s||37809===s||37810===s||37811===s||37812===s||37813===s||37814===s||37815===s||37816===s||37817===s||37818===s||37819===s||37820===s||37821===s){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(37808===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===s||36494===s||36495===s){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(36492===s)return 1===c?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===s)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===s)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===s||36284===s||36285===s||36286===s){if(a=e.get("EXT_texture_compression_rgtc"),null===a)return null;if(36492===s)return a.COMPRESSED_RED_RGTC1_EXT;if(36284===s)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===s)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===s)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return s===da?i?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==n[s]?n[s]:null}}}class nK extends $n{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Sa extends Gi{constructor(){super(),this.isGroup=!0,this.type="Group"}}const iK={type:"move"};class Wb{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Sa,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Sa,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new C,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new C),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Sa,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new C,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new C),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,c=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){o=!0;for(const _ of e.hand.values()){const g=t.getJointPose(_,i),m=this._getHandJoint(l,_);null!==g&&(m.matrix.fromArray(g.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.matrixWorldNeedsUpdate=!0,m.jointRadius=g.radius),m.visible=null!==g}const h=l.joints["index-finger-tip"].position.distanceTo(l.joints["thumb-tip"].position),f=.02,p=.005;l.inputState.pinching&&h>f+p?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&h<=f-p&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==c&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),null!==s&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,i),null===r&&null!==s&&(r=s),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(iK)))}return null!==a&&(a.visible=null!==r),null!==c&&(c.visible=null!==s),null!==l&&(l.visible=null!==o),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new Sa;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class rK extends Ls{constructor(e,t,i,r,s,o,a,c,l,u){if((u=void 0!==u?u:ha)!==ha&&u!==Jc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&u===ha&&(i=wo),void 0===i&&u===Jc&&(i=da),super(null,r,s,o,a,c,u,i,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:gn,this.minFilter=void 0!==c?c:gn,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class sK extends tl{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",c=1,l=null,u=null,d=null,h=null,f=null,p=null;const _=t.getContextAttributes();let g=null,m=null;const y=[],v=[],b=new $n;b.layers.enable(1),b.viewport=new Rt;const x=new $n;x.layers.enable(2),x.viewport=new Rt;const E=[b,x],T=new nK;T.layers.enable(1),T.layers.enable(2);let P=null,w=null;function S(k){const X=v.indexOf(k.inputSource);if(-1===X)return;const he=y[X];void 0!==he&&(he.update(k.inputSource,k.frame,l||o),he.dispatchEvent({type:k.type,data:k.inputSource}))}function W(){r.removeEventListener("select",S),r.removeEventListener("selectstart",S),r.removeEventListener("selectend",S),r.removeEventListener("squeeze",S),r.removeEventListener("squeezestart",S),r.removeEventListener("squeezeend",S),r.removeEventListener("end",W),r.removeEventListener("inputsourceschange",te);for(let k=0;k<y.length;k++){const X=v[k];null!==X&&(v[k]=null,y[k].disconnect(X))}P=null,w=null,e.setRenderTarget(g),f=null,h=null,d=null,r=null,m=null,Q.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function te(k){for(let X=0;X<k.removed.length;X++){const he=k.removed[X],ce=v.indexOf(he);ce>=0&&(v[ce]=null,y[ce].disconnect(he))}for(let X=0;X<k.added.length;X++){const he=k.added[X];let ce=v.indexOf(he);if(-1===ce){for(let Ue=0;Ue<y.length;Ue++){if(Ue>=v.length){v.push(he),ce=Ue;break}if(null===v[Ue]){v[Ue]=he,ce=Ue;break}}if(-1===ce)break}const Se=y[ce];Se&&Se.connect(he)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(k){let X=y[k];return void 0===X&&(X=new Wb,y[k]=X),X.getTargetRaySpace()},this.getControllerGrip=function(k){let X=y[k];return void 0===X&&(X=new Wb,y[k]=X),X.getGripSpace()},this.getHand=function(k){let X=y[k];return void 0===X&&(X=new Wb,y[k]=X),X.getHandSpace()},this.setFramebufferScaleFactor=function(k){s=k,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(k){a=k,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||o},this.setReferenceSpace=function(k){l=k},this.getBaseLayer=function(){return null!==h?h:f},this.getBinding=function(){return d},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=function(){var k=Q0(function*(X){if(r=X,null!==r){if(g=e.getRenderTarget(),r.addEventListener("select",S),r.addEventListener("selectstart",S),r.addEventListener("selectend",S),r.addEventListener("squeeze",S),r.addEventListener("squeezestart",S),r.addEventListener("squeezeend",S),r.addEventListener("end",W),r.addEventListener("inputsourceschange",te),!0!==_.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)f=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||_.antialias,alpha:!0,depth:_.depth,stencil:_.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:f}),m=new xo(f.framebufferWidth,f.framebufferHeight,{format:rr,type:bo,colorSpace:e.outputColorSpace,stencilBuffer:_.stencil});else{let he=null,ce=null,Se=null;_.depth&&(Se=_.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,he=_.stencil?Jc:ha,ce=_.stencil?da:wo);const Ue={colorFormat:t.RGBA8,depthFormat:Se,scaleFactor:s};d=new XRWebGLBinding(r,t),h=d.createProjectionLayer(Ue),r.updateRenderState({layers:[h]}),m=new xo(h.textureWidth,h.textureHeight,{format:rr,type:bo,depthTexture:new rK(h.textureWidth,h.textureHeight,ce,void 0,void 0,void 0,void 0,void 0,void 0,he),stencilBuffer:_.stencil,colorSpace:e.outputColorSpace,samples:_.antialias?4:0}),e.properties.get(m).__ignoreDepthValues=h.ignoreDepthValues}m.isXRRenderTarget=!0,this.setFoveation(c),l=null,o=yield r.requestReferenceSpace(a),Q.setContext(r),Q.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(X){return k.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode};const U=new C,V=new C;function O(k,X){null===X?k.matrixWorld.copy(k.matrix):k.matrixWorld.multiplyMatrices(X.matrixWorld,k.matrix),k.matrixWorldInverse.copy(k.matrixWorld).invert()}this.updateCamera=function(k){if(null===r)return;T.near=x.near=b.near=k.near,T.far=x.far=b.far=k.far,(P!==T.near||w!==T.far)&&(r.updateRenderState({depthNear:T.near,depthFar:T.far}),P=T.near,w=T.far);const X=k.parent,he=T.cameras;O(T,X);for(let ce=0;ce<he.length;ce++)O(he[ce],X);2===he.length?function G(k,X,he){U.setFromMatrixPosition(X.matrixWorld),V.setFromMatrixPosition(he.matrixWorld);const ce=U.distanceTo(V),Se=X.projectionMatrix.elements,Ue=he.projectionMatrix.elements,Me=Se[14]/(Se[10]-1),Re=Se[14]/(Se[10]+1),Ze=(Se[9]+1)/Se[5],It=(Se[9]-1)/Se[5],Be=(Se[8]-1)/Se[0],R=(Ue[8]+1)/Ue[0],me=Me*Be,ee=Me*R,de=ce/(-Be+R),se=de*-Be;X.matrixWorld.decompose(k.position,k.quaternion,k.scale),k.translateX(se),k.translateZ(de),k.matrixWorld.compose(k.position,k.quaternion,k.scale),k.matrixWorldInverse.copy(k.matrixWorld).invert();const Fe=Me+de,Ce=Re+de;k.projectionMatrix.makePerspective(me-se,ee+(ce-se),Ze*Re/Ce*Fe,It*Re/Ce*Fe,Fe,Ce),k.projectionMatrixInverse.copy(k.projectionMatrix).invert()}(T,b,x):T.projectionMatrix.copy(b.projectionMatrix),function N(k,X,he){null===he?k.matrix.copy(X.matrixWorld):(k.matrix.copy(he.matrixWorld),k.matrix.invert(),k.matrix.multiply(X.matrixWorld)),k.matrix.decompose(k.position,k.quaternion,k.scale),k.updateMatrixWorld(!0),k.projectionMatrix.copy(X.projectionMatrix),k.projectionMatrixInverse.copy(X.projectionMatrixInverse),k.isPerspectiveCamera&&(k.fov=2*nl*Math.atan(1/k.projectionMatrix.elements[5]),k.zoom=1)}(k,T,X)},this.getCamera=function(){return T},this.getFoveation=function(){if(null!==h||null!==f)return c},this.setFoveation=function(k){c=k,null!==h&&(h.fixedFoveation=k),null!==f&&void 0!==f.fixedFoveation&&(f.fixedFoveation=k)};let F=null;const Q=new aP;Q.setAnimationLoop(function $(k,X){if(u=X.getViewerPose(l||o),p=X,null!==u){const he=u.views;null!==f&&(e.setRenderTargetFramebuffer(m,f.framebuffer),e.setRenderTarget(m));let ce=!1;he.length!==T.cameras.length&&(T.cameras.length=0,ce=!0);for(let Se=0;Se<he.length;Se++){const Ue=he[Se];let Me=null;if(null!==f)Me=f.getViewport(Ue);else{const Ze=d.getViewSubImage(h,Ue);Me=Ze.viewport,0===Se&&(e.setRenderTargetTextures(m,Ze.colorTexture,h.ignoreDepthValues?void 0:Ze.depthStencilTexture),e.setRenderTarget(m))}let Re=E[Se];void 0===Re&&(Re=new $n,Re.layers.enable(Se),Re.viewport=new Rt,E[Se]=Re),Re.matrix.fromArray(Ue.transform.matrix),Re.matrix.decompose(Re.position,Re.quaternion,Re.scale),Re.projectionMatrix.fromArray(Ue.projectionMatrix),Re.projectionMatrixInverse.copy(Re.projectionMatrix).invert(),Re.viewport.set(Me.x,Me.y,Me.width,Me.height),0===Se&&(T.matrix.copy(Re.matrix),T.matrix.decompose(T.position,T.quaternion,T.scale)),!0===ce&&T.cameras.push(Re)}}for(let he=0;he<y.length;he++){const ce=v[he],Se=y[he];null!==ce&&void 0!==Se&&Se.update(ce,X,l||o)}F&&F(k,X),X.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:X}),p=null}),this.setAnimationLoop=function(k){F=k},this.dispose=function(){}}}function oK(n,e){function t(g,m){!0===g.matrixAutoUpdate&&g.updateMatrix(),m.value.copy(g.matrix)}function s(g,m){g.opacity.value=m.opacity,m.color&&g.diffuse.value.copy(m.color),m.emissive&&g.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(g.map.value=m.map,t(m.map,g.mapTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,t(m.alphaMap,g.alphaMapTransform)),m.bumpMap&&(g.bumpMap.value=m.bumpMap,t(m.bumpMap,g.bumpMapTransform),g.bumpScale.value=m.bumpScale,m.side===Si&&(g.bumpScale.value*=-1)),m.normalMap&&(g.normalMap.value=m.normalMap,t(m.normalMap,g.normalMapTransform),g.normalScale.value.copy(m.normalScale),m.side===Si&&g.normalScale.value.negate()),m.displacementMap&&(g.displacementMap.value=m.displacementMap,t(m.displacementMap,g.displacementMapTransform),g.displacementScale.value=m.displacementScale,g.displacementBias.value=m.displacementBias),m.emissiveMap&&(g.emissiveMap.value=m.emissiveMap,t(m.emissiveMap,g.emissiveMapTransform)),m.specularMap&&(g.specularMap.value=m.specularMap,t(m.specularMap,g.specularMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest);const y=e.get(m).envMap;if(y&&(g.envMap.value=y,g.flipEnvMap.value=y.isCubeTexture&&!1===y.isRenderTargetTexture?-1:1,g.reflectivity.value=m.reflectivity,g.ior.value=m.ior,g.refractionRatio.value=m.refractionRatio),m.lightMap){g.lightMap.value=m.lightMap;const v=!0===n._useLegacyLights?Math.PI:1;g.lightMapIntensity.value=m.lightMapIntensity*v,t(m.lightMap,g.lightMapTransform)}m.aoMap&&(g.aoMap.value=m.aoMap,g.aoMapIntensity.value=m.aoMapIntensity,t(m.aoMap,g.aoMapTransform))}return{refreshFogUniforms:function i(g,m){m.color.getRGB(g.fogColor.value,oP(n)),m.isFog?(g.fogNear.value=m.near,g.fogFar.value=m.far):m.isFogExp2&&(g.fogDensity.value=m.density)},refreshMaterialUniforms:function r(g,m,y,v,b){m.isMeshBasicMaterial||m.isMeshLambertMaterial?s(g,m):m.isMeshToonMaterial?(s(g,m),function d(g,m){m.gradientMap&&(g.gradientMap.value=m.gradientMap)}(g,m)):m.isMeshPhongMaterial?(s(g,m),function u(g,m){g.specular.value.copy(m.specular),g.shininess.value=Math.max(m.shininess,1e-4)}(g,m)):m.isMeshStandardMaterial?(s(g,m),function h(g,m){g.metalness.value=m.metalness,m.metalnessMap&&(g.metalnessMap.value=m.metalnessMap,t(m.metalnessMap,g.metalnessMapTransform)),g.roughness.value=m.roughness,m.roughnessMap&&(g.roughnessMap.value=m.roughnessMap,t(m.roughnessMap,g.roughnessMapTransform)),e.get(m).envMap&&(g.envMapIntensity.value=m.envMapIntensity)}(g,m),m.isMeshPhysicalMaterial&&function f(g,m,y){g.ior.value=m.ior,m.sheen>0&&(g.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),g.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(g.sheenColorMap.value=m.sheenColorMap,t(m.sheenColorMap,g.sheenColorMapTransform)),m.sheenRoughnessMap&&(g.sheenRoughnessMap.value=m.sheenRoughnessMap,t(m.sheenRoughnessMap,g.sheenRoughnessMapTransform))),m.clearcoat>0&&(g.clearcoat.value=m.clearcoat,g.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(g.clearcoatMap.value=m.clearcoatMap,t(m.clearcoatMap,g.clearcoatMapTransform)),m.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap,t(m.clearcoatRoughnessMap,g.clearcoatRoughnessMapTransform)),m.clearcoatNormalMap&&(g.clearcoatNormalMap.value=m.clearcoatNormalMap,t(m.clearcoatNormalMap,g.clearcoatNormalMapTransform),g.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),m.side===Si&&g.clearcoatNormalScale.value.negate())),m.iridescence>0&&(g.iridescence.value=m.iridescence,g.iridescenceIOR.value=m.iridescenceIOR,g.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],g.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(g.iridescenceMap.value=m.iridescenceMap,t(m.iridescenceMap,g.iridescenceMapTransform)),m.iridescenceThicknessMap&&(g.iridescenceThicknessMap.value=m.iridescenceThicknessMap,t(m.iridescenceThicknessMap,g.iridescenceThicknessMapTransform))),m.transmission>0&&(g.transmission.value=m.transmission,g.transmissionSamplerMap.value=y.texture,g.transmissionSamplerSize.value.set(y.width,y.height),m.transmissionMap&&(g.transmissionMap.value=m.transmissionMap,t(m.transmissionMap,g.transmissionMapTransform)),g.thickness.value=m.thickness,m.thicknessMap&&(g.thicknessMap.value=m.thicknessMap,t(m.thicknessMap,g.thicknessMapTransform)),g.attenuationDistance.value=m.attenuationDistance,g.attenuationColor.value.copy(m.attenuationColor)),m.anisotropy>0&&(g.anisotropyVector.value.set(m.anisotropy*Math.cos(m.anisotropyRotation),m.anisotropy*Math.sin(m.anisotropyRotation)),m.anisotropyMap&&(g.anisotropyMap.value=m.anisotropyMap,t(m.anisotropyMap,g.anisotropyMapTransform))),g.specularIntensity.value=m.specularIntensity,g.specularColor.value.copy(m.specularColor),m.specularColorMap&&(g.specularColorMap.value=m.specularColorMap,t(m.specularColorMap,g.specularColorMapTransform)),m.specularIntensityMap&&(g.specularIntensityMap.value=m.specularIntensityMap,t(m.specularIntensityMap,g.specularIntensityMapTransform))}(g,m,b)):m.isMeshMatcapMaterial?(s(g,m),function p(g,m){m.matcap&&(g.matcap.value=m.matcap)}(g,m)):m.isMeshDepthMaterial?s(g,m):m.isMeshDistanceMaterial?(s(g,m),function _(g,m){const y=e.get(m).light;g.referencePosition.value.setFromMatrixPosition(y.matrixWorld),g.nearDistance.value=y.shadow.camera.near,g.farDistance.value=y.shadow.camera.far}(g,m)):m.isMeshNormalMaterial?s(g,m):m.isLineBasicMaterial?(function o(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,m.map&&(g.map.value=m.map,t(m.map,g.mapTransform))}(g,m),m.isLineDashedMaterial&&function a(g,m){g.dashSize.value=m.dashSize,g.totalSize.value=m.dashSize+m.gapSize,g.scale.value=m.scale}(g,m)):m.isPointsMaterial?function c(g,m,y,v){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.size.value=m.size*y,g.scale.value=.5*v,m.map&&(g.map.value=m.map,t(m.map,g.uvTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,t(m.alphaMap,g.alphaMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest)}(g,m,y,v):m.isSpriteMaterial?function l(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.rotation.value=m.rotation,m.map&&(g.map.value=m.map,t(m.map,g.mapTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,t(m.alphaMap,g.alphaMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest)}(g,m):m.isShadowMaterial?(g.color.value.copy(m.color),g.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}}}function aK(n,e,t,i){let r={},s={},o=[];const a=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function f(y,v,b){const x=y.value;if(void 0===b[v]){if("number"==typeof x)b[v]=x;else{const E=Array.isArray(x)?x:[x],T=[];for(let P=0;P<E.length;P++)T.push(E[P].clone());b[v]=T}return!0}if("number"==typeof x){if(b[v]!==x)return b[v]=x,!0}else{const E=Array.isArray(b[v])?b[v]:[b[v]],T=Array.isArray(x)?x:[x];for(let P=0;P<E.length;P++){const w=E[P];if(!1===w.equals(T[P]))return w.copy(T[P]),!0}}return!1}function _(y){const v={boundary:0,storage:0};return"number"==typeof y?(v.boundary=4,v.storage=4):y.isVector2?(v.boundary=8,v.storage=8):y.isVector3||y.isColor?(v.boundary=16,v.storage=12):y.isVector4?(v.boundary=16,v.storage=16):y.isMatrix3?(v.boundary=48,v.storage=48):y.isMatrix4?(v.boundary=64,v.storage=64):y.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",y),v}function g(y){const v=y.target;v.removeEventListener("dispose",g);const b=o.indexOf(v.__bindingPointIndex);o.splice(b,1),n.deleteBuffer(r[v.id]),delete r[v.id],delete s[v.id]}return{bind:function c(y,v){i.uniformBlockBinding(y,v.program)},update:function l(y,v){let b=r[y.id];void 0===b&&(function p(y){const v=y.uniforms;let b=0;let E=0;for(let T=0,P=v.length;T<P;T++){const w=v[T],S={boundary:0,storage:0},W=Array.isArray(w.value)?w.value:[w.value];for(let te=0,U=W.length;te<U;te++){const G=_(W[te]);S.boundary+=G.boundary,S.storage+=G.storage}w.__data=new Float32Array(S.storage/Float32Array.BYTES_PER_ELEMENT),w.__offset=b,T>0&&(E=b%16,0!==E&&16-E-S.boundary<0&&(b+=16-E,w.__offset=b)),b+=S.storage}E=b%16,E>0&&(b+=16-E),y.__size=b,y.__cache={}}(y),b=function u(y){const v=function d(){for(let y=0;y<a;y++)if(-1===o.indexOf(y))return o.push(y),y;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();y.__bindingPointIndex=v;const b=n.createBuffer(),x=y.__size,E=y.usage;return n.bindBuffer(n.UNIFORM_BUFFER,b),n.bufferData(n.UNIFORM_BUFFER,x,E),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,v,b),b}(y),r[y.id]=b,y.addEventListener("dispose",g)),i.updateUBOMapping(y,v.program);const E=e.render.frame;s[y.id]!==E&&(function h(y){const b=y.uniforms,x=y.__cache;n.bindBuffer(n.UNIFORM_BUFFER,r[y.id]);for(let E=0,T=b.length;E<T;E++){const P=b[E];if(!0===f(P,E,x)){const w=P.__offset,S=Array.isArray(P.value)?P.value:[P.value];let W=0;for(let te=0;te<S.length;te++){const U=S[te],V=_(U);"number"==typeof U?(P.__data[0]=U,n.bufferSubData(n.UNIFORM_BUFFER,w+W,P.__data)):U.isMatrix3?(P.__data[0]=U.elements[0],P.__data[1]=U.elements[1],P.__data[2]=U.elements[2],P.__data[3]=U.elements[0],P.__data[4]=U.elements[3],P.__data[5]=U.elements[4],P.__data[6]=U.elements[5],P.__data[7]=U.elements[0],P.__data[8]=U.elements[6],P.__data[9]=U.elements[7],P.__data[10]=U.elements[8],P.__data[11]=U.elements[0]):(U.toArray(P.__data,W),W+=V.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,w,P.__data)}}n.bindBuffer(n.UNIFORM_BUFFER,null)}(y),s[y.id]=E)},dispose:function m(){for(const y in r)n.deleteBuffer(r[y]);o=[],r={},s={}}}}class FP{constructor(e={}){const{canvas:t=F7(),context:i=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:c=!0,preserveDrawingBuffer:l=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:d=!1}=e;let h;this.isWebGLRenderer=!0,h=null!==i?i.getContextAttributes().alpha:o;const f=new Uint32Array(4),p=new Int32Array(4);let _=null,g=null;const m=[],y=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=Bt,this._useLegacyLights=!1,this.toneMapping=_o,this.toneMappingExposure=1;const v=this;let b=!1,x=0,E=0,T=null,P=-1,w=null;const S=new Rt,W=new Rt;let te=null;const U=new Te(0);let V=0,G=t.width,O=t.height,N=1,F=null,$=null;const Q=new Rt(0,0,G,O),k=new Rt(0,0,G,O);let X=!1;const he=new kb;let ce=!1,Se=!1,Ue=null;const Me=new rt,Re=new ie,Ze=new C,It={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Be(){return null===T?N:1}let ee,de,se,Fe,Ce,De,nt,yt,nn,I,M,H,le,ae,ue,Ne,fe,j,He,ke,Ve,Pe,Le,pt,R=i;function me(D,B){for(let Y=0;Y<D.length;Y++){const K=t.getContext(D[Y],B);if(null!==K)return K}return null}try{const D={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:c,preserveDrawingBuffer:l,powerPreference:u,failIfMajorPerformanceCaveat:d};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r156"),t.addEventListener("webglcontextlost",ye,!1),t.addEventListener("webglcontextrestored",q,!1),t.addEventListener("webglcontextcreationerror",ge,!1),null===R){const B=["webgl2","webgl","experimental-webgl"];if(!0===v.isWebGL1Renderer&&B.shift(),R=me(B,D),null===R)throw me(B)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&R instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===R.getShaderPrecisionFormat&&(R.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(D){throw console.error("THREE.WebGLRenderer: "+D.message),D}function kt(){ee=new yY(R),de=new fY(R,ee,e),ee.init(de),Pe=new tK(R,ee,de),se=new JZ(R,ee,de),Fe=new xY(R),Ce=new VZ,De=new QZ(R,ee,se,Ce,de,Pe,Fe),nt=new mY(v),yt=new vY(v),nn=new hq(R,de),Le=new dY(R,ee,nn,de),I=new bY(R,nn,Fe,Le),M=new TY(R,I,nn,Fe),He=new SY(R,de,De),Ne=new pY(Ce),H=new BZ(v,nt,yt,ee,de,Le,Ne),le=new oK(v,Ce),ae=new HZ,ue=new XZ(ee,de),j=new uY(v,nt,yt,se,M,h,c),fe=new KZ(v,M,de),pt=new aK(R,Fe,de,se),ke=new hY(R,ee,Fe,de),Ve=new wY(R,ee,Fe,de),Fe.programs=H.programs,v.capabilities=de,v.extensions=ee,v.properties=Ce,v.renderLists=ae,v.shadowMap=fe,v.state=se,v.info=Fe}kt();const L=new sK(v,R);function ye(D){D.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),b=!0}function q(){console.log("THREE.WebGLRenderer: Context Restored."),b=!1;const D=Fe.autoReset,B=fe.enabled,Y=fe.autoUpdate,z=fe.needsUpdate,K=fe.type;kt(),Fe.autoReset=D,fe.enabled=B,fe.autoUpdate=Y,fe.needsUpdate=z,fe.type=K}function ge(D){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",D.statusMessage)}function Ee(D){const B=D.target;B.removeEventListener("dispose",Ee),function xt(D){(function Zt(D){const B=Ce.get(D).programs;void 0!==B&&(B.forEach(function(Y){H.releaseProgram(Y)}),D.isShaderMaterial&&H.releaseShaderCache(D))})(D),Ce.remove(D)}(B)}this.xr=L,this.getContext=function(){return R},this.getContextAttributes=function(){return R.getContextAttributes()},this.forceContextLoss=function(){const D=ee.get("WEBGL_lose_context");D&&D.loseContext()},this.forceContextRestore=function(){const D=ee.get("WEBGL_lose_context");D&&D.restoreContext()},this.getPixelRatio=function(){return N},this.setPixelRatio=function(D){void 0!==D&&(N=D,this.setSize(G,O,!1))},this.getSize=function(D){return D.set(G,O)},this.setSize=function(D,B,Y=!0){L.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(G=D,O=B,t.width=Math.floor(D*N),t.height=Math.floor(B*N),!0===Y&&(t.style.width=D+"px",t.style.height=B+"px"),this.setViewport(0,0,D,B))},this.getDrawingBufferSize=function(D){return D.set(G*N,O*N).floor()},this.setDrawingBufferSize=function(D,B,Y){G=D,O=B,N=Y,t.width=Math.floor(D*Y),t.height=Math.floor(B*Y),this.setViewport(0,0,D,B)},this.getCurrentViewport=function(D){return D.copy(S)},this.getViewport=function(D){return D.copy(Q)},this.setViewport=function(D,B,Y,z){D.isVector4?Q.set(D.x,D.y,D.z,D.w):Q.set(D,B,Y,z),se.viewport(S.copy(Q).multiplyScalar(N).floor())},this.getScissor=function(D){return D.copy(k)},this.setScissor=function(D,B,Y,z){D.isVector4?k.set(D.x,D.y,D.z,D.w):k.set(D,B,Y,z),se.scissor(W.copy(k).multiplyScalar(N).floor())},this.getScissorTest=function(){return X},this.setScissorTest=function(D){se.setScissorTest(X=D)},this.setOpaqueSort=function(D){F=D},this.setTransparentSort=function(D){$=D},this.getClearColor=function(D){return D.copy(j.getClearColor())},this.setClearColor=function(){j.setClearColor.apply(j,arguments)},this.getClearAlpha=function(){return j.getClearAlpha()},this.setClearAlpha=function(){j.setClearAlpha.apply(j,arguments)},this.clear=function(D=!0,B=!0,Y=!0){let z=0;if(D){let K=!1;if(null!==T){const Ae=T.texture.format;K=Ae===lR||Ae===cR||Ae===aR}if(K){const Ae=T.texture.type,We=Ae===bo||Ae===wo||Ae===rb||Ae===da||Ae===sR||Ae===oR,Ke=j.getClearColor(),Je=j.getClearAlpha(),mt=Ke.r,Xe=Ke.g,lt=Ke.b;We?(f[0]=mt,f[1]=Xe,f[2]=lt,f[3]=Je,R.clearBufferuiv(R.COLOR,0,f)):(p[0]=mt,p[1]=Xe,p[2]=lt,p[3]=Je,R.clearBufferiv(R.COLOR,0,p))}else z|=R.COLOR_BUFFER_BIT}B&&(z|=R.DEPTH_BUFFER_BIT),Y&&(z|=R.STENCIL_BUFFER_BIT),R.clear(z)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ye,!1),t.removeEventListener("webglcontextrestored",q,!1),t.removeEventListener("webglcontextcreationerror",ge,!1),ae.dispose(),ue.dispose(),Ce.dispose(),nt.dispose(),yt.dispose(),M.dispose(),Le.dispose(),pt.dispose(),H.dispose(),L.dispose(),L.removeEventListener("sessionstart",zt),L.removeEventListener("sessionend",ls),Ue&&(Ue.dispose(),Ue=null),hi.stop()},this.renderBufferDirect=function(D,B,Y,z,K,Ae){null===B&&(B=It);const We=K.isMesh&&K.matrixWorld.determinant()<0,Ke=function Gre(D,B,Y,z,K){!0!==B.isScene&&(B=It),De.resetTextureUnits();const Ae=B.fog,Ke=null===T?v.outputColorSpace:!0===T.isXRRenderTarget?T.texture.colorSpace:Tr,Je=(z.isMeshStandardMaterial?yt:nt).get(z.envMap||(z.isMeshStandardMaterial?B.environment:null)),mt=!0===z.vertexColors&&!!Y.attributes.color&&4===Y.attributes.color.itemSize,Xe=!!Y.attributes.tangent&&(!!z.normalMap||z.anisotropy>0),lt=!!Y.morphAttributes.position,rn=!!Y.morphAttributes.normal,dn=!!Y.morphAttributes.color;let hr=_o;z.toneMapped&&(null===T||!0===T.isXRRenderTarget)&&(hr=v.toneMapping);const Ks=Y.morphAttributes.position||Y.morphAttributes.normal||Y.morphAttributes.color,bn=void 0!==Ks?Ks.length:0,_t=Ce.get(z),jx=g.state.lights;!0!==ce||!0!==Se&&D===w||Ne.setState(z,D,D===w&&z.id===P);let wn=!1;z.version===_t.__version?(_t.needsLights&&_t.lightsStateVersion!==jx.state.version||_t.outputColorSpace!==Ke||K.isInstancedMesh&&!1===_t.instancing||!K.isInstancedMesh&&!0===_t.instancing||K.isSkinnedMesh&&!1===_t.skinning||!K.isSkinnedMesh&&!0===_t.skinning||K.isInstancedMesh&&!0===_t.instancingColor&&null===K.instanceColor||K.isInstancedMesh&&!1===_t.instancingColor&&null!==K.instanceColor||_t.envMap!==Je||!0===z.fog&&_t.fog!==Ae||void 0!==_t.numClippingPlanes&&(_t.numClippingPlanes!==Ne.numPlanes||_t.numIntersection!==Ne.numIntersection)||_t.vertexAlphas!==mt||_t.vertexTangents!==Xe||_t.morphTargets!==lt||_t.morphNormals!==rn||_t.morphColors!==dn||_t.toneMapping!==hr||!0===de.isWebGL2&&_t.morphTargetsCount!==bn)&&(wn=!0):(wn=!0,_t.__version=z.version);let Ga=_t.currentProgram;!0===wn&&(Ga=$g(z,B,K));let C2=!1,xh=!1,$x=!1;const fi=Ga.getUniforms(),Wa=_t.uniforms;if(se.useProgram(Ga.program)&&(C2=!0,xh=!0,$x=!0),z.id!==P&&(P=z.id,xh=!0),C2||w!==D){fi.setValue(R,"projectionMatrix",D.projectionMatrix),fi.setValue(R,"viewMatrix",D.matrixWorldInverse);const Yi=fi.map.cameraPosition;void 0!==Yi&&Yi.setValue(R,Ze.setFromMatrixPosition(D.matrixWorld)),de.logarithmicDepthBuffer&&fi.setValue(R,"logDepthBufFC",2/(Math.log(D.far+1)/Math.LN2)),(z.isMeshPhongMaterial||z.isMeshToonMaterial||z.isMeshLambertMaterial||z.isMeshBasicMaterial||z.isMeshStandardMaterial||z.isShaderMaterial)&&fi.setValue(R,"isOrthographic",!0===D.isOrthographicCamera),w!==D&&(w=D,xh=!0,$x=!0)}if(K.isSkinnedMesh){fi.setOptional(R,K,"bindMatrix"),fi.setOptional(R,K,"bindMatrixInverse");const Yi=K.skeleton;Yi&&(de.floatVertexTextures?(null===Yi.boneTexture&&Yi.computeBoneTexture(),fi.setValue(R,"boneTexture",Yi.boneTexture,De),fi.setValue(R,"boneTextureSize",Yi.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const qx=Y.morphAttributes;if((void 0!==qx.position||void 0!==qx.normal||void 0!==qx.color&&!0===de.isWebGL2)&&He.update(K,Y,Ga),(xh||_t.receiveShadow!==K.receiveShadow)&&(_t.receiveShadow=K.receiveShadow,fi.setValue(R,"receiveShadow",K.receiveShadow)),z.isMeshGouraudMaterial&&null!==z.envMap&&(Wa.envMap.value=Je,Wa.flipEnvMap.value=Je.isCubeTexture&&!1===Je.isRenderTargetTexture?-1:1),xh&&(fi.setValue(R,"toneMappingExposure",v.toneMappingExposure),_t.needsLights&&function Wre(D,B){D.ambientLightColor.needsUpdate=B,D.lightProbe.needsUpdate=B,D.directionalLights.needsUpdate=B,D.directionalLightShadows.needsUpdate=B,D.pointLights.needsUpdate=B,D.pointLightShadows.needsUpdate=B,D.spotLights.needsUpdate=B,D.spotLightShadows.needsUpdate=B,D.rectAreaLights.needsUpdate=B,D.hemisphereLights.needsUpdate=B}(Wa,$x),Ae&&!0===z.fog&&le.refreshFogUniforms(Wa,Ae),le.refreshMaterialUniforms(Wa,z,N,O,Ue),xm.upload(R,_t.uniformsList,Wa,De)),z.isShaderMaterial&&!0===z.uniformsNeedUpdate&&(xm.upload(R,_t.uniformsList,Wa,De),z.uniformsNeedUpdate=!1),z.isSpriteMaterial&&fi.setValue(R,"center",K.center),fi.setValue(R,"modelViewMatrix",K.modelViewMatrix),fi.setValue(R,"normalMatrix",K.normalMatrix),fi.setValue(R,"modelMatrix",K.matrixWorld),z.isShaderMaterial||z.isRawShaderMaterial){const Yi=z.uniformsGroups;for(let Xx=0,$re=Yi.length;Xx<$re;Xx++)if(de.isWebGL2){const A2=Yi[Xx];pt.update(A2,Ga),pt.bind(A2,Ga)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Ga}(D,B,Y,z,K);se.setMaterial(z,We);let Je=Y.index,mt=1;if(!0===z.wireframe){if(Je=I.getWireframeAttribute(Y),void 0===Je)return;mt=2}const Xe=Y.drawRange,lt=Y.attributes.position;let rn=Xe.start*mt,dn=(Xe.start+Xe.count)*mt;null!==Ae&&(rn=Math.max(rn,Ae.start*mt),dn=Math.min(dn,(Ae.start+Ae.count)*mt)),null!==Je?(rn=Math.max(rn,0),dn=Math.min(dn,Je.count)):null!=lt&&(rn=Math.max(rn,0),dn=Math.min(dn,lt.count));const hr=dn-rn;if(hr<0||hr===1/0)return;Le.setup(K,z,Ke,Y,Je);let Ks,bn=ke;if(null!==Je&&(Ks=nn.get(Je),bn=Ve,bn.setIndex(Ks)),K.isMesh)!0===z.wireframe?(se.setLineWidth(z.wireframeLinewidth*Be()),bn.setMode(R.LINES)):bn.setMode(R.TRIANGLES);else if(K.isLine){let _t=z.linewidth;void 0===_t&&(_t=1),se.setLineWidth(_t*Be()),bn.setMode(K.isLineSegments?R.LINES:K.isLineLoop?R.LINE_LOOP:R.LINE_STRIP)}else K.isPoints?bn.setMode(R.POINTS):K.isSprite&&bn.setMode(R.TRIANGLES);if(K.isInstancedMesh)bn.renderInstances(rn,hr,K.count);else if(Y.isInstancedBufferGeometry){const jx=Math.min(Y.instanceCount,void 0!==Y._maxInstanceCount?Y._maxInstanceCount:1/0);bn.renderInstances(rn,hr,jx)}else bn.render(rn,hr)},this.compile=function(D,B){function Y(z,K,Ae){!0===z.transparent&&z.side===Is&&!1===z.forceSinglePass?(z.side=Si,z.needsUpdate=!0,$g(z,K,Ae),z.side=mo,z.needsUpdate=!0,$g(z,K,Ae),z.side=Is):$g(z,K,Ae)}g=ue.get(D),g.init(),y.push(g),D.traverseVisible(function(z){z.isLight&&z.layers.test(B.layers)&&(g.pushLight(z),z.castShadow&&g.pushShadow(z))}),g.setupLights(v._useLegacyLights),D.traverse(function(z){const K=z.material;if(K)if(Array.isArray(K))for(let Ae=0;Ae<K.length;Ae++)Y(K[Ae],D,z);else Y(K,D,z)}),y.pop(),g=null};let yn=null;function zt(){hi.stop()}function ls(){hi.start()}const hi=new aP;function M2(D,B,Y,z){if(!1===D.visible)return;if(D.layers.test(B.layers))if(D.isGroup)Y=D.renderOrder;else if(D.isLOD)!0===D.autoUpdate&&D.update(B);else if(D.isLight)g.pushLight(D),D.castShadow&&g.pushShadow(D);else if(D.isSprite){if(!D.frustumCulled||he.intersectsSprite(D)){z&&Ze.setFromMatrixPosition(D.matrixWorld).applyMatrix4(Me);const We=M.update(D),Ke=D.material;Ke.visible&&_.push(D,We,Ke,Y,Ze.z,null)}}else if((D.isMesh||D.isLine||D.isPoints)&&(!D.frustumCulled||he.intersectsObject(D))){const We=M.update(D),Ke=D.material;if(z&&(void 0!==D.boundingSphere?(null===D.boundingSphere&&D.computeBoundingSphere(),Ze.copy(D.boundingSphere.center)):(null===We.boundingSphere&&We.computeBoundingSphere(),Ze.copy(We.boundingSphere.center)),Ze.applyMatrix4(D.matrixWorld).applyMatrix4(Me)),Array.isArray(Ke)){const Je=We.groups;for(let mt=0,Xe=Je.length;mt<Xe;mt++){const lt=Je[mt],rn=Ke[lt.materialIndex];rn&&rn.visible&&_.push(D,We,rn,Y,Ze.z,lt)}}else Ke.visible&&_.push(D,We,Ke,Y,Ze.z,null)}const Ae=D.children;for(let We=0,Ke=Ae.length;We<Ke;We++)M2(Ae[We],B,Y,z)}function E2(D,B,Y,z){const K=D.opaque,Ae=D.transmissive,We=D.transparent;g.setupLightsView(Y),!0===ce&&Ne.setGlobalState(v.clippingPlanes,Y),Ae.length>0&&function Hre(D,B,Y,z){const K=de.isWebGL2;null===Ue&&(Ue=new xo(1,1,{generateMipmaps:!0,type:ee.has("EXT_color_buffer_half_float")?pd:bo,minFilter:yo,samples:K?4:0})),v.getDrawingBufferSize(Re),K?Ue.setSize(Re.x,Re.y):Ue.setSize(Jp(Re.x),Jp(Re.y));const Ae=v.getRenderTarget();v.setRenderTarget(Ue),v.getClearColor(U),V=v.getClearAlpha(),V<1&&v.setClearColor(16777215,.5),v.clear();const We=v.toneMapping;v.toneMapping=_o,jg(D,Y,z),De.updateMultisampleRenderTarget(Ue),De.updateRenderTargetMipmap(Ue);let Ke=!1;for(let Je=0,mt=B.length;Je<mt;Je++){const Xe=B[Je],lt=Xe.object,rn=Xe.geometry,dn=Xe.material,hr=Xe.group;if(dn.side===Is&&lt.layers.test(z.layers)){const Ks=dn.side;dn.side=Si,dn.needsUpdate=!0,S2(lt,Y,z,rn,dn,hr),dn.side=Ks,dn.needsUpdate=!0,Ke=!0}}!0===Ke&&(De.updateMultisampleRenderTarget(Ue),De.updateRenderTargetMipmap(Ue)),v.setRenderTarget(Ae),v.setClearColor(U,V),v.toneMapping=We}(K,Ae,B,Y),z&&se.viewport(S.copy(z)),K.length>0&&jg(K,B,Y),Ae.length>0&&jg(Ae,B,Y),We.length>0&&jg(We,B,Y),se.buffers.depth.setTest(!0),se.buffers.depth.setMask(!0),se.buffers.color.setMask(!0),se.setPolygonOffset(!1)}function jg(D,B,Y){const z=!0===B.isScene?B.overrideMaterial:null;for(let K=0,Ae=D.length;K<Ae;K++){const We=D[K],Ke=We.object,Je=We.geometry,mt=null===z?We.material:z,Xe=We.group;Ke.layers.test(Y.layers)&&S2(Ke,B,Y,Je,mt,Xe)}}function S2(D,B,Y,z,K,Ae){D.onBeforeRender(v,B,Y,z,K,Ae),D.modelViewMatrix.multiplyMatrices(Y.matrixWorldInverse,D.matrixWorld),D.normalMatrix.getNormalMatrix(D.modelViewMatrix),K.onBeforeRender(v,B,Y,z,D,Ae),!0===K.transparent&&K.side===Is&&!1===K.forceSinglePass?(K.side=Si,K.needsUpdate=!0,v.renderBufferDirect(Y,B,z,K,D,Ae),K.side=mo,K.needsUpdate=!0,v.renderBufferDirect(Y,B,z,K,D,Ae),K.side=Is):v.renderBufferDirect(Y,B,z,K,D,Ae),D.onAfterRender(v,B,Y,z,K,Ae)}function $g(D,B,Y){!0!==B.isScene&&(B=It);const z=Ce.get(D),K=g.state.lights,We=K.state.version,Ke=H.getParameters(D,K.state,g.state.shadowsArray,B,Y),Je=H.getProgramCacheKey(Ke);let mt=z.programs;z.environment=D.isMeshStandardMaterial?B.environment:null,z.fog=B.fog,z.envMap=(D.isMeshStandardMaterial?yt:nt).get(D.envMap||z.environment),void 0===mt&&(D.addEventListener("dispose",Ee),mt=new Map,z.programs=mt);let Xe=mt.get(Je);if(void 0!==Xe){if(z.currentProgram===Xe&&z.lightsStateVersion===We)return T2(D,Ke),Xe}else Ke.uniforms=H.getUniforms(D),D.onBuild(Y,Ke,v),D.onBeforeCompile(Ke,v),Xe=H.acquireProgram(Ke,Je),mt.set(Je,Xe),z.uniforms=Ke.uniforms;const lt=z.uniforms;(!D.isShaderMaterial&&!D.isRawShaderMaterial||!0===D.clipping)&&(lt.clippingPlanes=Ne.uniform),T2(D,Ke),z.needsLights=function jre(D){return D.isMeshLambertMaterial||D.isMeshToonMaterial||D.isMeshPhongMaterial||D.isMeshStandardMaterial||D.isShadowMaterial||D.isShaderMaterial&&!0===D.lights}(D),z.lightsStateVersion=We,z.needsLights&&(lt.ambientLightColor.value=K.state.ambient,lt.lightProbe.value=K.state.probe,lt.directionalLights.value=K.state.directional,lt.directionalLightShadows.value=K.state.directionalShadow,lt.spotLights.value=K.state.spot,lt.spotLightShadows.value=K.state.spotShadow,lt.rectAreaLights.value=K.state.rectArea,lt.ltc_1.value=K.state.rectAreaLTC1,lt.ltc_2.value=K.state.rectAreaLTC2,lt.pointLights.value=K.state.point,lt.pointLightShadows.value=K.state.pointShadow,lt.hemisphereLights.value=K.state.hemi,lt.directionalShadowMap.value=K.state.directionalShadowMap,lt.directionalShadowMatrix.value=K.state.directionalShadowMatrix,lt.spotShadowMap.value=K.state.spotShadowMap,lt.spotLightMatrix.value=K.state.spotLightMatrix,lt.spotLightMap.value=K.state.spotLightMap,lt.pointShadowMap.value=K.state.pointShadowMap,lt.pointShadowMatrix.value=K.state.pointShadowMatrix);const rn=Xe.getUniforms(),dn=xm.seqWithValue(rn.seq,lt);return z.currentProgram=Xe,z.uniformsList=dn,Xe}function T2(D,B){const Y=Ce.get(D);Y.outputColorSpace=B.outputColorSpace,Y.instancing=B.instancing,Y.instancingColor=B.instancingColor,Y.skinning=B.skinning,Y.morphTargets=B.morphTargets,Y.morphNormals=B.morphNormals,Y.morphColors=B.morphColors,Y.morphTargetsCount=B.morphTargetsCount,Y.numClippingPlanes=B.numClippingPlanes,Y.numIntersection=B.numClipIntersection,Y.vertexAlphas=B.vertexAlphas,Y.vertexTangents=B.vertexTangents,Y.toneMapping=B.toneMapping}hi.setAnimationLoop(function Bo(D){yn&&yn(D)}),typeof self<"u"&&hi.setContext(self),this.setAnimationLoop=function(D){yn=D,L.setAnimationLoop(D),null===D?hi.stop():hi.start()},L.addEventListener("sessionstart",zt),L.addEventListener("sessionend",ls),this.render=function(D,B){if(void 0===B||!0===B.isCamera){if(!0!==b){if(!0===D.matrixWorldAutoUpdate&&D.updateMatrixWorld(),null===B.parent&&!0===B.matrixWorldAutoUpdate&&B.updateMatrixWorld(),!0===L.enabled&&!0===L.isPresenting&&(!0===L.cameraAutoUpdate&&L.updateCamera(B),B=L.getCamera()),!0===D.isScene&&D.onBeforeRender(v,D,B,T),g=ue.get(D,y.length),g.init(),y.push(g),Me.multiplyMatrices(B.projectionMatrix,B.matrixWorldInverse),he.setFromProjectionMatrix(Me),Se=this.localClippingEnabled,ce=Ne.init(this.clippingPlanes,Se),_=ae.get(D,m.length),_.init(),m.push(_),M2(D,B,0,v.sortObjects),_.finish(),!0===v.sortObjects&&_.sort(F,$),this.info.render.frame++,!0===ce&&Ne.beginShadows(),fe.render(g.state.shadowsArray,D,B),!0===ce&&Ne.endShadows(),!0===this.info.autoReset&&this.info.reset(),j.render(_,D),g.setupLights(v._useLegacyLights),B.isArrayCamera){const z=B.cameras;for(let K=0,Ae=z.length;K<Ae;K++){const We=z[K];E2(_,D,We,We.viewport)}}else E2(_,D,B);null!==T&&(De.updateMultisampleRenderTarget(T),De.updateRenderTargetMipmap(T)),!0===D.isScene&&D.onAfterRender(v,D,B),Le.resetDefaultState(),P=-1,w=null,y.pop(),g=y.length>0?y[y.length-1]:null,m.pop(),_=m.length>0?m[m.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return x},this.getActiveMipmapLevel=function(){return E},this.getRenderTarget=function(){return T},this.setRenderTargetTextures=function(D,B,Y){Ce.get(D.texture).__webglTexture=B,Ce.get(D.depthTexture).__webglTexture=Y;const z=Ce.get(D);z.__hasExternalTextures=!0,z.__hasExternalTextures&&(z.__autoAllocateDepthBuffer=void 0===Y,z.__autoAllocateDepthBuffer||!0===ee.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),z.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(D,B){const Y=Ce.get(D);Y.__webglFramebuffer=B,Y.__useDefaultFramebuffer=void 0===B},this.setRenderTarget=function(D,B=0,Y=0){T=D,x=B,E=Y;let z=!0,K=null,Ae=!1,We=!1;if(D){const Je=Ce.get(D);void 0!==Je.__useDefaultFramebuffer?(se.bindFramebuffer(R.FRAMEBUFFER,null),z=!1):void 0===Je.__webglFramebuffer?De.setupRenderTarget(D):Je.__hasExternalTextures&&De.rebindTextures(D,Ce.get(D.texture).__webglTexture,Ce.get(D.depthTexture).__webglTexture);const mt=D.texture;(mt.isData3DTexture||mt.isDataArrayTexture||mt.isCompressedArrayTexture)&&(We=!0);const Xe=Ce.get(D).__webglFramebuffer;D.isWebGLCubeRenderTarget?(K=Array.isArray(Xe[B])?Xe[B][Y]:Xe[B],Ae=!0):K=de.isWebGL2&&D.samples>0&&!1===De.useMultisampledRTT(D)?Ce.get(D).__webglMultisampledFramebuffer:Array.isArray(Xe)?Xe[Y]:Xe,S.copy(D.viewport),W.copy(D.scissor),te=D.scissorTest}else S.copy(Q).multiplyScalar(N).floor(),W.copy(k).multiplyScalar(N).floor(),te=X;if(se.bindFramebuffer(R.FRAMEBUFFER,K)&&de.drawBuffers&&z&&se.drawBuffers(D,K),se.viewport(S),se.scissor(W),se.setScissorTest(te),Ae){const Je=Ce.get(D.texture);R.framebufferTexture2D(R.FRAMEBUFFER,R.COLOR_ATTACHMENT0,R.TEXTURE_CUBE_MAP_POSITIVE_X+B,Je.__webglTexture,Y)}else if(We){const Je=Ce.get(D.texture);R.framebufferTextureLayer(R.FRAMEBUFFER,R.COLOR_ATTACHMENT0,Je.__webglTexture,Y||0,B||0)}P=-1},this.readRenderTargetPixels=function(D,B,Y,z,K,Ae,We){if(!D||!D.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Ke=Ce.get(D).__webglFramebuffer;if(D.isWebGLCubeRenderTarget&&void 0!==We&&(Ke=Ke[We]),Ke){se.bindFramebuffer(R.FRAMEBUFFER,Ke);try{const Je=D.texture,mt=Je.format,Xe=Je.type;if(mt!==rr&&Pe.convert(mt)!==R.getParameter(R.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const lt=Xe===pd&&(ee.has("EXT_color_buffer_half_float")||de.isWebGL2&&ee.has("EXT_color_buffer_float"));if(!(Xe===bo||Pe.convert(Xe)===R.getParameter(R.IMPLEMENTATION_COLOR_READ_TYPE)||Xe===Rs&&(de.isWebGL2||ee.has("OES_texture_float")||ee.has("WEBGL_color_buffer_float"))||lt))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");B>=0&&B<=D.width-z&&Y>=0&&Y<=D.height-K&&R.readPixels(B,Y,z,K,Pe.convert(mt),Pe.convert(Xe),Ae)}finally{const Je=null!==T?Ce.get(T).__webglFramebuffer:null;se.bindFramebuffer(R.FRAMEBUFFER,Je)}}},this.copyFramebufferToTexture=function(D,B,Y=0){const z=Math.pow(2,-Y),K=Math.floor(B.image.width*z),Ae=Math.floor(B.image.height*z);De.setTexture2D(B,0),R.copyTexSubImage2D(R.TEXTURE_2D,Y,0,0,D.x,D.y,K,Ae),se.unbindTexture()},this.copyTextureToTexture=function(D,B,Y,z=0){const K=B.image.width,Ae=B.image.height,We=Pe.convert(Y.format),Ke=Pe.convert(Y.type);De.setTexture2D(Y,0),R.pixelStorei(R.UNPACK_FLIP_Y_WEBGL,Y.flipY),R.pixelStorei(R.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Y.premultiplyAlpha),R.pixelStorei(R.UNPACK_ALIGNMENT,Y.unpackAlignment),B.isDataTexture?R.texSubImage2D(R.TEXTURE_2D,z,D.x,D.y,K,Ae,We,Ke,B.image.data):B.isCompressedTexture?R.compressedTexSubImage2D(R.TEXTURE_2D,z,D.x,D.y,B.mipmaps[0].width,B.mipmaps[0].height,We,B.mipmaps[0].data):R.texSubImage2D(R.TEXTURE_2D,z,D.x,D.y,We,Ke,B.image),0===z&&Y.generateMipmaps&&R.generateMipmap(R.TEXTURE_2D),se.unbindTexture()},this.copyTextureToTexture3D=function(D,B,Y,z,K=0){if(v.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Ae=D.max.x-D.min.x+1,We=D.max.y-D.min.y+1,Ke=D.max.z-D.min.z+1,Je=Pe.convert(z.format),mt=Pe.convert(z.type);let Xe;if(z.isData3DTexture)De.setTexture3D(z,0),Xe=R.TEXTURE_3D;else{if(!z.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");De.setTexture2DArray(z,0),Xe=R.TEXTURE_2D_ARRAY}R.pixelStorei(R.UNPACK_FLIP_Y_WEBGL,z.flipY),R.pixelStorei(R.UNPACK_PREMULTIPLY_ALPHA_WEBGL,z.premultiplyAlpha),R.pixelStorei(R.UNPACK_ALIGNMENT,z.unpackAlignment);const lt=R.getParameter(R.UNPACK_ROW_LENGTH),rn=R.getParameter(R.UNPACK_IMAGE_HEIGHT),dn=R.getParameter(R.UNPACK_SKIP_PIXELS),hr=R.getParameter(R.UNPACK_SKIP_ROWS),Ks=R.getParameter(R.UNPACK_SKIP_IMAGES),bn=Y.isCompressedTexture?Y.mipmaps[0]:Y.image;R.pixelStorei(R.UNPACK_ROW_LENGTH,bn.width),R.pixelStorei(R.UNPACK_IMAGE_HEIGHT,bn.height),R.pixelStorei(R.UNPACK_SKIP_PIXELS,D.min.x),R.pixelStorei(R.UNPACK_SKIP_ROWS,D.min.y),R.pixelStorei(R.UNPACK_SKIP_IMAGES,D.min.z),Y.isDataTexture||Y.isData3DTexture?R.texSubImage3D(Xe,K,B.x,B.y,B.z,Ae,We,Ke,Je,mt,bn.data):Y.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),R.compressedTexSubImage3D(Xe,K,B.x,B.y,B.z,Ae,We,Ke,Je,bn.data)):R.texSubImage3D(Xe,K,B.x,B.y,B.z,Ae,We,Ke,Je,mt,bn),R.pixelStorei(R.UNPACK_ROW_LENGTH,lt),R.pixelStorei(R.UNPACK_IMAGE_HEIGHT,rn),R.pixelStorei(R.UNPACK_SKIP_PIXELS,dn),R.pixelStorei(R.UNPACK_SKIP_ROWS,hr),R.pixelStorei(R.UNPACK_SKIP_IMAGES,Ks),0===K&&z.generateMipmaps&&R.generateMipmap(Xe),se.unbindTexture()},this.initTexture=function(D){D.isCubeTexture?De.setTextureCube(D,0):D.isData3DTexture?De.setTexture3D(D,0):D.isDataArrayTexture||D.isCompressedArrayTexture?De.setTexture2DArray(D,0):De.setTexture2D(D,0),se.unbindTexture()},this.resetState=function(){x=0,E=0,T=null,se.reset(),Le.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ps}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Bt?fa:3e3}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===fa?Bt:Tr}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}(class cK extends FP{}).prototype.isWebGL1Renderer=!0;class qb extends Gi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class ns{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let r=0;const s=i.length;let o;o=t||e*i[s-1];let l,a=0,c=s-1;for(;a<=c;)if(r=Math.floor(a+(c-a)/2),l=i[r]-o,l<0)a=r+1;else{if(!(l>0)){c=r;break}c=r-1}if(r=c,i[r]===o)return r/(s-1);const u=i[r];return(r+(o-u)/(i[r+1]-u))/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),c=t||(o.isVector2?new ie:new C);return c.copy(a).sub(o).normalize(),c}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new C,r=[],s=[],o=[],a=new C,c=new rt;for(let f=0;f<=e;f++)r[f]=this.getTangentAt(f/e,new C);s[0]=new C,o[0]=new C;let l=Number.MAX_VALUE;const u=Math.abs(r[0].x),d=Math.abs(r[0].y),h=Math.abs(r[0].z);u<=l&&(l=u,i.set(1,0,0)),d<=l&&(l=d,i.set(0,1,0)),h<=l&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let f=1;f<=e;f++){if(s[f]=s[f-1].clone(),o[f]=o[f-1].clone(),a.crossVectors(r[f-1],r[f]),a.length()>Number.EPSILON){a.normalize();const p=Math.acos(en(r[f-1].dot(r[f]),-1,1));s[f].applyMatrix4(c.makeRotationAxis(a,p))}o[f].crossVectors(r[f],s[f])}if(!0===t){let f=Math.acos(en(s[0].dot(s[e]),-1,1));f/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(f=-f);for(let p=1;p<=e;p++)s[p].applyMatrix4(c.makeRotationAxis(r[p],f*p)),o[p].crossVectors(r[p],s[p])}return{tangents:r,normals:s,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}function aL(n,e,t,i,r){const s=.5*(i-e),o=.5*(r-t),a=n*n;return(2*t-2*i+s+o)*(n*a)+(-3*t+3*i-2*s-o)*a+s*n+t}class ow extends ns{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new ie){const i=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,c=r[0===o?o:o-1],l=r[o],u=r[o>r.length-2?r.length-1:o+1],d=r[o>r.length-3?r.length-1:o+2];return i.set(aL(a,c.x,l.x,u.x,d.x),aL(a,c.y,l.y,u.y,d.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new ie).fromArray(r))}return this}}class Bd extends ft{constructor(e=1,t=32,i=16,r=0,s=2*Math.PI,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const c=Math.min(o+a,Math.PI);let l=0;const u=[],d=new C,h=new C,f=[],p=[],_=[],g=[];for(let m=0;m<=i;m++){const y=[],v=m/i;let b=0;0===m&&0===o?b=.5/t:m===i&&c===Math.PI&&(b=-.5/t);for(let x=0;x<=t;x++){const E=x/t;d.x=-e*Math.cos(r+E*s)*Math.sin(o+v*a),d.y=e*Math.cos(o+v*a),d.z=e*Math.sin(r+E*s)*Math.sin(o+v*a),p.push(d.x,d.y,d.z),h.copy(d).normalize(),_.push(h.x,h.y,h.z),g.push(E+b,1-v),y.push(l++)}u.push(y)}for(let m=0;m<i;m++)for(let y=0;y<t;y++){const b=u[m][y],x=u[m+1][y],E=u[m+1][y+1];(0!==m||o>0)&&f.push(u[m][y+1],b,E),(m!==i-1||c<Math.PI)&&f.push(b,x,E)}this.setIndex(f),this.setAttribute("position",new Ie(p,3)),this.setAttribute("normal",new Ie(_,3)),this.setAttribute("uv",new Ie(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Bd(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}function ar(n,e,t){return Mw(n)?new n.constructor(n.subarray(e,void 0!==t?t:n.length)):n.slice(e,t)}function Aa(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)}function Mw(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}class Hm{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(void 0===r){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(i=2,s=a);for(let c=i-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(i===c)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0}}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class dJ extends Hm{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],c=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:s=e,a=2*t-i;break;case 2402:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(void 0===c)switch(this.getSettings_().endingEnd){case 2401:o=e,c=2*i-t;break;case 2402:o=1,c=i+r[1]-r[0];break;default:o=e-1,c=t}const l=.5*(i-t),u=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(c-i),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=this._offsetPrev,d=this._offsetNext,h=this._weightPrev,f=this._weightNext,p=(i-t)/(r-t),_=p*p,g=_*p,m=-h*g+2*h*_-h*p,y=(1+h)*g+(-1.5-2*h)*_+(-.5+h)*p+1,v=(-1-f)*g+(1.5+f)*_+.5*p,b=f*g-f*_;for(let x=0;x!==a;++x)s[x]=m*o[u+x]+y*o[l+x]+v*o[c+x]+b*o[d+x];return s}}class bL extends Hm{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=(i-t)/(r-t),d=1-u;for(let h=0;h!==a;++h)s[h]=o[l+h]*d+o[c+h]*u;return s}}class hJ extends Hm{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class is{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Aa(t,this.TimeBufferType),this.values=Aa(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Aa(e.times,Array),values:Aa(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new hJ(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new bL(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new dJ(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=ar(i,s,o),this.values=ar(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const c=i[a];if("number"==typeof c&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,c),e=!1;break}if(null!==o&&o>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,c,o),e=!1;break}o=c}if(void 0!==r&&Mw(r))for(let a=0,c=r.length;a!==c;++a){const l=r[a];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,l),e=!1;break}}return e}optimize(){const e=ar(this.times),t=ar(this.values),i=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let o=1;for(let a=1;a<s;++a){let c=!1;const l=e[a];if(l!==e[a+1]&&(1!==a||l!==e[0]))if(r)c=!0;else{const d=a*i,h=d-i,f=d+i;for(let p=0;p!==i;++p){const _=t[d+p];if(_!==t[h+p]||_!==t[f+p]){c=!0;break}}}if(c){if(a!==o){e[o]=e[a];const d=a*i,h=o*i;for(let f=0;f!==i;++f)t[h+f]=t[d+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,c=o*i,l=0;l!==i;++l)t[c+l]=t[a+l];++o}return o!==e.length?(this.times=ar(e,0,o),this.values=ar(t,0,o*i)):(this.times=e,this.values=t),this}clone(){const e=ar(this.times,0),t=ar(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}is.prototype.TimeBufferType=Float32Array,is.prototype.ValueBufferType=Float32Array,is.prototype.DefaultInterpolation=2301;class Ol extends is{}Ol.prototype.ValueTypeName="bool",Ol.prototype.ValueBufferType=Array,Ol.prototype.DefaultInterpolation=2300,Ol.prototype.InterpolantFactoryMethodLinear=void 0,Ol.prototype.InterpolantFactoryMethodSmooth=void 0;(class wL extends is{}).prototype.ValueTypeName="color";(class Gm extends is{}).prototype.ValueTypeName="number";class fJ extends Hm{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=(i-t)/(r-t);let l=e*a;for(let u=l+a;l!==u;l+=4)jn.slerpFlat(s,0,o,l-a,o,l,c);return s}}class Vd extends is{InterpolantFactoryMethodLinear(e){return new fJ(this.times,this.values,this.getValueSize(),e)}}Vd.prototype.ValueTypeName="quaternion",Vd.prototype.DefaultInterpolation=2301,Vd.prototype.InterpolantFactoryMethodSmooth=void 0;class Fl extends is{}Fl.prototype.ValueTypeName="string",Fl.prototype.ValueBufferType=Array,Fl.prototype.DefaultInterpolation=2300,Fl.prototype.InterpolantFactoryMethodLinear=void 0,Fl.prototype.InterpolantFactoryMethodSmooth=void 0;(class Wm extends is{}).prototype.ValueTypeName="vector";const Ws={enabled:!1,files:{},add:function(n,e){!1!==this.enabled&&(this.files[n]=e)},get:function(n){if(!1!==this.enabled)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class xL{constructor(e,t,i){const r=this;let c,s=!1,o=0,a=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(u){a++,!1===s&&void 0!==r.onStart&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,void 0!==r.onProgress&&r.onProgress(u,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(u){void 0!==r.onError&&r.onError(u)},this.resolveURL=function(u){return c?c(u):u},this.setURLModifier=function(u){return c=u,this},this.addHandler=function(u,d){return l.push(u,d),this},this.removeHandler=function(u){const d=l.indexOf(u);return-1!==d&&l.splice(d,2),this},this.getHandler=function(u){for(let d=0,h=l.length;d<h;d+=2){const f=l[d],p=l[d+1];if(f.global&&(f.lastIndex=0),f.test(u))return p}return null}}}const gJ=new xL;let ML=(()=>{class n{constructor(t){this.manager=void 0!==t?t:gJ,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,i){const r=this;return new Promise(function(s,o){r.load(t,s,i,o)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return n.DEFAULT_MATERIAL_NAME="__DEFAULT",n})();const js={};class _J extends Error{constructor(e,t){super(e),this.response=t}}class $s extends ML{constructor(e){super(e)}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Ws.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==js[e])return void js[e].push({onLoad:t,onProgress:i,onError:r});js[e]=[],js[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,c=this.responseType;fetch(o).then(l=>{if(200===l.status||0===l.status){if(0===l.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===l.body||void 0===l.body.getReader)return l;const u=js[e],d=l.body.getReader(),h=l.headers.get("Content-Length")||l.headers.get("X-File-Size"),f=h?parseInt(h):0,p=0!==f;let _=0;const g=new ReadableStream({start(m){!function y(){d.read().then(({done:v,value:b})=>{if(v)m.close();else{_+=b.byteLength;const x=new ProgressEvent("progress",{lengthComputable:p,loaded:_,total:f});for(let E=0,T=u.length;E<T;E++){const P=u[E];P.onProgress&&P.onProgress(x)}m.enqueue(b),y()}})}()}});return new Response(g)}throw new _J(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(c){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(u=>(new DOMParser).parseFromString(u,a));case"json":return l.json();default:if(void 0===a)return l.text();{const d=/charset="?([^;"\s]*)"?/i.exec(a),h=d&&d[1]?d[1].toLowerCase():void 0,f=new TextDecoder(h);return l.arrayBuffer().then(p=>f.decode(p))}}}).then(l=>{Ws.add(e,l);const u=js[e];delete js[e];for(let d=0,h=u.length;d<h;d++){const f=u[d];f.onLoad&&f.onLoad(l)}}).catch(l=>{const u=js[e];if(void 0===u)throw this.manager.itemError(e),l;delete js[e];for(let d=0,h=u.length;d<h;d++){const f=u[d];f.onError&&f.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class zd extends ML{constructor(e){super(e)}load(e,t,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Ws.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=gd("img");function c(){u(),Ws.add(e,this),t&&t(this),s.manager.itemEnd(e)}function l(d){u(),r&&r(d),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",c,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",c,!1),a.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}const Dw="\\[\\]\\.:\\/",FJ=new RegExp("["+Dw+"]","g"),Iw="[^"+Dw+"]",kJ="[^"+Dw.replace("\\.","")+"]",HJ=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",Iw)+/(WCOD+)?/.source.replace("WCOD",kJ)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Iw)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Iw)+"$"),GJ=["material","materials","bones","map"];class WJ{constructor(e,t,i){const r=i||Vt.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let Vt=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(FJ,"")}static parseTrackName(t){const i=HJ.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==GJ.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const c=o[a];if(c.name===i||c.uuid===i)return c;const l=r(c.children);if(l)return l}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[i++]=r[s]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,s=i.propertyName;let o=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(r){let u=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let d=0;d<t.length;d++)if(t[d].name===u){u=d;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==u){if(void 0===t[u])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[u]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+s+" but it wasn't found.",t);let c=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?c=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}l=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(l=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=WJ,n})();Vt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Vt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Vt.prototype.GetterByBindingType=[Vt.prototype._getValue_direct,Vt.prototype._getValue_array,Vt.prototype._getValue_arrayElement,Vt.prototype._getValue_toArray],Vt.prototype.SetterByBindingTypeAndVersioning=[[Vt.prototype._setValue_direct,Vt.prototype._setValue_direct_setNeedsUpdate,Vt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Vt.prototype._setValue_array,Vt.prototype._setValue_array_setNeedsUpdate,Vt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Vt.prototype._setValue_arrayElement,Vt.prototype._setValue_arrayElement_setNeedsUpdate,Vt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Vt.prototype._setValue_fromArray,Vt.prototype._setValue_fromArray_setNeedsUpdate,Vt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class XJ{constructor(e,t,i=0,r=1/0){this.ray=new bd(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new Cb,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return Rw(e,this,i,t),i.sort(kL),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)Rw(e[r],this,i,t);return i.sort(kL),i}}function kL(n,e){return n.distance-e.distance}function Rw(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),!0===i){const r=n.children;for(let s=0,o=r.length;s<o;s++)Rw(r[s],e,t,!0)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"156"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="156");var ZJ=Object.defineProperty,Nw=(n,e)=>{for(var t in e)ZJ(n,t,{get:e[t],enumerable:!0})};Nw({},{ACTIONS:()=>eN,ANIMATION_MIN_DURATION:()=>XL,CAPTURE_EVENTS_CLASS:()=>Wd,CTRLZOOM_TIMEOUT:()=>QL,DBLCLICK_DELAY:()=>ZL,DEFAULT_TRANSITION:()=>qL,EASINGS:()=>Qm,ICONS:()=>Ir,IDS:()=>qn,INERTIA_WINDOW:()=>Ow,KEY_CODES:()=>Vn,LONGTOUCH_DELAY:()=>KL,MOVE_THRESHOLD:()=>YL,SPHERE_RADIUS:()=>Gd,TWOFINGERSOVERLAY_DELAY:()=>JL,VIEWER_DATA:()=>Ao});var qL=1500,XL=500,YL=4,ZL=300,KL=500,JL=100,QL=2e3,Ow=300,Gd=10,Ao="photoSphereViewer",Wd="psv--capture-event",eN=(n=>(n.ROTATE_UP="ROTATE_UP",n.ROTATE_DOWN="ROTATE_DOWN",n.ROTATE_RIGHT="ROTATE_RIGHT",n.ROTATE_LEFT="ROTATE_LEFT",n.ZOOM_IN="ZOOM_IN",n.ZOOM_OUT="ZOOM_OUT",n))(eN||{}),qn={MENU:"menu",TWO_FINGERS:"twoFingers",CTRL_ZOOM:"ctrlZoom",ERROR:"error",DESCRIPTION:"description"},Vn={Enter:"Enter",Control:"Control",Escape:"Escape",Space:" ",PageUp:"PageUp",PageDown:"PageDown",ArrowLeft:"ArrowLeft",ArrowUp:"ArrowUp",ArrowRight:"ArrowRight",ArrowDown:"ArrowDown",Delete:"Delete",Plus:"+",Minus:"-"},Ir={arrow:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="40 40 432 432"><g transform="rotate(0, 256, 256)"><path fill="currentColor" d="M425.23 210.55H227.39a5 5 0 01-3.53-8.53l56.56-56.57a45.5 45.5 0 000-64.28 45.15 45.15 0 00-32.13-13.3 45.15 45.15 0 00-32.14 13.3L41.32 256l174.83 174.83a45.15 45.15 0 0032.14 13.3 45.15 45.15 0 0032.13-13.3 45.5 45.5 0 000-64.28l-56.57-56.57a5 5 0 013.54-8.53h197.84c25.06 0 45.45-20.39 45.45-45.45s-20.4-45.45-45.45-45.45z"/></g>\x3c!-- Created by Flatart from the Noun Project --\x3e</svg>\n',close:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><g fill="currentColor" transform=" translate(50, 50) rotate(45)"><rect x="-5" y="-65" width="10" height="130"/><rect x="-65" y="-5" width="130" height="10"/></g></svg>',download:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M83.3 35.6h-17V3H32.2v32.6H16.6l33.6 32.7 33-32.7z"/><path fill="currentColor" d="M83.3 64.2v16.3H16.6V64.2H-.1v32.6H100V64.2H83.3z"/>\x3c!--Created by Michael Zenaty from the Noun Project--\x3e</svg>\n',fullscreenIn:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M100 40H87.1V18.8h-21V6H100zM100 93.2H66V80.3h21.1v-21H100zM34 93.2H0v-34h12.9v21.1h21zM12.9 40H0V6h34v12.9H12.8z"/>\x3c!--Created by Garrett Knoll from the Noun Project--\x3e</svg>\n',fullscreenOut:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M66 7h13v21h21v13H66zM66 60.3h34v12.9H79v21H66zM0 60.3h34v34H21V73.1H0zM21 7h13v34H0V28h21z"/>\x3c!--Created by Garrett Knoll from the Noun Project--\x3e</svg>\n',info:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><path fill="currentColor" d="M28.3 26.1c-1 2.6-1.9 4.8-2.6 7-2.5 7.4-5 14.7-7.2 22-1.3 4.4.5 7.2 4.3 7.8 1.3.2 2.8.2 4.2-.1 8.2-2 11.9-8.6 15.7-15.2l-2.2 2a18.8 18.8 0 0 1-7.4 5.2 2 2 0 0 1-1.6-.2c-.2-.1 0-1 0-1.4l.8-1.8L41.9 28c.5-1.4.9-3 .7-4.4-.2-2.6-3-4.4-6.3-4.4-8.8.2-15 4.5-19.5 11.8-.2.3-.2.6-.3 1.3 3.7-2.8 6.8-6.1 11.8-6.2z"/><circle fill="currentColor" cx="39.3" cy="9.2" r="8.2"/>\x3c!--Created by Arafat Uddin from the Noun Project--\x3e</svg>\n',menu:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 10 80 80"><g fill="currentColor"><circle r="10" cx="20" cy="20"/><circle r="10" cx="50" cy="20"/><circle r="10" cx="80" cy="20"/><circle r="10" cx="20" cy="50"/><circle r="10" cx="50" cy="50"/><circle r="10" cx="80" cy="50"/><circle r="10" cx="20" cy="80"/><circle r="10" cx="50" cy="80"/><circle r="10" cx="80" cy="80"/></g>\x3c!-- Created by Richard Kun\xe1k from the Noun Project--\x3e</svg>\n',zoomIn:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M8.728 4.009H6.744v2.737H4.006V8.73h2.738v2.736h1.984V8.73h2.737V6.746H8.728z"/>\x3c!--Created by Ryan Canning from the Noun Project--\x3e</svg>\n',zoomOut:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M4.006 6.746h7.459V8.73H4.006z"/>\x3c!--Created by Ryan Canning from the Noun Project--\x3e</svg>\n'},Qm={linear:n=>n,inQuad:n=>n*n,outQuad:n=>n*(2-n),inOutQuad:n=>n<.5?2*n*n:(4-2*n)*n-1,inCubic:n=>n*n*n,outCubic:n=>--n*n*n+1,inOutCubic:n=>n<.5?4*n*n*n:(n-1)*(2*n-2)*(2*n-2)+1,inQuart:n=>n*n*n*n,outQuart:n=>1- --n*n*n*n,inOutQuart:n=>n<.5?8*n*n*n*n:1-8*--n*n*n*n,inQuint:n=>n*n*n*n*n,outQuint:n=>1+--n*n*n*n*n,inOutQuint:n=>n<.5?16*n*n*n*n*n:1+16*--n*n*n*n*n,inSine:n=>1-Math.cos(n*(Math.PI/2)),outSine:n=>Math.sin(n*(Math.PI/2)),inOutSine:n=>.5-.5*Math.cos(Math.PI*n),inExpo:n=>Math.pow(2,10*(n-1)),outExpo:n=>1-Math.pow(2,-10*n),inOutExpo:n=>(n=2*n-1)<0?.5*Math.pow(2,10*n):1-.5*Math.pow(2,-10*n),inCirc:n=>1-Math.sqrt(1-n*n),outCirc:n=>Math.sqrt(1-(n-1)*(n-1)),inOutCirc:n=>(n*=2)<1?.5-.5*Math.sqrt(1-n*n):.5+.5*Math.sqrt(1-(n-=2)*n)},Na={};function jd(n,e){let t=n%e;return t<0&&(t+=e),t}function aQ(n){return n.reduce((e,t)=>e+t,0)}function Fw(n,e){return Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2))}function tN(n,e){return Math.atan2(e.y-n.y,e.x-n.x)}function nN(n,e){return[0,2*Math.PI,2*-Math.PI].reduce((i,r)=>{const s=e-n+r;return Math.abs(s)<Math.abs(i)?s:i},1/0)}function iN(n,e){return Math.acos(Math.cos(n.pitch)*Math.cos(e.pitch)*Math.cos(n.yaw-e.yaw)+Math.sin(n.pitch)*Math.sin(e.pitch))}function cQ([n,e],[t,i]){const r=(t-n)*Math.cos((e+i)/2),s=i-e;return Math.sqrt(r*r+s*s)}function rN(n){return"string"==typeof n?n.match(/^[a-z]/i)?document.getElementById(n):document.querySelector(n):n}function eg(n,e,t){void 0===t?n.classList.toggle(e):t?n.classList.add(e):t||n.classList.remove(e)}function kw(n,e){n.classList.add(...e.split(" "))}function lQ(n,e){n.classList.remove(...e.split(" "))}function sN(n,e){let t=n;do{if(t===e)return!0;t=t.parentElement}while(t);return!1}function Uw(n,e){if(!n?.matches)return null;let t=n;do{if(t.matches(e))return t;t=t.parentElement}while(t);return null}function oN(n){let e=0,t=0,i=n;for(;i;)e+=i.offsetLeft-i.scrollLeft+i.clientLeft,t+=i.offsetTop-i.scrollTop+i.clientTop,i=i.offsetParent;return{x:e,y:t}}function Do(n,e){return window.getComputedStyle(n,null)[e]}function Bw(n){if(n.touches.length<2)return null;const e={x:n.touches[0].clientX,y:n.touches[0].clientY},t={x:n.touches[1].clientX,y:n.touches[1].clientY};return{distance:Fw(e,t),angle:tN(e,t),center:{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}}function aN(n){return(document.fullscreenElement||document.webkitFullscreenElement)===n}function cN(n){(n.requestFullscreen||n.webkitRequestFullscreen).call(n)}function lN(){(document.exitFullscreen||document.webkitExitFullscreen).call(document)}function uQ(n){return n.replace(/[A-Z](?:(?=[^A-Z])|[A-Z]*(?=[A-Z][^A-Z]|$))/g,(e,t)=>(t>0?"-":"")+e.toLowerCase())}function Vw(n,e){let t=!1;return function(...i){t||(t=!0,setTimeout(()=>{n.apply(this,i),t=!1},e))}}function zw(n){if("object"!=typeof n||null===n||"[object Object]"!==Object.prototype.toString.call(n))return!1;if(null===Object.getPrototypeOf(n))return!0;let e=n;for(;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(n)===e}function uN(n,e){const t=e;return function i(r,s){return Array.isArray(s)?(r&&Array.isArray(r)?r.length=0:r=[],s.forEach((o,a)=>{r[a]=i(null,o)})):"object"==typeof s?((!r||Array.isArray(r))&&(r={}),Object.keys(s).forEach(o=>{"object"==typeof s[o]&&s[o]&&zw(s[o])?s[o]!==t&&(r[o]?i(r[o],s[o]):r[o]=i(null,s[o])):r[o]=s[o]})):r=s,r}(n,e)}function $d(n){return uN(null,n)}function dN(n){return!n||0===Object.keys(n).length&&n.constructor===Object}function Rr(n){return null==n}function rs(...n){for(const e of n)if(!Rr(e))return e;return null}function hN(n,e){if(n===e)return!0;if(fN(n)&&fN(e)){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t of Object.keys(n))if(!hN(n[t],e[t]))return!1;return!0}return!1}function fN(n){return"object"==typeof n&&null!==n}Nw(Na,{Animation:()=>qd,Dynamic:()=>og,MultiDynamic:()=>wN,PressHandler:()=>ag,Slider:()=>MN,SliderDirection:()=>xN,addClasses:()=>kw,angle:()=>tN,applyEulerInverse:()=>qw,checkStylesheet:()=>bN,cleanCssPosition:()=>_N,clone:()=>$d,createTexture:()=>$w,cssPositionIsOrdered:()=>Ww,dasherize:()=>uQ,deepEqual:()=>hN,deepmerge:()=>uN,distance:()=>Fw,exitFullscreen:()=>lN,firstNonNull:()=>rs,getAbortError:()=>Gw,getAngle:()=>iN,getClosest:()=>Uw,getConfigParser:()=>sg,getElement:()=>rN,getPosition:()=>oN,getShortestArc:()=>nN,getStyle:()=>Do,getTouchData:()=>Bw,getXMPValue:()=>ss,greatArcDistance:()=>cQ,hasParent:()=>sN,invertResolvableBoolean:()=>tg,isAbortError:()=>pN,isEmpty:()=>dN,isExtendedPosition:()=>ng,isFullscreenEnabled:()=>aN,isNil:()=>Rr,isPlainObject:()=>zw,logWarn:()=>Yt,parseAngle:()=>Io,parsePoint:()=>dQ,parseSpeed:()=>vN,removeClasses:()=>lQ,requestFullscreen:()=>cN,resolveBoolean:()=>Hw,speedToDuration:()=>jw,sum:()=>aQ,throttle:()=>Vw,toggleClass:()=>eg,wrap:()=>jd});var Pt=class D2 extends Error{constructor(e){super(e),this.name="PSVError",Error.captureStackTrace?.(this,D2)}};function Hw(n,e){zw(n)?(e(n.initial,!0),n.promise.then(t=>e(t,!1))):e(n,!0)}function tg(n){return{initial:!n.initial,promise:n.promise.then(e=>!e)}}function Gw(){const n=new Error("Loading was aborted.");return n.name="AbortError",n}function pN(n){return"AbortError"===n?.name}function Yt(n){console.warn(`PhotoSphereViewer: ${n}`)}function ng(n){return!!n&&[["textureX","textureY"],["yaw","pitch"]].some(([e,t])=>void 0!==n[e]&&void 0!==n[t])}function ss(n,e){let t=n.match("<GPano:"+e+">(.*)</GPano:"+e+">");if(null!==t){const i=parseInt(t[1],10);return isNaN(i)?null:i}if(t=n.match("GPano:"+e+'="(.*?)"'),null!==t){const i=parseInt(t[1],10);return isNaN(i)?null:i}return null}var mN={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},ig=["left","center","right"],rg=["top","center","bottom"],gN=[...ig,...rg],cr="center";function dQ(n){if(!n)return{x:.5,y:.5};if("object"==typeof n)return n;let e=n.toLocaleLowerCase().split(" ").slice(0,2);1===e.length&&(e=mN[e[0]]?[e[0],cr]:[e[0],e[0]]);const t="left"!==e[1]&&"right"!==e[1]&&"top"!==e[0]&&"bottom"!==e[0];e=e.map(r=>mN[r]||r),t||e.reverse();const i=e.join(" ").match(/^([0-9.]+)% ([0-9.]+)%$/);return i?{x:parseFloat(i[1])/100,y:parseFloat(i[2])/100}:{x:.5,y:.5}}function _N(n,{allowCenter:e,cssOrder:t}={allowCenter:!0,cssOrder:!0}){return n?("string"==typeof n&&(n=n.split(" ")),1===n.length&&(n[0]===cr?n=[cr,cr]:-1!==ig.indexOf(n[0])?n=[cr,n[0]]:-1!==rg.indexOf(n[0])&&(n=[n[0],cr])),2!==n.length||-1===gN.indexOf(n[0])||-1===gN.indexOf(n[1])?(Yt(`Unparsable position ${n}`),null):e||n[0]!==cr||n[1]!==cr?(t&&!Ww(n)&&(n=[n[1],n[0]]),n[1]===cr&&-1!==ig.indexOf(n[0])&&(n=[cr,n[0]]),n[0]===cr&&-1!==rg.indexOf(n[1])&&(n=[n[1],cr]),n):(Yt("Invalid position center center"),null)):null}function Ww(n){return-1!==rg.indexOf(n[0])&&-1!==ig.indexOf(n[1])}function vN(n){let e;if("string"==typeof n){const t=n.toString().trim();let i=parseFloat(t.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1"));const r=t.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();switch(r.match(/(pm|per minute)$/)&&(i/=60),r){case"dpm":case"degrees per minute":case"dps":case"degrees per second":e=qt.degToRad(i);break;case"rdpm":case"radians per minute":case"rdps":case"radians per second":e=i;break;case"rpm":case"revolutions per minute":case"rps":case"revolutions per second":e=i*Math.PI*2;break;default:throw new Pt(`Unknown speed unit "${r}"`)}}else e=n;return e}function jw(n,e){if("number"!=typeof n){const t=vN(n);return e/Math.abs(t)*1e3}return Math.abs(n)}function Io(n,e=!1,t=e){let i;if("string"==typeof n){const r=n.toLowerCase().trim().match(/^(-?[0-9]+(?:\.[0-9]*)?)(.*)$/);if(!r)throw new Pt(`Unknown angle "${n}"`);const s=parseFloat(r[1]),o=r[2];if(o)switch(o){case"deg":case"degs":i=qt.degToRad(s);break;case"rad":case"rads":i=s;break;default:throw new Pt(`Unknown angle unit "${o}"`)}else i=s}else{if("number"!=typeof n||isNaN(n))throw new Pt(`Unknown angle "${n}"`);i=n}return i=jd(e?i+Math.PI:i,2*Math.PI),e?qt.clamp(i-Math.PI,-Math.PI/(t?2:1),Math.PI/(t?2:1)):i}function $w(n,e=!1){const t=new Ls(n);return t.needsUpdate=!0,t.minFilter=e?yo:cn,t.generateMipmaps=e,t.anisotropy=e?2:1,t}var yN=new jn;function qw(n,e){yN.setFromEuler(e).invert(),n.applyQuaternion(yN)}function sg(n,e){const t=function(i){if(!i)return $d(n);const r=$d({...n,...i}),s={};for(let[o,a]of Object.entries(r)){if(e&&o in e)a=e[o](a,{rawConfig:r,defValue:n[o]});else if(!(o in n)){Yt(`Unknown option ${o}`);continue}s[o]=a}return s};return t.defaults=n,t.parsers=e||{},t}function bN(n,e){"true"!==window.getComputedStyle(n).getPropertyValue(`--psv-${e}-loaded`)&&console.error(`PhotoSphereViewer: stylesheet "@photo-sphere-viewer/${e}/index.css" is not loaded`)}var qd=class{constructor(n){this.easing=Qm.linear,this.callbacks=[],this.resolved=!1,this.cancelled=!1,this.options=n,n?(n.easing&&(this.easing="function"==typeof n.easing?n.easing:Qm[n.easing]||Qm.linear),this.delayTimeout=setTimeout(()=>{this.delayTimeout=void 0,this.animationFrame=window.requestAnimationFrame(e=>this.__run(e))},n.delay||0)):this.resolved=!0}__run(n){if(this.cancelled)return;this.start||(this.start=n);const e=(n-this.start)/this.options.duration,t={};if(e<1){for(const[i,r]of Object.entries(this.options.properties))if(r){const s=r.start+(r.end-r.start)*this.easing(e);t[i]=s}this.options.onTick(t,e),this.animationFrame=window.requestAnimationFrame(i=>this.__run(i))}else{for(const[i,r]of Object.entries(this.options.properties))r&&(t[i]=r.end);this.options.onTick(t,1),this.__resolve(!0),this.animationFrame=void 0}}__resolve(n){n?this.resolved=!0:this.cancelled=!0,this.callbacks.forEach(e=>e(n)),this.callbacks.length=0}then(n){return this.resolved||this.cancelled?Promise.resolve(this.resolved).then(n):new Promise(e=>{this.callbacks.push(e)}).then(n)}cancel(){!this.cancelled&&!this.resolved&&(this.__resolve(!1),this.delayTimeout&&(window.clearTimeout(this.delayTimeout),this.delayTimeout=void 0),this.animationFrame&&(window.cancelAnimationFrame(this.animationFrame),this.animationFrame=void 0))}},og=class{constructor(n,e){if(this.fn=n,this.mode=0,this.speed=0,this.speedMult=0,this.currentSpeed=0,this.target=0,this.__current=0,this.min=e.min,this.max=e.max,this.wrap=e.wrap,this.current=e.defaultValue,this.wrap&&0!==this.min)throw new Pt("invalid config");this.fn&&this.fn(this.current)}get current(){return this.__current}set current(n){this.__current=n}setSpeed(n){this.speed=n}goto(n,e=1){this.mode=2,this.target=this.wrap?jd(n,this.max):qt.clamp(n,this.min,this.max),this.speedMult=e}step(n,e=1){0===e?this.setValue(this.current+n):(2!==this.mode&&(this.target=this.current),this.goto(this.target+n,e))}roll(n=!1,e=1){this.mode=1,this.target=n?-1/0:1/0,this.speedMult=e}stop(){this.mode=0}setValue(n){return this.target=this.wrap?jd(n,this.max):qt.clamp(n,this.min,this.max),this.mode=0,this.currentSpeed=0,this.target!==this.current&&(this.current=this.target,this.fn&&this.fn(this.current),!0)}update(n){if(2===this.mode){this.wrap&&Math.abs(this.target-this.current)>this.max/2&&(this.current=this.current<this.target?this.current+this.max:this.current-this.max);const i=this.currentSpeed*this.currentSpeed/(this.speed*this.speedMult*4);Math.abs(this.target-this.current)<=i&&(this.mode=0)}let e=0===this.mode?0:this.speed*this.speedMult;this.target<this.current&&(e=-e),this.currentSpeed<e?this.currentSpeed=Math.min(e,this.currentSpeed+n/1e3*this.speed*this.speedMult*2):this.currentSpeed>e&&(this.currentSpeed=Math.max(e,this.currentSpeed-n/1e3*this.speed*this.speedMult*2));let t=null;return this.current>this.target&&this.currentSpeed?t=Math.max(this.target,this.current+this.currentSpeed*n/1e3):this.current<this.target&&this.currentSpeed&&(t=Math.min(this.target,this.current+this.currentSpeed*n/1e3)),null!==t&&(t=this.wrap?jd(t,this.max):qt.clamp(t,this.min,this.max),t!==this.current)&&(this.current=t,this.fn&&this.fn(this.current),!0)}},wN=class{constructor(n,e){this.fn=n,this.dynamics=e,this.fn&&this.fn(this.current)}get current(){return Object.entries(this.dynamics).reduce((n,[e,t])=>(n[e]=t.current,n),{})}setSpeed(n){for(const e of Object.values(this.dynamics))e.setSpeed(n)}goto(n,e=1){for(const[t,i]of Object.entries(n))this.dynamics[t].goto(i,e)}step(n,e=1){if(0===e)this.setValue(Object.keys(n).reduce((t,i)=>(t[i]=n[i]+this.dynamics[i].current,t),{}));else for(const[t,i]of Object.entries(n))this.dynamics[t].step(i,e)}roll(n,e=1){for(const[t,i]of Object.entries(n))this.dynamics[t].roll(i,e)}stop(){for(const n of Object.values(this.dynamics))n.stop()}setValue(n){let e=!1;for(const[t,i]of Object.entries(n))e=this.dynamics[t].setValue(i)||e;return e&&this.fn&&this.fn(this.current),e}update(n){let e=!1;for(const t of Object.values(this.dynamics))e=t.update(n)||e;return e&&this.fn&&this.fn(this.current),e}},ag=class{constructor(n=200){this.delay=n,this.time=0,this.delay=n}get pending(){return 0!==this.time}down(){this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.time=(new Date).getTime()}up(n){this.time&&(Date.now()-this.time<this.delay?this.timeout=setTimeout(()=>{n(),this.timeout=void 0,this.time=0},this.delay):(n(),this.time=0))}},xN=(n=>(n.VERTICAL="VERTICAL",n.HORIZONTAL="HORIZONTAL",n))(xN||{}),MN=class{constructor(n,e,t){this.container=n,this.direction=e,this.listener=t,this.mousedown=!1,this.mouseover=!1,this.container.addEventListener("click",this),this.container.addEventListener("mousedown",this),this.container.addEventListener("mouseenter",this),this.container.addEventListener("mouseleave",this),this.container.addEventListener("touchstart",this),this.container.addEventListener("mousemove",this,!0),this.container.addEventListener("touchmove",this,!0),window.addEventListener("mouseup",this),window.addEventListener("touchend",this)}get isVertical(){return"VERTICAL"===this.direction}get isHorizontal(){return"HORIZONTAL"===this.direction}destroy(){window.removeEventListener("mouseup",this),window.removeEventListener("touchend",this)}handleEvent(n){switch(n.type){case"click":n.stopPropagation();break;case"mousedown":this.__onMouseDown(n);break;case"mouseenter":this.__onMouseEnter(n);break;case"mouseleave":this.__onMouseLeave(n);break;case"touchstart":this.__onTouchStart(n);break;case"mousemove":this.__onMouseMove(n);break;case"touchmove":this.__onTouchMove(n);break;case"mouseup":this.__onMouseUp(n);break;case"touchend":this.__onTouchEnd(n)}}__onMouseDown(n){this.mousedown=!0,this.__update(n.clientX,n.clientY,!0)}__onMouseEnter(n){this.mouseover=!0,this.__update(n.clientX,n.clientY,!0)}__onTouchStart(n){this.mouseover=!0,this.mousedown=!0;const e=n.changedTouches[0];this.__update(e.clientX,e.clientY,!0)}__onMouseMove(n){(this.mousedown||this.mouseover)&&(n.stopPropagation(),this.__update(n.clientX,n.clientY,!0))}__onTouchMove(n){if(this.mousedown||this.mouseover){n.stopPropagation();const e=n.changedTouches[0];this.__update(e.clientX,e.clientY,!0)}}__onMouseUp(n){this.mousedown&&(this.mousedown=!1,this.__update(n.clientX,n.clientY,!1))}__onMouseLeave(n){this.mouseover&&(this.mouseover=!1,this.__update(n.clientX,n.clientY,!0))}__onTouchEnd(n){if(this.mousedown){this.mouseover=!1,this.mousedown=!1;const e=n.changedTouches[0];this.__update(e.clientX,e.clientY,!1)}}__update(n,e,t){const i=this.container.getBoundingClientRect(),a=Math.abs((i[this.isVertical?"bottom":"left"]-(this.isVertical?e:n))/i[this.isVertical?"height":"width"]);this.listener({value:a,click:!t,mousedown:this.mousedown,mouseover:this.mouseover,cursor:{clientX:n,clientY:e}})}},os={};Nw(os,{BeforeAnimateEvent:()=>Xw,BeforeRenderEvent:()=>AN,BeforeRotateEvent:()=>IN,ClickEvent:()=>PN,ConfigChangedEvent:()=>Di,DoubleClickEvent:()=>ON,FullscreenEvent:()=>Xd,HideNotificationEvent:()=>Yd,HideOverlayEvent:()=>BN,HidePanelEvent:()=>Ro,HideTooltipEvent:()=>HN,KeypressEvent:()=>Po,LoadProgressEvent:()=>jN,ObjectEnterEvent:()=>uO,ObjectEvent:()=>cg,ObjectHoverEvent:()=>fO,ObjectLeaveEvent:()=>Zw,PanoramaErrorEvent:()=>XN,PanoramaLoadedEvent:()=>Yw,PositionUpdatedEvent:()=>Zd,ReadyEvent:()=>Kd,RenderEvent:()=>JN,ShowNotificationEvent:()=>Jd,ShowOverlayEvent:()=>tO,ShowPanelEvent:()=>Lo,ShowTooltipEvent:()=>rO,SizeUpdatedEvent:()=>Qd,StopAllEvent:()=>aO,ViewerEvent:()=>Lt,ZoomUpdatedEvent:()=>qs});var EN=class extends Event{constructor(n,e=!1){super(n,{cancelable:e})}},SN=class extends EventTarget{dispatchEvent(n){return super.dispatchEvent(n)}addEventListener(n,e,t){super.addEventListener(n,e,t)}removeEventListener(n,e,t){super.removeEventListener(n,e,t)}},Lt=class extends EN{},TN=class I2 extends Lt{constructor(e,t){super(I2.type,!0),this.position=e,this.zoomLevel=t}};TN.type="before-animate";var Xw=TN,CN=class R2 extends Lt{constructor(e,t){super(R2.type),this.timestamp=e,this.elapsed=t}};CN.type="before-render";var AN=CN,DN=class P2 extends Lt{constructor(e){super(P2.type,!0),this.position=e}};DN.type="before-rotate";var IN=DN,RN=class L2 extends Lt{constructor(e){super(L2.type),this.data=e}};RN.type="click";var PN=RN,LN=class N2 extends Lt{constructor(e){super(N2.type),this.options=e}containsOptions(...e){return e.some(t=>this.options.includes(t))}};LN.type="config-changed";var Di=LN,NN=class O2 extends Lt{constructor(e){super(O2.type),this.data=e}};NN.type="dblclick";var ON=NN,FN=class F2 extends Lt{constructor(e){super(F2.type),this.fullscreenEnabled=e}};FN.type="fullscreen";var Xd=FN,kN=class k2 extends Lt{constructor(e){super(k2.type),this.notificationId=e}};kN.type="hide-notification";var Yd=kN,UN=class U2 extends Lt{constructor(e){super(U2.type),this.overlayId=e}};UN.type="hide-overlay";var BN=UN,VN=class B2 extends Lt{constructor(e){super(B2.type),this.panelId=e}};VN.type="hide-panel";var Ro=VN,zN=class V2 extends Lt{constructor(e){super(V2.type),this.tooltipData=e}};zN.type="hide-tooltip";var HN=zN,GN=class z2 extends Lt{constructor(e){super(z2.type,!0),this.key=e}};GN.type="key-press";var Po=GN,WN=class H2 extends Lt{constructor(e){super(H2.type),this.progress=e}};WN.type="load-progress";var jN=WN,$N=class G2 extends Lt{constructor(e){super(G2.type),this.data=e}};$N.type="panorama-loaded";var Yw=$N,qN=class W2 extends Lt{constructor(e,t){super(W2.type),this.panorama=e,this.error=t}};qN.type="panorama-error";var XN=qN,YN=class j2 extends Lt{constructor(e){super(j2.type),this.position=e}};YN.type="position-updated";var Zd=YN,ZN=class $2 extends Lt{constructor(){super($2.type)}};ZN.type="ready";var Kd=ZN,KN=class q2 extends Lt{constructor(){super(q2.type)}};KN.type="render";var JN=KN,QN=class X2 extends Lt{constructor(e){super(X2.type),this.notificationId=e}};QN.type="show-notification";var Jd=QN,eO=class Y2 extends Lt{constructor(e){super(Y2.type),this.overlayId=e}};eO.type="show-overlay";var tO=eO,nO=class Z2 extends Lt{constructor(e){super(Z2.type),this.panelId=e}};nO.type="show-panel";var Lo=nO,iO=class K2 extends Lt{constructor(e,t){super(K2.type),this.tooltip=e,this.tooltipData=t}};iO.type="show-tooltip";var rO=iO,sO=class J2 extends Lt{constructor(e){super(J2.type),this.size=e}};sO.type="size-updated";var Qd=sO,oO=class Q2 extends Lt{constructor(){super(Q2.type)}};oO.type="stop-all";var aO=oO,cO=class ek extends Lt{constructor(e){super(ek.type),this.zoomLevel=e}};cO.type="zoom-updated";var qs=cO,cg=class extends Lt{constructor(n,e,t,i,r){super(n),this.originalEvent=e,this.object=t,this.viewerPoint=i,this.userDataKey=r}},lO=class tk extends cg{constructor(e,t,i,r){super(tk.type,e,t,i,r)}};lO.type="enter-object";var uO=lO,dO=class nk extends cg{constructor(e,t,i,r){super(nk.type,e,t,i,r)}};dO.type="leave-object";var Zw=dO,hO=class ik extends cg{constructor(e,t,i,r){super(ik.type,e,t,i,r)}};hO.type="hover-object";var fO=hO,lg=class Zi{constructor(e){this.viewer=e}init(){}destroy(){}supportsTransition(e){return!1}supportsPreload(e){return!1}static createOverlayMaterial({additionalUniforms:e,overrideVertexShader:t}={}){return new Hs({uniforms:{...e,[Zi.OVERLAY_UNIFORMS.panorama]:{value:null},[Zi.OVERLAY_UNIFORMS.overlay]:{value:null},[Zi.OVERLAY_UNIFORMS.globalOpacity]:{value:1},[Zi.OVERLAY_UNIFORMS.overlayOpacity]:{value:0}},vertexShader:t||"\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix *  modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:`\nuniform sampler2D ${Zi.OVERLAY_UNIFORMS.panorama};\nuniform sampler2D ${Zi.OVERLAY_UNIFORMS.overlay};\nuniform float ${Zi.OVERLAY_UNIFORMS.globalOpacity};\nuniform float ${Zi.OVERLAY_UNIFORMS.overlayOpacity};\n\nvarying vec2 vUv;\n\nvoid main() {\n  vec4 tColor1 = texture2D( ${Zi.OVERLAY_UNIFORMS.panorama}, vUv );\n  vec4 tColor2 = texture2D( ${Zi.OVERLAY_UNIFORMS.overlay}, vUv );\n  gl_FragColor = vec4(\n    mix( tColor1.rgb, tColor2.rgb, tColor2.a * ${Zi.OVERLAY_UNIFORMS.overlayOpacity} ),\n    ${Zi.OVERLAY_UNIFORMS.globalOpacity}\n  );\n}`})}};lg.supportsDownload=!1,lg.supportsOverlay=!1,lg.OVERLAY_UNIFORMS={panorama:"panorama",overlay:"overlay",globalOpacity:"globalOpacity",overlayOpacity:"overlayOpacity"};var No=lg;function pO(n){if(n)for(const[,e]of[["_",n],...Object.entries(n)])if(e.prototype instanceof No)return e;return null}var eh=`${Ao}_touchSupport`,Xn={loaded:!1,pixelRatio:1,isWebGLSupported:!1,maxTextureWidth:0,isTouchEnabled:null,fullscreenEvent:null,__maxCanvasWidth:null,get maxCanvasWidth(){return null===this.__maxCanvasWidth&&(this.__maxCanvasWidth=function pQ(n){const e=document.createElement("canvas"),t=e.getContext("2d");for(e.width=n,e.height=n/2;e.width>1024;){t.fillStyle="white",t.fillRect(0,0,1,1);try{if(t.getImageData(0,0,1,1).data[0]>0)return e.width}catch{}e.width/=2,e.height/=2}throw new Pt("Unable to detect system capabilities")}(this.maxTextureWidth)),this.__maxCanvasWidth},load(){if(!this.loaded){const n=function hQ(){const n=document.createElement("canvas");let t=null;return n.getContext&&["webgl2","webgl","experimental-webgl","moz-webgl","webkit-3d"].some(i=>{try{return t=n.getContext(i),null!==t}catch{return!1}})?t:null}();this.pixelRatio=window.devicePixelRatio||1,this.isWebGLSupported=null!==n,this.maxTextureWidth=n?n.getParameter(n.MAX_TEXTURE_SIZE):0,this.isTouchEnabled=function fQ(){let n="ontouchstart"in window||navigator.maxTouchPoints>0;eh in localStorage&&(n="true"===localStorage[eh]);const e=new Promise(t=>{const i=()=>{window.removeEventListener("mousedown",r),window.removeEventListener("touchstart",s),clearTimeout(a)},r=()=>{i(),localStorage[eh]=!1,t(!1)},s=()=>{i(),localStorage[eh]=!0,t(!0)};window.addEventListener("mousedown",r,!1),window.addEventListener("touchstart",s,!1);const a=setTimeout(()=>{i(),localStorage[eh]=n,t(n)},1e4)});return{initial:n,promise:e}}(),this.fullscreenEvent=function mQ(){return"exitFullscreen"in document?"fullscreenchange":"webkitExitFullscreen"in document?"webkitfullscreenchange":null}(),this.loaded=!0}if(!Xn.isWebGLSupported)throw new Pt("WebGL is not supported.");if(0===Xn.maxTextureWidth)throw new Pt("Unable to detect system capabilities")}},_Q=URL.createObjectURL(new Blob(["(",function gQ(){function e(s){return`rgb(${s.r}, ${s.g}, ${s.b})`}function t(s,o){return{r:Math.round(s.r/2+o.r/2),g:Math.round(s.g/2+o.g/2),b:Math.round(s.b/2+o.b/2)}}function i(s,o,a,c,l){const u=s.createLinearGradient(o,0,a,0);return u.addColorStop(0,e(c)),u.addColorStop(1,e(l)),u}function r(s,o,a,c,l,u){u=Math.round(u);let d=0,h=0,f=0,p=0;const _=s.getImageData(o,a,c,l);for(let g=0;g<l;g+=u)for(let m=0;m<c;m+=u){const y=4*(g*c+m);d+=_.data[y],h+=_.data[y+1],f+=_.data[y+2],p++}return d=Math.round(d/p),h=Math.round(h/p),f=Math.round(f/p),{r:d,g:h,b:f}}self.onmessage=s=>{const o=s.data.panoData,a=new OffscreenCanvas(o.fullWidth,o.fullHeight),c=a.getContext("2d"),l=new OffscreenCanvas(o.croppedWidth,o.croppedHeight);l.getContext("2d").putImageData(s.data.image,0,0),function n(s,o,a){const c=a.fullHeight-a.croppedHeight-a.croppedY,l=a.fullWidth-a.croppedWidth-a.croppedX,u=a.croppedY+a.croppedHeight/2,d=s.width/32,h=d,f=10,p=`blur(${d}px)`,_=s.getContext("2d");if(_.drawImage(o,a.croppedX,a.croppedY,a.croppedWidth,a.croppedHeight),a.croppedY>0){if(a.croppedX>0||l>0){_.filter="none";const g=r(_,a.croppedX,a.croppedY,f,f,2),m=r(_,s.width-l-11,a.croppedY,f,f,2),y=t(g,m);a.croppedX>0&&(_.fillStyle=i(_,0,a.croppedX,y,g),_.fillRect(-h,-h,a.croppedX+2*h,u+h)),l>0&&(_.fillStyle=i(_,s.width-l,s.width,m,y),_.fillRect(s.width-l-h,-h,l+2*h,u+h))}_.filter=p,_.drawImage(o,0,0,o.width,f,a.croppedX,-h,a.croppedWidth,a.croppedY+2*h),_.fillStyle=e(r(_,0,0,s.width,f,f)),_.fillRect(-h,-h,s.width+2*h,2*h)}if(c>0){if(a.croppedX>0||l>0){_.filter="none";const g=r(_,a.croppedX,s.height-c-1-f,f,f,2),m=r(_,s.width-l-1-f,s.height-c-1-f,f,f,2),y=t(g,m);a.croppedX>0&&(_.fillStyle=i(_,0,a.croppedX,y,g),_.fillRect(-h,u,a.croppedX+2*h,s.height-u+h)),l>0&&(_.fillStyle=i(_,s.width-l,s.width,m,y),_.fillRect(s.width-l-h,u,l+2*h,s.height-u+h))}_.filter=p,_.drawImage(o,0,o.height-f,o.width,f,a.croppedX,s.height-c-h,a.croppedWidth,c+2*h),_.fillStyle=e(r(_,0,s.height-1-f,s.width,f,f)),_.fillRect(-h,s.height-h,s.width+2*h,2*h)}a.croppedX>0&&(_.filter=p,_.drawImage(o,o.width-f,0,f,o.height,-h,a.croppedY,2*h,a.croppedHeight),_.drawImage(o,0,0,f,o.height,0,a.croppedY,a.croppedX+h,a.croppedHeight)),l>0&&(_.filter=p,_.drawImage(o,0,0,f,o.height,s.width-h,a.croppedY,2*h,a.croppedHeight),_.drawImage(o,o.width-f,0,f,o.height,s.width-l-h,a.croppedY,l+h,a.croppedHeight)),_.filter="none",_.drawImage(o,a.croppedX,a.croppedY,a.croppedWidth,a.croppedHeight)}(a,l,o),postMessage(c.getImageData(0,0,a.width,a.height))}}.toString(),")()"],{type:"application/javascript"})),vQ=sg({backgroundColor:"#000",interpolateBackground:!1,resolution:64,useXmpData:!0,blur:!1},{resolution:n=>{if(!n||!qt.isPowerOfTwo(n))throw new Pt("EquirectangularAdapter resolution must be power of two");return n}}),ug=class extends No{constructor(n,e){super(n),this.config=vQ(e),Rr(this.viewer.config.useXmpData)||(this.config.useXmpData=this.viewer.config.useXmpData),Rr(this.viewer.config.canvasBackground)||(this.config.backgroundColor=this.viewer.config.canvasBackground),this.config.interpolateBackground&&(window.Worker?this.interpolationWorker=new Worker(_Q):(Yt("Web Worker API not available"),this.config.interpolateBackground=!1)),this.SPHERE_SEGMENTS=this.config.resolution,this.SPHERE_HORIZONTAL_SEGMENTS=this.SPHERE_SEGMENTS/2}supportsTransition(){return!0}supportsPreload(){return!0}destroy(){this.interpolationWorker?.terminate(),super.destroy()}loadTexture(n,e,t=this.config.useXmpData){var i=this;return Q0(function*(){if("string"!=typeof n)return Promise.reject(new Pt("Invalid panorama url, are you using the right adapter?"));const r=yield i.viewer.textureLoader.loadFile(n,l=>i.viewer.loader.setProgress(l),n),s=t?yield i.loadXMP(r):null,o=yield i.viewer.textureLoader.blobToImage(r);"function"==typeof e&&(e=e(o,s)),!e&&!s&&(e=i.__defaultPanoData(o));const a={fullWidth:rs(e?.fullWidth,s?.fullWidth,o.width),fullHeight:rs(e?.fullHeight,s?.fullHeight,o.height),croppedWidth:rs(e?.croppedWidth,s?.croppedWidth,o.width),croppedHeight:rs(e?.croppedHeight,s?.croppedHeight,o.height),croppedX:rs(e?.croppedX,s?.croppedX,0),croppedY:rs(e?.croppedY,s?.croppedY,0),poseHeading:rs(e?.poseHeading,s?.poseHeading,0),posePitch:rs(e?.posePitch,s?.posePitch,0),poseRoll:rs(e?.poseRoll,s?.poseRoll,0)};(a.croppedWidth!==o.width||a.croppedHeight!==o.height)&&Yt(`Invalid panoData, croppedWidth/croppedHeight is not coherent with the loaded image.\n            panoData: ${a.croppedWidth}x${a.croppedHeight}, image: ${o.width}x${o.height}`),Math.abs(a.fullWidth-2*a.fullHeight)>1&&(Yt("Invalid panoData, fullWidth should be twice fullHeight"),a.fullWidth=2*a.fullHeight),a.croppedX+a.croppedWidth>a.fullWidth&&(Yt("Invalid panoData, croppedX + croppedWidth > fullWidth"),a.croppedX=a.fullWidth-a.croppedWidth),a.croppedY+a.croppedHeight>a.fullHeight&&(Yt("Invalid panoData, croppedY + croppedHeight > fullHeight"),a.croppedY=a.fullHeight-a.croppedHeight);const c=i.createEquirectangularTexture(o,a);return{panorama:n,texture:c,panoData:a,cacheKey:n}})()}loadXMP(n){var e=this;return Q0(function*(){const t=yield e.loadBlobAsString(n),i=t.indexOf("<x:xmpmeta"),r=t.indexOf("</x:xmpmeta>"),s=t.substring(i,r);return-1!==i&&-1!==r&&s.includes("GPano:")?{fullWidth:ss(s,"FullPanoWidthPixels"),fullHeight:ss(s,"FullPanoHeightPixels"),croppedWidth:ss(s,"CroppedAreaImageWidthPixels"),croppedHeight:ss(s,"CroppedAreaImageHeightPixels"),croppedX:ss(s,"CroppedAreaLeftPixels"),croppedY:ss(s,"CroppedAreaTopPixels"),poseHeading:ss(s,"PoseHeadingDegrees"),posePitch:ss(s,"PosePitchDegrees"),poseRoll:ss(s,"PoseRollDegrees")}:null})()}loadBlobAsString(n){return new Promise((e,t)=>{const i=new FileReader;i.onload=()=>e(i.result),i.onerror=t,i.readAsText(n)})}createEquirectangularTexture(n,e){if(this.config.blur||e.fullWidth>Xn.maxTextureWidth||e.croppedWidth!==e.fullWidth||e.croppedHeight!==e.fullHeight){const t=Math.min(1,Xn.maxCanvasWidth/e.fullWidth),i={fullWidth:e.fullWidth*t,fullHeight:e.fullHeight*t,croppedWidth:e.croppedWidth*t,croppedHeight:e.croppedHeight*t,croppedX:e.croppedX*t,croppedY:e.croppedY*t},r=document.createElement("canvas");r.width=i.fullWidth,r.height=i.fullHeight;const s=r.getContext("2d");this.config.backgroundColor&&(s.fillStyle=this.config.backgroundColor,s.fillRect(0,0,r.width,r.height)),this.config.blur&&(s.filter=`blur(${r.width/2048}px)`),s.drawImage(n,i.croppedX,i.croppedY,i.croppedWidth,i.croppedHeight);const o=$w(r);return this.config.interpolateBackground&&(e.croppedWidth!==e.fullWidth||e.croppedHeight!==e.fullHeight)&&(this.interpolationWorker.postMessage({image:s.getImageData(i.croppedX,i.croppedY,i.croppedWidth,i.croppedHeight),panoData:i}),this.interpolationWorker.onmessage=a=>{s.putImageData(a.data,0,0),o.needsUpdate=!0,this.viewer.needsUpdate()}),o}return $w(n)}createMesh(n=1){const e=new Bd(Gd*n,this.SPHERE_SEGMENTS,this.SPHERE_HORIZONTAL_SEGMENTS,-Math.PI/2).scale(-1,1,1),t=No.createOverlayMaterial();return new Ai(e,t)}setTexture(n,e){this.__setUniform(n,No.OVERLAY_UNIFORMS.panorama,e.texture)}setOverlay(n,e,t){this.__setUniform(n,No.OVERLAY_UNIFORMS.overlayOpacity,t),this.__setUniform(n,No.OVERLAY_UNIFORMS.overlay,e?e.texture:null)}setTextureOpacity(n,e){this.__setUniform(n,No.OVERLAY_UNIFORMS.globalOpacity,e),n.material.transparent=e<1}disposeTexture(n){n.texture?.dispose()}__setUniform(n,e,t){n.material.uniforms[e].value=t}__defaultPanoData(n){const e=Math.max(n.width,2*n.height),t=Math.round(e/2),i=Math.round((e-n.width)/2),r=Math.round((t-n.height)/2);return{fullWidth:e,fullHeight:t,croppedWidth:n.width,croppedHeight:n.height,croppedX:i,croppedY:r}}};ug.id="equirectangular",ug.supportsDownload=!0,ug.supportsOverlay=!0;var Oa=class rk{constructor(e,t){this.parent=e,this.children=[],this.container=document.createElement("div"),this.state={visible:!0},this.viewer=e instanceof rk?e.viewer:e,this.container.className=t.className||"",this.parent.children.push(this),this.parent.container.appendChild(this.container)}destroy(){this.parent.container.removeChild(this.container);const e=this.parent.children.indexOf(this);-1!==e&&this.parent.children.splice(e,1),this.children.slice().forEach(t=>t.destroy()),this.children.length=0}toggle(e=!this.isVisible()){e?this.show():this.hide()}hide(e){this.container.style.display="none",this.state.visible=!1}show(e){this.container.style.display="",this.state.visible=!0}isVisible(){return this.state.visible}},yQ=sg({id:null,className:null,title:null,hoverScale:!1,collapsable:!1,tabbable:!0,icon:null,iconActive:null}),Ii=class extends Oa{constructor(n,e){super(n,{className:`psv-button ${e.hoverScale?"psv-button--hover-scale":""} ${e.className||""}`}),this.state={visible:!0,enabled:!0,supported:!0,collapsed:!1,active:!1,width:0},this.config=yQ(e),this.config.id=this.constructor.id,e.icon&&this.__setIcon(e.icon),this.state.width=this.container.offsetWidth,this.config.title?this.container.title=this.config.title:this.id&&this.id in this.viewer.config.lang&&(this.container.title=this.viewer.config.lang[this.id]),e.tabbable&&(this.container.tabIndex=0),this.container.addEventListener("click",t=>{this.state.enabled&&this.onClick(),t.stopPropagation()}),this.container.addEventListener("keydown",t=>{t.key===Vn.Enter&&this.state.enabled&&(this.onClick(),t.stopPropagation())})}get id(){return this.config.id}get title(){return this.container.title}get content(){return this.container.innerHTML}get width(){return this.state.width}get collapsable(){return this.config.collapsable}show(n=!0){this.isVisible()||(this.state.visible=!0,this.state.collapsed||(this.container.style.display=""),n&&this.viewer.navbar.autoSize())}hide(n=!0){this.isVisible()&&(this.state.visible=!1,this.container.style.display="none",n&&this.viewer.navbar.autoSize())}checkSupported(){Hw(this.isSupported(),(n,e)=>{this.state&&(this.state.supported=n,e?n||this.hide():this.toggle(n))})}autoSize(){}isSupported(){return!0}toggleActive(n=!this.state.active){n!==this.state.active&&(this.state.active=n,eg(this.container,"psv-button--active",this.state.active),this.config.iconActive&&this.__setIcon(this.state.active?this.config.iconActive:this.config.icon))}disable(){this.container.classList.add("psv-button--disabled"),this.state.enabled=!1}enable(){this.container.classList.remove("psv-button--disabled"),this.state.enabled=!0}collapse(){this.state.collapsed=!0,this.container.style.display="none"}uncollapse(){this.state.collapsed=!1,this.state.visible&&(this.container.style.display="")}__setIcon(n){this.container.innerHTML=n,kw(this.container.querySelector("svg"),"psv-button-svg")}},bQ=class extends Ii{constructor(n,e){super(n,{className:`psv-custom-button ${e.className||""}`,hoverScale:!1,collapsable:!1!==e.collapsable,tabbable:!1!==e.tabbable,title:e.title}),this.customOnClick=e.onClick,this.config.id=e.id?e.id:"psvButton-"+Math.random().toString(36).substring(2),e.content&&(this.container.innerHTML=e.content),this.state.width=this.container.offsetWidth,e.disabled&&this.disable(),!1===e.visible&&this.hide()}onClick(){this.customOnClick?.(this.viewer)}},th=class extends Ii{constructor(n){super(n,{className:"psv-description-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:Ir.info}),this.mode=0,this.viewer.addEventListener(Yd.type,this),this.viewer.addEventListener(Jd.type,this),this.viewer.addEventListener(Ro.type,this),this.viewer.addEventListener(Lo.type,this),this.viewer.addEventListener(Di.type,this)}destroy(){this.viewer.removeEventListener(Yd.type,this),this.viewer.removeEventListener(Jd.type,this),this.viewer.removeEventListener(Ro.type,this),this.viewer.removeEventListener(Lo.type,this),this.viewer.removeEventListener(Di.type,this),super.destroy()}handleEvent(n){if(n instanceof Di)return void(n.containsOptions("description")&&this.autoSize(!0));if(!this.mode)return;let e=!1;n instanceof Yd?e=1===this.mode:n instanceof Jd?e=1===this.mode&&n.notificationId!==qn.DESCRIPTION:n instanceof Ro?e=2===this.mode:n instanceof Lo&&(e=2===this.mode&&n.panelId!==qn.DESCRIPTION),e&&(this.toggleActive(!1),this.mode=0)}onClick(){this.mode?this.__close():this.__open()}hide(n){super.hide(n),this.mode&&this.__close()}autoSize(n=!1){if(n){const e=this.viewer.navbar.getButton("caption",!1);e&&!e.isVisible()||this.viewer.config.description?this.show(!1):this.hide(!1)}}__close(){switch(this.mode){case 1:this.viewer.notification.hide(qn.DESCRIPTION);break;case 2:this.viewer.panel.hide(qn.DESCRIPTION)}}__open(){this.toggleActive(!0),this.viewer.config.description?(this.mode=2,this.viewer.panel.show({id:qn.DESCRIPTION,content:(this.viewer.config.caption?`<p>${this.viewer.config.caption}</p>`:"")+this.viewer.config.description})):(this.mode=1,this.viewer.notification.show({id:qn.DESCRIPTION,content:this.viewer.config.caption}))}};th.id="description";var mO=class extends Ii{constructor(n){super(n,{className:"psv-download-button",hoverScale:!0,collapsable:!0,tabbable:!0,icon:Ir.download}),this.viewer.addEventListener(Di.type,this)}destroy(){this.viewer.removeEventListener(Di.type,this),super.destroy()}handleEvent(n){n instanceof Di&&n.containsOptions("downloadUrl")&&this.checkSupported()}onClick(){const n=document.createElement("a");n.href=this.viewer.config.downloadUrl||this.viewer.config.panorama,n.download=n.href.startsWith("data:")&&!this.viewer.config.downloadName?"panorama."+n.href.substring(0,n.href.indexOf(";")).split("/").pop():this.viewer.config.downloadName||n.href.split("/").pop(),n.target="_blank",this.viewer.container.appendChild(n),n.click(),setTimeout(()=>{this.viewer.container.removeChild(n)},100)}checkSupported(){this.viewer.adapter.constructor.supportsDownload||this.viewer.config.downloadUrl?this.show():this.hide()}};mO.id="download";var gO=class extends Ii{constructor(n){super(n,{className:"psv-fullscreen-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:Ir.fullscreenIn,iconActive:Ir.fullscreenOut}),this.viewer.addEventListener(Xd.type,this)}destroy(){this.viewer.removeEventListener(Xd.type,this),super.destroy()}handleEvent(n){n instanceof Xd&&this.toggleActive(n.fullscreenEnabled)}onClick(){this.viewer.toggleFullscreen()}};gO.id="fullscreen";var dg=class extends Ii{constructor(n){super(n,{className:"psv-menu-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:Ir.menu}),this.viewer.addEventListener(Lo.type,this),this.viewer.addEventListener(Ro.type,this),super.hide()}destroy(){this.viewer.removeEventListener(Lo.type,this),this.viewer.removeEventListener(Ro.type,this),super.destroy()}handleEvent(n){n instanceof Lo?this.toggleActive(n.panelId===qn.MENU):n instanceof Ro&&this.toggleActive(!1)}onClick(){this.state.active?this.__hideMenu():this.__showMenu()}hide(n){super.hide(n),this.__hideMenu()}show(n){super.show(n),this.state.active&&this.__showMenu()}__showMenu(){var n,e;this.viewer.panel.show({id:qn.MENU,content:(n=this.viewer.navbar.collapsed,e=this.viewer.config.lang.menu,`\n<div class="psv-panel-menu psv-panel-menu--stripped">\n  <h1 class="psv-panel-menu-title">${Ir.menu} ${e}</h1>\n  <ul class="psv-panel-menu-list">\n    ${n.map(t=>`\n    <li data-psv-button="${t.id}" class="psv-panel-menu-item" tabindex="0">\n      <span class="psv-panel-menu-item-icon">${t.content}</span>\n      <span class="psv-panel-menu-item-label">${t.title}</span>\n    </li>\n    `).join("")}\n  </ul>\n</div>\n`),noMargin:!0,clickHandler:n=>{const e=n?Uw(n,"li"):void 0,t=e?e.dataset.psvButton:void 0;t&&(this.viewer.navbar.getButton(t).onClick(),this.__hideMenu())}})}__hideMenu(){this.viewer.panel.hide(qn.MENU)}};function MQ(n){let e=0;switch(n){case 0:e=90;break;case 1:e=-90;break;case 3:e=180;break;default:e=0}return Ir.arrow.replace("rotate(0",`rotate(${e}`)}dg.id="menu";var nh=class extends Ii{constructor(n,e){super(n,{className:"psv-move-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:MQ(e)}),this.direction=e,this.handler=new ag,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(n){switch(n.type){case"mousedown":this.__onMouseDown();break;case"mouseup":case"touchend":this.__onMouseUp();break;case"keydown":n.key===Vn.Enter&&this.__onMouseDown();break;case"keyup":n.key===Vn.Enter&&this.__onMouseUp()}}onClick(){}isSupported(){return tg(Xn.isTouchEnabled)}__onMouseDown(){if(!this.state.enabled)return;const n={};switch(this.direction){case 0:n.pitch=!1;break;case 1:n.pitch=!0;break;case 3:n.yaw=!1;break;default:n.yaw=!0}this.viewer.stopAll(),this.viewer.dynamics.position.roll(n),this.handler.down()}__onMouseUp(){this.state.enabled&&this.handler.up(()=>{this.viewer.dynamics.position.stop(),this.viewer.resetIdleTimer()})}};nh.groupId="move";var _O=class extends nh{constructor(n){super(n,1)}};_O.id="moveDown";var vO=class extends nh{constructor(n){super(n,2)}};vO.id="moveLeft";var yO=class extends nh{constructor(n){super(n,3)}};yO.id="moveRight";var bO=class extends nh{constructor(n){super(n,0)}};bO.id="moveUp";var Kw=class extends Ii{constructor(n,e,t){super(n,{className:"psv-zoom-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:e}),this.direction=t,this.handler=new ag,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(n){switch(n.type){case"mousedown":this.__onMouseDown();break;case"mouseup":case"touchend":this.__onMouseUp();break;case"keydown":n.key===Vn.Enter&&this.__onMouseDown();break;case"keyup":n.key===Vn.Enter&&this.__onMouseUp()}}onClick(){}isSupported(){return tg(Xn.isTouchEnabled)}__onMouseDown(){this.state.enabled&&(this.viewer.dynamics.zoom.roll(1===this.direction),this.handler.down())}__onMouseUp(){this.state.enabled&&this.handler.up(()=>this.viewer.dynamics.zoom.stop())}};Kw.groupId="zoom";var wO=class extends Kw{constructor(n){super(n,Ir.zoomIn,0)}};wO.id="zoomIn";var xO=class extends Kw{constructor(n){super(n,Ir.zoomOut,1)}};xO.id="zoomOut";var Jw=class extends Ii{constructor(n){super(n,{className:"psv-zoom-range",hoverScale:!1,collapsable:!1,tabbable:!1}),this.zoomRange=document.createElement("div"),this.zoomRange.className="psv-zoom-range-line",this.container.appendChild(this.zoomRange),this.zoomValue=document.createElement("div"),this.zoomValue.className="psv-zoom-range-handle",this.zoomRange.appendChild(this.zoomValue),this.slider=new MN(this.container,"HORIZONTAL",e=>this.__onSliderUpdate(e)),this.mediaMinWidth=parseInt(Do(this.container,"maxWidth"),10),this.viewer.addEventListener(qs.type,this),this.viewer.state.ready?this.__moveZoomValue(this.viewer.getZoomLevel()):this.viewer.addEventListener(Kd.type,this)}destroy(){this.slider.destroy(),this.viewer.removeEventListener(qs.type,this),this.viewer.removeEventListener(Kd.type,this),super.destroy()}handleEvent(n){n instanceof qs?this.__moveZoomValue(n.zoomLevel):n instanceof Kd&&this.__moveZoomValue(this.viewer.getZoomLevel())}onClick(){}isSupported(){return tg(Xn.isTouchEnabled)}autoSize(){this.state.supported&&(this.viewer.state.size.width<=this.mediaMinWidth&&this.state.visible?this.hide(!1):this.viewer.state.size.width>this.mediaMinWidth&&!this.state.visible&&this.show(!1))}__moveZoomValue(n){this.zoomValue.style.left=n/100*this.zoomRange.offsetWidth-this.zoomValue.offsetWidth/2+"px"}__onSliderUpdate(n){n.mousedown&&this.viewer.zoom(100*n.value)}};Jw.id="zoomRange",Jw.groupId="zoom";var MO=class extends SN{constructor(n){super(),this.viewer=n}init(){}destroy(){}},EO=class extends MO{constructor(n,e){super(n),this.config=this.constructor.configParser(e)}setOption(n,e){this.setOptions({[n]:e})}setOptions(n){const e={...this.config,...n},t=this.constructor,i=t.configParser,r=t.readonlyOptions,s=t.id;for(let[o,a]of Object.entries(n))o in i.defaults?r.includes(o)?Yt(`${s}: Option "${o}" cannot be updated`):(o in i.parsers&&(a=i.parsers[o](a,{rawConfig:e,defValue:i.defaults[o]})),this.config[o]=a):Yt(`${s}: Unknown option "${o}"`)}};function Qw(n){if(n)for(const[,e]of[["_",n],...Object.entries(n)])if(e.prototype instanceof MO)return e;return null}EO.readonlyOptions=[];var Fa={panorama:null,overlay:null,overlayOpacity:1,container:null,adapter:[ug,null],plugins:[],caption:null,description:null,downloadUrl:null,downloadName:null,loadingImg:null,loadingTxt:"Loading...",size:null,fisheye:0,minFov:30,maxFov:90,defaultZoomLvl:50,defaultYaw:0,defaultPitch:0,sphereCorrection:null,moveSpeed:1,zoomSpeed:1,moveInertia:!0,mousewheel:!0,mousemove:!0,mousewheelCtrlKey:!1,touchmoveTwoFingers:!1,useXmpData:null,panoData:null,requestHeaders:null,canvasBackground:null,rendererParameters:{alpha:!0,antialias:!0},withCredentials:!1,navbar:["zoom","move","download","description","caption","fullscreen"],lang:{zoom:"Zoom",zoomOut:"Zoom out",zoomIn:"Zoom in",moveUp:"Move up",moveDown:"Move down",moveLeft:"Move left",moveRight:"Move right",download:"Download",fullscreen:"Fullscreen",menu:"Menu",close:"Close",twoFingers:"Use two fingers to navigate",ctrlZoom:"Use ctrl + scroll to zoom the image",loadError:"The panorama can't be loaded"},keyboard:"fullscreen",keyboardActions:{[Vn.ArrowUp]:"ROTATE_UP",[Vn.ArrowDown]:"ROTATE_DOWN",[Vn.ArrowRight]:"ROTATE_RIGHT",[Vn.ArrowLeft]:"ROTATE_LEFT",[Vn.PageUp]:"ZOOM_IN",[Vn.PageDown]:"ZOOM_OUT",[Vn.Plus]:"ZOOM_IN",[Vn.Minus]:"ZOOM_OUT"}},SO={panorama:"Use setPanorama method to change the panorama",panoData:"Use setPanorama method to change the panorama",overlay:"Use setOverlay method to changer the overlay",overlayOpacity:"Use setOverlay method to changer the overlay",container:"Cannot change viewer container",adapter:"Cannot change adapter",plugins:"Cannot change plugins"},ex={container:n=>{if(!n)throw new Pt("No value given for container.");return n},adapter:(n,{defValue:e})=>{if(!(n=n?Array.isArray(n)?[pO(n[0]),n[1]]:[pO(n),null]:e)[0])throw new Pt("An undefined value was given for adapter.");if(!n[0].id)throw new Pt("Adapter has no id.");return n},overlayOpacity:n=>qt.clamp(n,0,1),defaultYaw:n=>Io(n),defaultPitch:n=>Io(n,!0),defaultZoomLvl:n=>qt.clamp(n,0,100),minFov:(n,{rawConfig:e})=>(e.maxFov<n&&(Yt("maxFov cannot be lower than minFov"),n=e.maxFov),qt.clamp(n,1,179)),maxFov:(n,{rawConfig:e})=>(n<e.minFov&&(n=e.minFov),qt.clamp(n,1,179)),lang:n=>(Array.isArray(n.twoFingers)&&(Yt("lang.twoFingers must not be an array"),n.twoFingers=n.twoFingers[0]),{...Fa.lang,...n}),keyboard:n=>!!n&&("object"==typeof n?(Yt("Use keyboardActions to configure the keyboard actions, keyboard option must be either true, false, 'fullscreen' or 'always'"),"fullscreen"):"always"===n?"always":"fullscreen"),keyboardActions:(n,{rawConfig:e})=>e.keyboard&&"object"==typeof e.keyboard?e.keyboard:n,fisheye:n=>!0===n?1:!1===n?0:n,requestHeaders:n=>n&&"object"==typeof n?()=>n:"function"==typeof n?n:null,rendererParameters:(n,{defValue:e})=>({...n,...e}),plugins:n=>n.map((e,t)=>{if(!(e=Array.isArray(e)?[Qw(e[0]),e[1]]:[Qw(e),null])[0])throw new Pt(`An undefined value was given for plugin ${t}.`);if(!e[0].id)throw new Pt(`Plugin ${t} has no id.`);return e}),navbar:n=>!1===n?null:!0===n?$d(Fa.navbar):"string"==typeof n?n.split(/[ ,]/):n,useXmpData:n=>(null!==n&&Yt("Global useXmpData is deprecated, it is now configured on the adapter."),n),canvasBackground:n=>(null!==n&&Yt("Global canvasBackground is deprecated, it is now configured on the adapter."),n)},EQ=sg(Fa,ex),kl=class extends Ii{constructor(n){super(n,{className:"psv-caption",hoverScale:!1,collapsable:!1,tabbable:!0}),this.contentWidth=0,this.state.width=0,this.contentElt=document.createElement("div"),this.contentElt.className="psv-caption-content",this.container.appendChild(this.contentElt),this.setCaption(this.viewer.config.caption)}hide(){this.contentElt.style.display="none",this.state.visible=!1}show(){this.contentElt.style.display="",this.state.visible=!0}onClick(){}setCaption(n){this.show(),this.contentElt.innerHTML=n??"",this.contentWidth=this.contentElt.innerHTML?this.contentElt.offsetWidth:0,this.autoSize()}autoSize(){this.toggle(this.container.offsetWidth>=this.contentWidth),this.__refreshButton()}__refreshButton(){this.viewer.navbar.getButton(th.id,!1)?.autoSize(!0)}};kl.id="caption";var tx={},hg={};function TO(n,e){if(!n.id)throw new Pt("Button id is required");if(tx[n.id]=n,n.groupId&&(hg[n.groupId]=hg[n.groupId]||[]).push(n),e){const t=Fa.navbar;switch(e){case"start":t.unshift(n.id);break;case"end":t.push(n.id);break;default:{const[i,r]=e.split(":"),s=t.indexOf(i);if(!i||!r||-1===s)throw new Pt(`Invalid defaultPosition ${e}`);t.splice(s+("right"===r?1:0),0,n.id)}}}}[xO,Jw,wO,th,kl,mO,gO,vO,yO,bO,_O].forEach(n=>TO(n));var SQ=class extends Oa{constructor(n){super(n,{className:`psv-navbar ${Wd}`}),this.collapsed=[],this.state.visible=!1}show(){this.container.classList.add("psv-navbar--open"),this.state.visible=!0}hide(){this.container.classList.remove("psv-navbar--open"),this.state.visible=!1}setButtons(n){this.children.slice().forEach(e=>e.destroy()),this.children.length=0,-1!==n.indexOf(kl.id)&&-1===n.indexOf(th.id)&&n.splice(n.indexOf(kl.id),0,th.id),n.forEach(e=>{"object"==typeof e?new bQ(this,e):tx[e]?new tx[e](this):hg[e]?hg[e].forEach(t=>{new t(this)}):Yt(`Unknown button ${e}`)}),new dg(this),this.children.forEach(e=>{e instanceof Ii&&e.checkSupported()}),this.autoSize()}setCaption(n){this.children.some(e=>e instanceof kl&&(e.setCaption(n),!0))}getButton(n,e=!0){const t=this.children.find(i=>i instanceof Ii&&i.id===n);return!t&&e&&Yt(`button "${n}" not found in the navbar`),t}autoSize(){this.children.forEach(i=>{i instanceof Ii&&i.autoSize()});const n=this.container.offsetWidth;let e=0;const t=[];this.children.forEach(i=>{i.isVisible()&&i instanceof Ii&&(e+=i.width,i.collapsable&&t.push(i))}),0!==e&&(n<e&&t.length>0?(t.forEach(i=>i.collapse()),this.collapsed=t,this.getButton(dg.id).show(!1)):n>=e&&this.collapsed.length>0&&(this.collapsed.forEach(i=>i.uncollapse()),this.collapsed=[],this.getButton(dg.id).hide(!1)),this.getButton(kl.id,!1)?.autoSize())}},TQ=class extends Oa{constructor(n){super(n,{className:"psv-loader-container"}),this.loader=document.createElement("div"),this.loader.className="psv-loader",this.container.appendChild(this.loader),this.size=this.loader.offsetWidth,this.canvas=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.canvas.setAttribute("class","psv-loader-canvas"),this.canvas.setAttribute("viewBox",`0 0 ${this.size} ${this.size}`),this.loader.appendChild(this.canvas),this.textColor=Do(this.loader,"color"),this.color=Do(this.canvas,"color"),this.border=parseInt(Do(this.loader,"outlineWidth"),10),this.thickness=parseInt(Do(this.canvas,"outlineWidth"),10),this.viewer.addEventListener(Di.type,this),this.__updateContent(),this.hide()}destroy(){this.viewer.removeEventListener(Di.type,this),super.destroy()}handleEvent(n){n instanceof Di&&n.containsOptions("loadingImg","loadingTxt")&&this.__updateContent()}setProgress(n){const e=Math.min(n,99.999)/100*Math.PI*2,t=this.size/2,i=t,r=this.thickness/2+this.border,s=(this.size-this.thickness)/2-this.border,o=Math.sin(e)*s+t,a=-Math.cos(e)*s+t;this.canvas.innerHTML=`\n            <circle cx="${t}" cy="${t}" r="${t}" fill="${this.color}"/>\n            <path d="M ${i} ${r} A ${s} ${s} 0 ${n>50?"1":"0"} 1 ${o} ${a}" \n                  fill="none" stroke="${this.textColor}" stroke-width="${this.thickness}" stroke-linecap="round"/>\n        `,this.viewer.dispatchEvent(new jN(Math.round(n)))}__updateContent(){const n=this.loader.querySelector(".psv-loader-image, .psv-loader-text");let e;if(n&&this.loader.removeChild(n),this.viewer.config.loadingImg?(e=document.createElement("img"),e.className="psv-loader-image",e.src=this.viewer.config.loadingImg):this.viewer.config.loadingTxt&&(e=document.createElement("div"),e.className="psv-loader-text",e.innerHTML=this.viewer.config.loadingTxt),e){const t=Math.round(Math.sqrt(2*Math.pow(this.size/2-this.thickness/2-this.border,2)));e.style.maxWidth=t+"px",e.style.maxHeight=t+"px",this.loader.appendChild(e)}}},CQ=class extends Oa{constructor(n){super(n,{className:"psv-notification"}),this.state={visible:!1,contentId:null,timeout:null},this.content=document.createElement("div"),this.content.className="psv-notification-content",this.container.appendChild(this.content),this.content.addEventListener("click",()=>this.hide())}isVisible(n){return this.state.visible&&(!n||!this.state.contentId||this.state.contentId===n)}toggle(){throw new Pt("Notification cannot be toggled")}show(n){this.state.timeout&&(clearTimeout(this.state.timeout),this.state.timeout=null),"string"==typeof n&&(n={content:n}),this.state.contentId=n.id||null,this.content.innerHTML=n.content,this.container.classList.add("psv-notification--visible"),this.state.visible=!0,this.viewer.dispatchEvent(new Jd(n.id)),n.timeout&&(this.state.timeout=setTimeout(()=>this.hide(this.state.contentId),n.timeout))}hide(n){if(this.isVisible(n)){const e=this.state.contentId;this.container.classList.remove("psv-notification--visible"),this.state.visible=!1,this.state.contentId=null,this.viewer.dispatchEvent(new Yd(e))}}},AQ=class extends Oa{constructor(n){super(n,{className:`psv-overlay ${Wd}`}),this.state={visible:!1,contentId:null,dissmisable:!0},this.image=document.createElement("div"),this.image.className="psv-overlay-image",this.container.appendChild(this.image),this.title=document.createElement("div"),this.title.className="psv-overlay-title",this.container.appendChild(this.title),this.text=document.createElement("div"),this.text.className="psv-overlay-text",this.container.appendChild(this.text),this.container.addEventListener("click",this),this.viewer.addEventListener(Po.type,this),super.hide()}destroy(){this.viewer.removeEventListener(Po.type,this),super.destroy()}handleEvent(n){"click"===n.type?this.isVisible()&&this.state.dissmisable&&(this.hide(),n.stopPropagation()):n instanceof Po&&this.isVisible()&&this.state.dissmisable&&n.key===Vn.Escape&&(this.hide(),n.preventDefault())}isVisible(n){return this.state.visible&&(!n||!this.state.contentId||this.state.contentId===n)}toggle(){throw new Pt("Overlay cannot be toggled")}show(n){"string"==typeof n&&(n={title:n}),this.state.contentId=n.id||null,this.state.dissmisable=!1!==n.dissmisable,this.image.innerHTML=n.image||"",this.title.innerHTML=n.title||"",this.text.innerHTML=n.text||"",super.show(),this.viewer.dispatchEvent(new tO(n.id))}hide(n){if(this.isVisible(n)){const e=this.state.contentId;super.hide(),this.state.contentId=null,this.viewer.dispatchEvent(new BN(e))}}},nx="psv-panel-content--no-interaction",IQ=class extends Oa{constructor(n){super(n,{className:`psv-panel ${Wd}`}),this.state={visible:!1,contentId:null,mouseX:0,mouseY:0,mousedown:!1,clickHandler:null,keyHandler:null,width:{}};const e=document.createElement("div");e.className="psv-panel-resizer",this.container.appendChild(e);const t=document.createElement("div");t.className="psv-panel-close-button",t.innerHTML=Ir.close,t.title=n.config.lang.close,this.container.appendChild(t),this.content=document.createElement("div"),this.content.className="psv-panel-content",this.container.appendChild(this.content),this.container.addEventListener("wheel",i=>i.stopPropagation()),t.addEventListener("click",()=>this.hide()),e.addEventListener("mousedown",this),e.addEventListener("touchstart",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this),this.viewer.container.addEventListener("mousemove",this),this.viewer.container.addEventListener("touchmove",this),this.viewer.addEventListener(Po.type,this)}destroy(){this.viewer.removeEventListener(Po.type,this),this.viewer.container.removeEventListener("mousemove",this),this.viewer.container.removeEventListener("touchmove",this),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(n){switch(n.type){case"mousedown":this.__onMouseDown(n);break;case"touchstart":this.__onTouchStart(n);break;case"mousemove":this.__onMouseMove(n);break;case"touchmove":this.__onTouchMove(n);break;case"mouseup":this.__onMouseUp(n);break;case"touchend":this.__onTouchEnd(n);break;case Po.type:this.__onKeyPress(n)}}isVisible(n){return this.state.visible&&(!n||!this.state.contentId||this.state.contentId===n)}toggle(){throw new Pt("Panel cannot be toggled")}show(n){"string"==typeof n&&(n={content:n});const e=this.isVisible(n.id);this.state.contentId=n.id||null,this.state.visible=!0,this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.content.removeEventListener("keydown",this.state.keyHandler),this.state.clickHandler=null,this.state.keyHandler=null),this.container.style.width=n.id&&this.state.width[n.id]?this.state.width[n.id]:n.width?n.width:null,this.content.innerHTML=n.content,this.content.scrollTop=0,this.container.classList.add("psv-panel--open"),eg(this.content,"psv-panel-content--no-margin",!0===n.noMargin),n.clickHandler&&(this.state.clickHandler=t=>{n.clickHandler(t.target)},this.state.keyHandler=t=>{t.key===Vn.Enter&&n.clickHandler(t.target)},this.content.addEventListener("click",this.state.clickHandler),this.content.addEventListener("keydown",this.state.keyHandler),e||setTimeout(()=>{this.content.querySelector("a,button,[tabindex]")?.focus()},300)),this.viewer.dispatchEvent(new Lo(n.id))}hide(n){if(this.isVisible(n)){const e=this.state.contentId;this.state.visible=!1,this.state.contentId=null,this.content.innerHTML=null,this.container.classList.remove("psv-panel--open"),this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.state.clickHandler=null),this.viewer.dispatchEvent(new Ro(e))}}__onMouseDown(n){n.stopPropagation(),this.__startResize(n.clientX,n.clientY)}__onTouchStart(n){if(n.stopPropagation(),1===n.touches.length){const e=n.touches[0];this.__startResize(e.clientX,e.clientY)}}__onMouseUp(n){this.state.mousedown&&(n.stopPropagation(),this.state.mousedown=!1,this.content.classList.remove(nx))}__onTouchEnd(n){this.state.mousedown&&(n.stopPropagation(),0===n.touches.length&&(this.state.mousedown=!1,this.content.classList.remove(nx)))}__onMouseMove(n){this.state.mousedown&&(n.stopPropagation(),this.__resize(n.clientX,n.clientY))}__onTouchMove(n){if(this.state.mousedown){const e=n.touches[0];this.__resize(e.clientX,e.clientY)}}__onKeyPress(n){this.isVisible()&&n.key===Vn.Escape&&(this.hide(),n.preventDefault())}__startResize(n,e){this.state.mouseX=n,this.state.mouseY=e,this.state.mousedown=!0,this.content.classList.add(nx)}__resize(n,e){const t=n,i=e,r=Math.max(200,this.container.offsetWidth-(t-this.state.mouseX))+"px";this.state.contentId&&(this.state.width[this.state.contentId]=r),this.container.style.width=r,this.state.mouseX=t,this.state.mouseY=i}},RQ=class extends Oa{constructor(n,e){super(n,{className:"psv-tooltip"}),this.state={visible:!0,arrow:0,border:0,state:0,width:0,height:0,pos:"",config:null,data:null},this.content=document.createElement("div"),this.content.className="psv-tooltip-content",this.container.appendChild(this.content),this.arrow=document.createElement("div"),this.arrow.className="psv-tooltip-arrow",this.container.appendChild(this.arrow),this.container.addEventListener("transitionend",this),this.container.addEventListener("touchdown",t=>t.stopPropagation()),this.container.addEventListener("mousedown",t=>t.stopPropagation()),this.container.style.top="-1000px",this.container.style.left="-1000px",this.show(e)}handleEvent(n){"transitionend"===n.type&&this.__onTransitionEnd(n)}destroy(){delete this.state.data,super.destroy()}toggle(){throw new Pt("Tooltip cannot be toggled")}show(n){if(0!==this.state.state)throw new Pt("Initialized tooltip cannot be re-initialized");n.className&&kw(this.container,n.className),n.style&&Object.assign(this.container.style,n.style),this.state.state=3,this.update(n.content,n),this.state.data=n.data,this.state.state=1,this.viewer.dispatchEvent(new rO(this,this.state.data)),this.__waitImages()}update(n,e){this.content.innerHTML=n;const t=this.container.getBoundingClientRect();this.state.width=t.right-t.left,this.state.height=t.bottom-t.top,this.state.arrow=parseInt(Do(this.arrow,"borderTopWidth"),10),this.state.border=parseInt(Do(this.container,"borderTopLeftRadius"),10),this.move(e??this.state.config)}move(n){if(1!==this.state.state&&3!==this.state.state)throw new Pt("Uninitialized tooltip cannot be moved");n.box=n.box??this.state.config?.box??{width:0,height:0},this.state.config=n;const e=this.container,t=this.arrow,i={posClass:_N(n.position,{allowCenter:!1,cssOrder:!1})||["top","center"],width:this.state.width,height:this.state.height,top:0,left:0,arrowTop:0,arrowLeft:0};this.__computeTooltipPosition(i,n);let r=null,s=null;if(i.top<0?r="bottom":i.top+i.height>this.viewer.state.size.height&&(r="top"),i.left<0?s="right":i.left+i.width>this.viewer.state.size.width&&(s="left"),s||r){const a=Ww(i.posClass);r&&(i.posClass[a?0:1]=r),s&&(i.posClass[a?1:0]=s),this.__computeTooltipPosition(i,n)}e.style.top=i.top+"px",e.style.left=i.left+"px",t.style.top=i.arrowTop+"px",t.style.left=i.arrowLeft+"px";const o=i.posClass.join("-");o!==this.state.pos&&(e.classList.remove(`psv-tooltip--${this.state.pos}`),this.state.pos=o,e.classList.add(`psv-tooltip--${this.state.pos}`))}hide(){this.container.classList.remove("psv-tooltip--visible"),this.state.state=2,this.viewer.dispatchEvent(new HN(this.state.data))}__onTransitionEnd(n){if("transform"===n.propertyName)switch(this.state.state){case 1:this.container.classList.add("psv-tooltip--visible"),this.state.state=3;break;case 2:this.state.state=0,this.destroy()}}__computeTooltipPosition(n,e){const t=this.state.arrow,i=e.top,r=n.height,s=e.left,o=n.width,a=t+this.state.border,c=e.box.width/2+2*t,l=e.box.height/2+2*t;switch(n.posClass.join("-")){case"top-left":n.top=i-l-r,n.left=s+a-o,n.arrowTop=r,n.arrowLeft=o-a-t;break;case"top-center":n.top=i-l-r,n.left=s-o/2,n.arrowTop=r,n.arrowLeft=o/2-t;break;case"top-right":n.top=i-l-r,n.left=s-a,n.arrowTop=r,n.arrowLeft=t;break;case"bottom-left":n.top=i+l,n.left=s+a-o,n.arrowTop=2*-t,n.arrowLeft=o-a-t;break;case"bottom-center":n.top=i+l,n.left=s-o/2,n.arrowTop=2*-t,n.arrowLeft=o/2-t;break;case"bottom-right":n.top=i+l,n.left=s-a,n.arrowTop=2*-t,n.arrowLeft=t;break;case"left-top":n.top=i+a-r,n.left=s-c-o,n.arrowTop=r-a-t,n.arrowLeft=o;break;case"center-left":n.top=i-r/2,n.left=s-c-o,n.arrowTop=r/2-t,n.arrowLeft=o;break;case"left-bottom":n.top=i-a,n.left=s-c-o,n.arrowTop=t,n.arrowLeft=o;break;case"right-top":n.top=i+a-r,n.left=s+c,n.arrowTop=r-a-t,n.arrowLeft=2*-t;break;case"center-right":n.top=i-r/2,n.left=s+c,n.arrowTop=r/2-t,n.arrowLeft=2*-t;break;case"right-bottom":n.top=i-a,n.left=s+c,n.arrowTop=t,n.arrowLeft=2*-t}}__waitImages(){const n=this.content.querySelectorAll("img");if(n.length>0){const e=[];n.forEach(t=>{e.push(new Promise(i=>{t.onload=i,t.onerror=i}))}),Promise.all(e).then(()=>{if(1===this.state.state||3===this.state.state){const t=this.container.getBoundingClientRect();this.state.width=t.right-t.left,this.state.height=t.bottom-t.top,this.move(this.state.config)}})}}},Ul={enabled:!0,maxItems:10,ttl:600,items:{},purgeInterval:null,init(){Ws.enabled&&(Yt("ThreeJS cache should be disabled"),Ws.enabled=!1),!this.purgeInterval&&this.enabled&&(this.purgeInterval=setInterval(()=>this.purge(),6e4))},add(n,e,t){this.enabled&&e&&(this.items[e]=this.items[e]??{files:{},lastAccess:null},this.items[e].files[n]=t,this.items[e].lastAccess=Date.now())},get(n,e){if(this.enabled&&e&&this.items[e])return this.items[e].lastAccess=Date.now(),this.items[e].files[n]},remove(n,e){this.enabled&&e&&this.items[e]&&(delete this.items[e].files[n],0===Object.keys(this.items[e].files).length&&delete this.items[e])},purge(){Object.entries(this.items).sort(([,n],[,e])=>e.lastAccess-n.lastAccess).forEach(([n,{lastAccess:e}],t)=>{t>0&&(Date.now()-e>=1e3*this.ttl||t>=this.maxItems)&&delete this.items[n]})}},ih=class{constructor(n){this.viewer=n,this.config=n.config,this.state=n.state}destroy(){}},Pr=new C,fg=new Tb(0,0,0,"ZXY"),LQ=class extends ih{constructor(n){super(n)}fovToZoomLevel(n){const e=Math.round((n-this.config.minFov)/(this.config.maxFov-this.config.minFov)*100);return e-2*(e-50)}zoomLevelToFov(n){return this.config.maxFov+n/100*(this.config.minFov-this.config.maxFov)}vFovToHFov(n){return qt.radToDeg(2*Math.atan(Math.tan(qt.degToRad(n)/2)*this.state.aspect))}getAnimationProperties(n,e,t){const i=!Rr(e),r=!Rr(t),s={};let o;if(i){const a=this.viewer.getPosition(),c=nN(a.yaw,e.yaw);s.yaw={start:a.yaw,end:a.yaw+c},s.pitch={start:a.pitch,end:e.pitch},o=jw(n,iN(a,e))}if(r){const a=this.viewer.getZoomLevel(),c=Math.abs(t-a);s.zoom={start:a,end:t},o||(o=jw(n,Math.PI/4*c/100))}return o=Math.max(XL,o),{duration:o,properties:s}}textureCoordsToSphericalCoords(n){const e=this.state.panoData;if(!e)throw new Pt("Current adapter does not support texture coordinates.");const t=(n.textureX+e.croppedX)/e.fullWidth*Math.PI*2,i=(n.textureY+e.croppedY)/e.fullHeight*Math.PI,r={yaw:t>=Math.PI?t-Math.PI:t+Math.PI,pitch:Math.PI/2-i};return fg.equals(this.viewer.renderer.panoramaPose)&&fg.equals(this.viewer.renderer.sphereCorrection)?r:(this.sphericalCoordsToVector3(r,Pr),Pr.applyEuler(this.viewer.renderer.panoramaPose),Pr.applyEuler(this.viewer.renderer.sphereCorrection),this.vector3ToSphericalCoords(Pr))}sphericalCoordsToTextureCoords(n){const e=this.state.panoData;if(!e)throw new Pt("Current adapter does not support texture coordinates.");(!fg.equals(this.viewer.renderer.panoramaPose)||!fg.equals(this.viewer.renderer.sphereCorrection))&&(this.sphericalCoordsToVector3(n,Pr),qw(Pr,this.viewer.renderer.sphereCorrection),qw(Pr,this.viewer.renderer.panoramaPose),n=this.vector3ToSphericalCoords(Pr));const t=n.yaw/Math.PI/2*e.fullWidth,i=n.pitch/Math.PI*e.fullHeight;return{textureX:Math.round(n.yaw<Math.PI?t+e.fullWidth/2:t-e.fullWidth/2)-e.croppedX,textureY:Math.round(e.fullHeight/2-i)-e.croppedY}}sphericalCoordsToVector3(n,e,t=Gd){return e||(e=new C),e.x=t*-Math.cos(n.pitch)*Math.sin(n.yaw),e.y=t*Math.sin(n.pitch),e.z=t*Math.cos(n.pitch)*Math.cos(n.yaw),e}vector3ToSphericalCoords(n){const e=Math.acos(n.y/Math.sqrt(n.x*n.x+n.y*n.y+n.z*n.z)),t=Math.atan2(n.x,n.z);return{yaw:t<0?-t:2*Math.PI-t,pitch:Math.PI/2-e}}viewerCoordsToVector3(n){const e=this.viewer.renderer.getIntersections(n).filter(t=>t.object.userData[Ao]);return e.length?e[0].point:null}viewerCoordsToSphericalCoords(n){const e=this.viewerCoordsToVector3(n);return e?this.vector3ToSphericalCoords(e):null}vector3ToViewerCoords(n){const e=n.clone();return e.project(this.viewer.renderer.camera),{x:Math.round((e.x+1)/2*this.state.size.width),y:Math.round((1-e.y)/2*this.state.size.height)}}sphericalCoordsToViewerCoords(n){return this.sphericalCoordsToVector3(n,Pr),this.vector3ToViewerCoords(Pr)}isPointVisible(n){let e,t;if(n instanceof C)e=n,t=this.vector3ToViewerCoords(n);else{if(!ng(n))return!1;e=this.sphericalCoordsToVector3(n,Pr),t=this.vector3ToViewerCoords(e)}return e.dot(this.viewer.state.direction)>0&&t.x>=0&&t.x<=this.viewer.state.size.width&&t.y>=0&&t.y<=this.viewer.state.size.height}cleanPosition(n){return void 0!==n.textureX&&void 0!==n.textureY?this.textureCoordsToSphericalCoords(n):{yaw:Io(n.yaw),pitch:Io(n.pitch,!this.state.littlePlanet)}}cleanSphereCorrection(n){return{pan:Io(n?.pan||0),tilt:Io(n?.tilt||0,!0),roll:Io(n?.roll||0,!0,!1)}}cleanPanoramaPose(n){return{pan:qt.degToRad(n?.poseHeading||0),tilt:qt.degToRad(n?.posePitch||0),roll:qt.degToRad(n?.poseRoll||0)}}},rh=class sk{constructor(){this.$=sk.IDLE}is(...e){return e.some(t=>this.$&t)}set(e){this.$=e}add(e){this.$|=e}remove(e){this.$&=~e}};rh.IDLE=0,rh.CLICK=1,rh.MOVING=2,rh.INERTIA=4;var Ht=rh,FQ=class extends ih{constructor(n){super(n),this.data={startMouseX:0,startMouseY:0,mouseX:0,mouseY:0,mouseHistory:[],pinchDist:0,ctrlKeyDown:!1,dblclickData:null,dblclickTimeout:null,longtouchTimeout:null,twofingersTimeout:null,ctrlZoomTimeout:null},this.step=new Ht,this.keyHandler=new ag,this.resizeObserver=new ResizeObserver(Vw(()=>this.viewer.autoSize(),50)),this.moveThreshold=YL*Xn.pixelRatio}init(){window.addEventListener("keydown",this,{passive:!1}),window.addEventListener("keyup",this),this.viewer.container.addEventListener("mousedown",this),window.addEventListener("mousemove",this,{passive:!1}),window.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchstart",this,{passive:!1}),window.addEventListener("touchmove",this,{passive:!1}),window.addEventListener("touchend",this,{passive:!1}),this.viewer.container.addEventListener("wheel",this,{passive:!1}),document.addEventListener(Xn.fullscreenEvent,this),this.resizeObserver.observe(this.viewer.container)}destroy(){window.removeEventListener("keydown",this),window.removeEventListener("keyup",this),this.viewer.container.removeEventListener("mousedown",this),window.removeEventListener("mousemove",this),window.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchstart",this),window.removeEventListener("touchmove",this),window.removeEventListener("touchend",this),this.viewer.container.removeEventListener("wheel",this),document.removeEventListener(Xn.fullscreenEvent,this),this.resizeObserver.disconnect(),clearTimeout(this.data.dblclickTimeout),clearTimeout(this.data.longtouchTimeout),clearTimeout(this.data.twofingersTimeout),clearTimeout(this.data.ctrlZoomTimeout),super.destroy()}handleEvent(n){switch(n.type){case"keydown":this.__onKeyDown(n);break;case"keyup":this.__onKeyUp();break;case"mousemove":this.__onMouseMove(n);break;case"mouseup":this.__onMouseUp(n);break;case"touchmove":this.__onTouchMove(n);break;case"touchend":this.__onTouchEnd(n);break;case Xn.fullscreenEvent:this.__onFullscreenChange()}if(!Uw(n.target,"."+Wd))switch(n.type){case"mousedown":this.__onMouseDown(n);break;case"touchstart":this.__onTouchStart(n);break;case"wheel":this.__onMouseWheel(n)}}__onKeyDown(n){if(this.config.mousewheelCtrlKey&&(this.data.ctrlKeyDown=n.key===Vn.Control,this.data.ctrlKeyDown&&(clearTimeout(this.data.ctrlZoomTimeout),this.viewer.overlay.hide(qn.CTRL_ZOOM))),!this.viewer.dispatchEvent(new Po(n.key))||!this.state.keyboardEnabled)return;const e=this.config.keyboardActions?.[n.key];if("function"==typeof e)e(this.viewer),n.preventDefault();else if(e&&!this.keyHandler.pending){switch("ZOOM_IN"!==e&&"ZOOM_OUT"!==e&&this.viewer.stopAll(),e){case"ROTATE_UP":this.viewer.dynamics.position.roll({pitch:!1});break;case"ROTATE_DOWN":this.viewer.dynamics.position.roll({pitch:!0});break;case"ROTATE_RIGHT":this.viewer.dynamics.position.roll({yaw:!1});break;case"ROTATE_LEFT":this.viewer.dynamics.position.roll({yaw:!0});break;case"ZOOM_IN":this.viewer.dynamics.zoom.roll(!1);break;case"ZOOM_OUT":this.viewer.dynamics.zoom.roll(!0)}this.keyHandler.down(),n.preventDefault()}}__onKeyUp(){this.data.ctrlKeyDown=!1,this.state.keyboardEnabled&&this.keyHandler.up(()=>{this.viewer.dynamics.position.stop(),this.viewer.dynamics.zoom.stop(),this.viewer.resetIdleTimer()})}__onMouseDown(n){this.step.add(Ht.CLICK),this.data.startMouseX=n.clientX,this.data.startMouseY=n.clientY}__onMouseUp(n){this.step.is(Ht.CLICK,Ht.MOVING)&&this.__stopMove(n.clientX,n.clientY,n.target,2===n.button)}__onMouseMove(n){this.config.mousemove&&this.step.is(Ht.CLICK,Ht.MOVING)&&(n.preventDefault(),this.__doMove(n.clientX,n.clientY)),this.__handleObjectsEvents(n)}__onTouchStart(n){1===n.touches.length?(this.step.add(Ht.CLICK),this.data.startMouseX=n.touches[0].clientX,this.data.startMouseY=n.touches[0].clientY,this.data.longtouchTimeout||(this.data.longtouchTimeout=setTimeout(()=>{const e=n.touches[0];this.__stopMove(e.clientX,e.clientY,e.target,!0),this.data.longtouchTimeout=null},KL))):2===n.touches.length&&(this.step.set(Ht.IDLE),this.__cancelLongTouch(),this.config.mousemove&&(this.__cancelTwoFingersOverlay(),this.__startMoveZoom(n),n.preventDefault()))}__onTouchEnd(n){if(this.__cancelLongTouch(),this.step.is(Ht.CLICK,Ht.MOVING))if(n.preventDefault(),this.__cancelTwoFingersOverlay(),1===n.touches.length)this.__stopMove(this.data.mouseX,this.data.mouseY);else if(0===n.touches.length){const e=n.changedTouches[0];this.__stopMove(e.clientX,e.clientY,e.target)}}__onTouchMove(n){if(this.__cancelLongTouch(),this.config.mousemove)if(1===n.touches.length){if(this.config.touchmoveTwoFingers)this.step.is(Ht.CLICK)&&!this.data.twofingersTimeout&&(this.data.twofingersTimeout=setTimeout(()=>{this.viewer.overlay.show({id:qn.TWO_FINGERS,image:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M33.38 33.2a1.96 1.96 0 0 0 1.5-3.23 10.61 10.61 0 0 1 7.18-17.51c.7-.06 1.31-.49 1.61-1.12a13.02 13.02 0 0 1 11.74-7.43c7.14 0 12.96 5.8 12.96 12.9 0 3.07-1.1 6.05-3.1 8.38-.7.82-.61 2.05.21 2.76.83.7 2.07.6 2.78-.22a16.77 16.77 0 0 0 4.04-10.91C72.3 7.54 64.72 0 55.4 0a16.98 16.98 0 0 0-14.79 8.7 14.6 14.6 0 0 0-12.23 14.36c0 3.46 1.25 6.82 3.5 9.45.4.45.94.69 1.5.69m45.74 43.55a22.13 22.13 0 0 1-5.23 12.4c-4 4.55-9.53 6.86-16.42 6.86-12.6 0-20.1-10.8-20.17-10.91a1.82 1.82 0 0 0-.08-.1c-5.3-6.83-14.55-23.82-17.27-28.87-.05-.1 0-.21.02-.23a6.3 6.3 0 0 1 8.24 1.85l9.38 12.59a1.97 1.97 0 0 0 3.54-1.17V25.34a4 4 0 0 1 1.19-2.87 3.32 3.32 0 0 1 2.4-.95c1.88.05 3.4 1.82 3.4 3.94v24.32a1.96 1.96 0 0 0 3.93 0v-33.1a3.5 3.5 0 0 1 7 0v35.39a1.96 1.96 0 0 0 3.93 0v-.44c.05-2.05 1.6-3.7 3.49-3.7 1.93 0 3.5 1.7 3.5 3.82v5.63c0 .24.04.48.13.71l.1.26a1.97 1.97 0 0 0 3.76-.37c.33-1.78 1.77-3.07 3.43-3.07 1.9 0 3.45 1.67 3.5 3.74l-1.77 18.1zM77.39 51c-1.25 0-2.45.32-3.5.9v-.15c0-4.27-3.33-7.74-7.42-7.74-1.26 0-2.45.33-3.5.9V16.69a7.42 7.42 0 0 0-14.85 0v1.86a7 7 0 0 0-3.28-.94 7.21 7.21 0 0 0-5.26 2.07 7.92 7.92 0 0 0-2.38 5.67v37.9l-5.83-7.82a10.2 10.2 0 0 0-13.35-2.92 4.1 4.1 0 0 0-1.53 5.48C20 64.52 28.74 80.45 34.07 87.34c.72 1.04 9.02 12.59 23.4 12.59 7.96 0 14.66-2.84 19.38-8.2a26.06 26.06 0 0 0 6.18-14.6l1.78-18.2v-.2c0-4.26-3.32-7.73-7.42-7.73z"/>\x3c!--Created by AomAm from the Noun Project--\x3e</svg>\n',title:this.config.lang.twoFingers})},JL));else if(this.step.is(Ht.CLICK,Ht.MOVING)){n.preventDefault();const e=n.touches[0];this.__doMove(e.clientX,e.clientY)}}else this.__doMoveZoom(n),this.__cancelTwoFingersOverlay()}__cancelLongTouch(){this.data.longtouchTimeout&&(clearTimeout(this.data.longtouchTimeout),this.data.longtouchTimeout=null)}__cancelTwoFingersOverlay(){this.config.touchmoveTwoFingers&&(this.data.twofingersTimeout&&(clearTimeout(this.data.twofingersTimeout),this.data.twofingersTimeout=null),this.viewer.overlay.hide(qn.TWO_FINGERS))}__onMouseWheel(n){if(!this.config.mousewheel||!n.deltaY)return;if(this.config.mousewheelCtrlKey&&!this.data.ctrlKeyDown)return this.viewer.overlay.show({id:qn.CTRL_ZOOM,image:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 17 79 79"><path fill="currentColor" d="M38.1 29.27c-.24 0-.44.2-.44.45v10.7a.45.45 0 00.9 0v-10.7c0-.25-.2-.45-.45-.45zm10.2 26.66a11.54 11.54 0 01-8.48-6.14.45.45 0 10-.8.41 12.45 12.45 0 009.22 6.62.45.45 0 00.07-.9zm24.55-13.08a23.04 23.04 0 00-22.56-23v7.07l-.01.05a2.83 2.83 0 012.39 2.78v14.03l.09-.02h8.84v-9.22a.45.45 0 11.9 0v9.22h10.35v-.9zm0 27.33V44.66H62.5c-.02 2.01-.52 4-1.47 5.76a.45.45 0 01-.61.18.45.45 0 01-.19-.61 11.54 11.54 0 001.36-5.33h-8.83l-.1-.01a2.83 2.83 0 01-2.83 2.84h-.04-.04a2.83 2.83 0 01-2.83-2.83v-14.9a2.82 2.82 0 012.47-2.8v-7.11a23.04 23.04 0 00-22.57 23v.91h14.72V29.88a8.2 8.2 0 015.02-7.57c.22-.1.5.01.59.24.1.23-.01.5-.24.6a7.3 7.3 0 00-4.47 6.73v13.88h3.9a.45.45 0 110 .9h-3.9v.15a7.32 7.32 0 0011.23 6.17.45.45 0 01.49.76 8.22 8.22 0 01-12.62-6.93v-.15H26.82v25.52a23.04 23.04 0 0023.01 23.01 23.04 23.04 0 0023.02-23.01zm1.8-27.33v27.33A24.85 24.85 0 0149.84 95a24.85 24.85 0 01-24.82-24.82V42.85a24.85 24.85 0 0124.82-24.82 24.85 24.85 0 0124.83 24.82zM57.98 29.88v9.36a.45.45 0 11-.9 0v-9.36a7.28 7.28 0 00-3.4-6.17.45.45 0 01.49-.76 8.18 8.18 0 013.8 6.93z"/>\x3c!-- Created by Icon Island from the Noun Project --\x3e</svg>\n',title:this.config.lang.ctrlZoom}),clearTimeout(this.data.ctrlZoomTimeout),void(this.data.ctrlZoomTimeout=setTimeout(()=>this.viewer.overlay.hide(qn.CTRL_ZOOM),QL));n.preventDefault(),n.stopPropagation();const e=n.deltaY/Math.abs(n.deltaY)*5*this.config.zoomSpeed;0!==e&&this.viewer.dynamics.zoom.step(-e,5)}__onFullscreenChange(){const n=this.viewer.isFullscreenEnabled();"fullscreen"===this.config.keyboard&&(n?this.viewer.startKeyboardControl():this.viewer.stopKeyboardControl()),this.viewer.dispatchEvent(new Xd(n))}__resetMove(){this.step.set(Ht.IDLE),this.data.mouseX=0,this.data.mouseY=0,this.data.startMouseX=0,this.data.startMouseY=0,this.data.mouseHistory.length=0}__startMoveZoom(n){this.viewer.stopAll(),this.__resetMove();const e=Bw(n);this.step.set(Ht.MOVING),({distance:this.data.pinchDist,center:{x:this.data.mouseX,y:this.data.mouseY}}=e),this.__logMouseMove(this.data.mouseX,this.data.mouseY)}__stopMove(n,e,t,i=!1){this.step.is(Ht.MOVING)?this.config.moveInertia?(this.__logMouseMove(n,e),this.__stopMoveInertia(n,e)):(this.__resetMove(),this.viewer.resetIdleTimer()):(this.step.is(Ht.CLICK)&&!this.__moveThresholdReached(n,e)&&this.__doClick(n,e,t,i),this.step.remove(Ht.CLICK),this.step.is(Ht.INERTIA)||(this.__resetMove(),this.viewer.resetIdleTimer()))}__stopMoveInertia(n,e){const i=new ow(this.data.mouseHistory.map(([,a,c])=>new ie(a,c))).getTangent(1),r=this.data.mouseHistory.reduce(({total:a,prev:c},l)=>({total:c?a+Fw({x:c[1],y:c[2]},{x:l[1],y:l[2]})/(l[0]-c[0]):0,prev:l}),{total:0,prev:null}).total/this.data.mouseHistory.length;if(!r)return this.__resetMove(),void this.viewer.resetIdleTimer();this.step.set(Ht.INERTIA);let s=n,o=e;this.state.animation=new qd({properties:{speed:{start:r,end:0}},duration:1e3,easing:"outQuad",onTick:a=>{s+=a.speed*i.x*3*Xn.pixelRatio,o+=a.speed*i.y*3*Xn.pixelRatio,this.__applyMove(s,o)}}),this.state.animation.then(a=>{this.state.animation=null,a&&(this.__resetMove(),this.viewer.resetIdleTimer())})}__doClick(n,e,t,i=!1){const r=this.viewer.container.getBoundingClientRect(),s=n-r.left,o=e-r.top,a=this.viewer.renderer.getIntersections({x:s,y:o}),c=a.find(l=>l.object.userData[Ao]);if(c){const l=this.viewer.dataHelper.vector3ToSphericalCoords(c.point),u={rightclick:i,target:t,clientX:n,clientY:e,viewerX:s,viewerY:o,yaw:l.yaw,pitch:l.pitch,objects:a.map(d=>d.object).filter(d=>!d.userData[Ao])};try{const d=this.viewer.dataHelper.sphericalCoordsToTextureCoords(u);u.textureX=d.textureX,u.textureY=d.textureY}catch{u.textureX=NaN,u.textureY=NaN}this.data.dblclickTimeout?(Math.abs(this.data.dblclickData.clientX-u.clientX)<this.moveThreshold&&Math.abs(this.data.dblclickData.clientY-u.clientY)<this.moveThreshold&&this.viewer.dispatchEvent(new ON(this.data.dblclickData)),clearTimeout(this.data.dblclickTimeout),this.data.dblclickTimeout=null,this.data.dblclickData=null):(this.viewer.dispatchEvent(new PN(u)),this.data.dblclickData=$d(u),this.data.dblclickTimeout=setTimeout(()=>{this.data.dblclickTimeout=null,this.data.dblclickData=null},ZL))}}__handleObjectsEvents(n){if(!dN(this.state.objectsObservers)&&sN(n.target,this.viewer.container)){const e=oN(this.viewer.container),t={x:n.clientX-e.x,y:n.clientY-e.y},i=this.viewer.renderer.getIntersections(t),r=(s,o,a)=>{this.viewer.dispatchEvent(new a(n,s,t,o))};for(const[s,o]of Object.entries(this.state.objectsObservers)){const a=i.find(c=>c.object.userData[s]);a?(o&&a.object!==o&&(r(o,s,Zw),this.state.objectsObservers[s]=null),o?r(a.object,s,fO):(this.state.objectsObservers[s]=a.object,r(a.object,s,uO))):o&&(r(o,s,Zw),this.state.objectsObservers[s]=null)}}}__doMove(n,e){this.step.is(Ht.CLICK)&&this.__moveThresholdReached(n,e)?(this.viewer.stopAll(),this.__resetMove(),this.step.set(Ht.MOVING),this.data.mouseX=n,this.data.mouseY=e,this.__logMouseMove(n,e)):this.step.is(Ht.MOVING)&&(this.__applyMove(n,e),this.__logMouseMove(n,e))}__moveThresholdReached(n,e){return Math.abs(n-this.data.startMouseX)>=this.moveThreshold||Math.abs(e-this.data.startMouseY)>=this.moveThreshold}__applyMove(n,e){const t_yaw=this.config.moveSpeed*((n-this.data.mouseX)/this.state.size.width)*qt.degToRad(this.state.littlePlanet?90:this.state.hFov),t_pitch=this.config.moveSpeed*((e-this.data.mouseY)/this.state.size.height)*qt.degToRad(this.state.littlePlanet?90:this.state.vFov),i=this.viewer.getPosition();this.viewer.rotate({yaw:i.yaw-t_yaw,pitch:i.pitch+t_pitch}),this.data.mouseX=n,this.data.mouseY=e}__doMoveZoom(n){if(this.step.is(Ht.MOVING)){n.preventDefault();const e=Bw(n),t=(e.distance-this.data.pinchDist)/Xn.pixelRatio*this.config.zoomSpeed;this.viewer.zoom(this.viewer.getZoomLevel()+t),this.__doMove(e.center.x,e.center.y),this.data.pinchDist=e.distance}}__logMouseMove(n,e){const t=Date.now(),i=this.data.mouseHistory.length?this.data.mouseHistory[this.data.mouseHistory.length-1]:[0,-1,-1];i[1]===n&&i[2]===e?i[0]=t:t===i[0]?(i[1]=n,i[2]=e):this.data.mouseHistory.push([t,n,e]);let r=null;for(let s=0;s<this.data.mouseHistory.length;)this.data.mouseHistory[s][0]<t-Ow?this.data.mouseHistory.splice(s,1):r&&this.data.mouseHistory[s][0]-r>Ow/10?(this.data.mouseHistory.splice(0,s),s=0,r=this.data.mouseHistory[s][0]):(r=this.data.mouseHistory[s][0],s++)}},pg=new ie,kQ=class extends ih{constructor(n){super(n),this.renderer=new FP(this.config.rendererParameters),this.renderer.setPixelRatio(Xn.pixelRatio),this.renderer.outputColorSpace=Tr,this.renderer.domElement.className="psv-canvas",this.scene=new qb,this.camera=new $n(50,16/9,.1,2*Gd),this.camera.matrixWorldAutoUpdate=!1,this.mesh=this.viewer.adapter.createMesh(),this.mesh.userData={[Ao]:!0},this.meshContainer=new Sa,this.meshContainer.add(this.mesh),this.scene.add(this.meshContainer),this.raycaster=new XJ,this.container=document.createElement("div"),this.container.className="psv-canvas-container",this.container.appendChild(this.renderer.domElement),this.viewer.container.appendChild(this.container),this.viewer.addEventListener(Qd.type,this),this.viewer.addEventListener(qs.type,this),this.viewer.addEventListener(Zd.type,this),this.viewer.addEventListener(Di.type,this),this.hide()}get panoramaPose(){return this.mesh.rotation}get sphereCorrection(){return this.meshContainer.rotation}init(){this.show(),this.renderer.setAnimationLoop(n=>this.__renderLoop(n))}destroy(){this.renderer.setAnimationLoop(null),this.cleanScene(this.scene),this.viewer.container.removeChild(this.container),this.viewer.removeEventListener(Qd.type,this),this.viewer.removeEventListener(qs.type,this),this.viewer.removeEventListener(Zd.type,this),this.viewer.removeEventListener(Di.type,this),super.destroy()}handleEvent(n){switch(n.type){case Qd.type:this.__onSizeUpdated();break;case qs.type:this.__onZoomUpdated();break;case Zd.type:this.__onPositionUpdated();break;case Di.type:n.containsOptions("fisheye")&&this.__onPositionUpdated(),n.containsOptions("canvasBackground")&&(this.container.style.background=this.config.canvasBackground)}}hide(){this.container.style.opacity="0"}show(){this.container.style.opacity="1"}setCustomRenderer(n){this.customRenderer=n?n(this.renderer):null,this.viewer.needsUpdate()}__onSizeUpdated(){this.renderer.setSize(this.state.size.width,this.state.size.height),this.camera.aspect=this.state.aspect,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate()}__onZoomUpdated(){this.camera.fov=this.state.vFov,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate()}__onPositionUpdated(){this.camera.position.set(0,0,0),this.camera.lookAt(this.state.direction),this.config.fisheye&&this.camera.position.copy(this.state.direction).multiplyScalar(this.config.fisheye/2).negate(),this.camera.updateMatrixWorld(),this.viewer.needsUpdate()}__renderLoop(n){const e=this.timestamp?n-this.timestamp:0;this.timestamp=n,this.viewer.dispatchEvent(new AN(n,e)),this.viewer.dynamics.update(e),(this.state.needsUpdate||this.state.continuousUpdateCount>0)&&((this.customRenderer||this.renderer).render(this.scene,this.camera),this.viewer.dispatchEvent(new JN),this.state.needsUpdate=!1)}setTexture(n){this.viewer.adapter.constructor.supportsOverlay&&this.setOverlay(null,0),this.state.textureData&&this.viewer.adapter.disposeTexture(this.state.textureData),this.state.textureData=n,this.state.panoData=n.panoData,this.viewer.adapter.setTexture(this.mesh,n),this.viewer.needsUpdate()}setOverlay(n,e){this.state.overlayData&&this.viewer.adapter.disposeTexture(this.state.overlayData),this.state.overlayData=n,this.viewer.adapter.setOverlay(this.mesh,n,e),this.viewer.needsUpdate()}setPanoramaPose(n,e=this.mesh){const t=this.viewer.dataHelper.cleanPanoramaPose(n);e.rotation.set(-t.tilt,-t.pan,-t.roll,"ZXY")}setSphereCorrection(n,e=this.meshContainer){const t=this.viewer.dataHelper.cleanSphereCorrection(n);e.rotation.set(t.tilt,t.pan,t.roll,"ZXY")}transition(n,e){const t=!Rr(e.position),i=!Rr(e.zoom),r=new Xw(t?this.viewer.dataHelper.cleanPosition(e.position):void 0,e.zoom);this.viewer.dispatchEvent(r);const s=new Sa,o=this.viewer.adapter.createMesh(.5);if(this.viewer.adapter.setTexture(o,n,!0),this.viewer.adapter.setTextureOpacity(o,0),this.setPanoramaPose(n.panoData,o),this.setSphereCorrection(e.sphereCorrection,s),t&&"fade-only"===e.transition){const u=this.viewer.getPosition(),d=new C(0,1,0);s.rotateOnWorldAxis(d,r.position.yaw-u.yaw);const h=new C(0,1,0).cross(this.camera.getWorldDirection(new C)).normalize();s.rotateOnWorldAxis(h,r.position.pitch-u.pitch)}s.add(o),this.scene.add(s),this.renderer.setRenderTarget(new xo),this.renderer.render(this.scene,this.camera),this.renderer.setRenderTarget(null);const{duration:a,properties:c}=this.viewer.dataHelper.getAnimationProperties(e.transition,!0===e.transition?r.position:null,r.zoomLevel),l=new qd({properties:{...c,opacity:{start:0,end:1}},duration:a,easing:"inOutCubic",onTick:u=>{this.viewer.adapter.setTextureOpacity(o,u.opacity),t&&!0===e.transition&&this.viewer.dynamics.position.setValue({yaw:u.yaw,pitch:u.pitch}),i&&this.viewer.dynamics.zoom.setValue(u.zoom),this.viewer.needsUpdate()}});return l.then(u=>{u?(this.setTexture(n),this.viewer.adapter.setTextureOpacity(this.mesh,1),this.setPanoramaPose(n.panoData),this.setSphereCorrection(e.sphereCorrection),t&&"fade-only"===e.transition&&this.viewer.rotate(e.position)):this.viewer.adapter.disposeTexture(n),this.scene.remove(s),o.geometry.dispose(),o.geometry=null}),l}getIntersections(n){pg.x=2*n.x/this.state.size.width-1,pg.y=-2*n.y/this.state.size.height+1,this.raycaster.setFromCamera(pg,this.camera);const e=this.raycaster.intersectObjects(this.scene.children,!0).filter(t=>t.object.isMesh&&!!t.object.userData);return this.customRenderer?.getIntersections&&e.push(...this.customRenderer.getIntersections(this.raycaster,pg)),e}addObject(n){this.scene.add(n)}removeObject(n){this.scene.remove(n)}cleanScene(n){n.traverse(e=>{e.geometry&&e.geometry.dispose(),e.material&&(Array.isArray(e.material)?e.material.forEach(t=>{t.map&&t.map.dispose(),t.dispose()}):(e.material.map&&e.material.map.dispose(),e.material.dispose())),e.dispose&&!(e instanceof qb)&&e.dispose(),e!==n&&this.cleanScene(e)})}},UQ=class extends ih{constructor(n){super(n),this.fileLoader=new $s,this.fileLoader.setResponseType("blob"),this.imageLoader=new zd,this.config.withCredentials&&(this.fileLoader.setWithCredentials(!0),this.imageLoader.setCrossOrigin("use-credentials"))}destroy(){this.abortLoading(),super.destroy()}abortLoading(){}loadFile(n,e,t){const i=Ul.get(n,t);if(i){if(i instanceof Blob)return e?.(100),Promise.resolve(i);Ul.remove(n,t)}return this.config.requestHeaders&&this.fileLoader.setRequestHeader(this.config.requestHeaders(n)),new Promise((r,s)=>{let o=0;e?.(o),this.fileLoader.load(n,a=>{o=100,e?.(o),Ul.add(n,t,a),r(a)},a=>{if(a.lengthComputable){const c=a.loaded/a.total*100;c>o&&(o=c,e?.(o))}},a=>{s(a)})})}loadImage(n,e,t){const i=Ul.get(n,t);return i?(e?.(100),i instanceof Blob?this.blobToImage(i):Promise.resolve(i)):e||this.config.requestHeaders?this.loadFile(n,e,t).then(r=>this.blobToImage(r)):this.imageLoader.loadAsync(n).then(r=>(Ul.add(n,t,r),r))}blobToImage(n){return new Promise((e,t)=>{const i=document.createElement("img");i.onload=()=>{URL.revokeObjectURL(i.src),e(i)},i.onerror=t,i.src=URL.createObjectURL(n)})}preloadPanorama(n){return this.viewer.adapter.supportsPreload(n)?this.viewer.adapter.loadTexture(n):Promise.reject(new Pt("Current adapter does not support preload"))}},BQ=class extends ih{constructor(n){super(n),this.zoom=new og(e=>{this.viewer.state.vFov=this.viewer.dataHelper.zoomLevelToFov(e),this.viewer.state.hFov=this.viewer.dataHelper.vFovToHFov(this.viewer.state.vFov),this.viewer.dispatchEvent(new qs(e))},{defaultValue:this.viewer.config.defaultZoomLvl,min:0,max:100,wrap:!1}),this.position=new wN(e=>{this.viewer.dataHelper.sphericalCoordsToVector3(e,this.viewer.state.direction),this.viewer.dispatchEvent(new Zd(e))},{yaw:new og(null,{defaultValue:this.config.defaultYaw,min:0,max:2*Math.PI,wrap:!0}),pitch:new og(null,{defaultValue:this.config.defaultPitch,min:this.viewer.state.littlePlanet?0:-Math.PI/2,max:this.viewer.state.littlePlanet?2*Math.PI:Math.PI/2,wrap:this.viewer.state.littlePlanet})}),this.updateSpeeds()}updateSpeeds(){this.zoom.setSpeed(50*this.config.zoomSpeed),this.position.setSpeed(qt.degToRad(50*this.config.moveSpeed))}update(n){this.zoom.update(n),this.position.update(n)}},zQ=class extends SN{constructor(n){super(),this.plugins={},this.children=[],this.onResize=Vw(()=>this.navbar.autoSize(),500),Ul.init(),Xn.load(),this.state=new class{constructor(){this.ready=!1,this.needsUpdate=!1,this.continuousUpdateCount=0,this.keyboardEnabled=!1,this.direction=new C(0,0,Gd),this.vFov=60,this.hFov=60,this.aspect=1,this.animation=null,this.transitionAnimation=null,this.loadingPromise=null,this.littlePlanet=!1,this.idleTime=-1,this.objectsObservers={},this.size={width:0,height:0},this.panoData={fullWidth:0,fullHeight:0,croppedWidth:0,croppedHeight:0,croppedX:0,croppedY:0,poseHeading:0,posePitch:0,poseRoll:0}}},this.config=EQ(n),this.parent=rN(n.container),this.parent[Ao]=this,this.container=document.createElement("div"),this.container.classList.add("psv-container"),this.parent.appendChild(this.container),bN(this.container,"core"),this.adapter=new this.config.adapter[0](this,this.config.adapter[1]),this.renderer=new kQ(this),this.textureLoader=new UQ(this),this.eventsHandler=new FQ(this),this.dataHelper=new LQ(this),this.dynamics=new BQ(this),this.adapter.init?.(),this.loader=new TQ(this),this.navbar=new SQ(this),this.panel=new IQ(this),this.notification=new CQ(this),this.overlay=new AQ(this),this.resize(this.config.size),this.setCursor(null),Hw(Xn.isTouchEnabled,e=>{eg(this.container,"psv--is-touch",e)}),this.config.plugins.forEach(([e,t])=>{this.plugins[e.id]=new e(this,t)});for(const e of Object.values(this.plugins))e.init?.();this.config.navbar&&this.navbar.setButtons(this.config.navbar),this.state.loadingPromise||(this.config.panorama?this.setPanorama(this.config.panorama):this.loader.show())}destroy(){this.stopAll(),this.stopKeyboardControl(),this.exitFullscreen();for(const[n,e]of Object.entries(this.plugins))e.destroy(),delete this.plugins[n];this.children.slice().forEach(n=>n.destroy()),this.children.length=0,this.eventsHandler.destroy(),this.renderer.destroy(),this.textureLoader.destroy(),this.dataHelper.destroy(),this.adapter.destroy(),this.dynamics.destroy(),this.parent.removeChild(this.container),delete this.parent[Ao]}init(){this.eventsHandler.init(),this.renderer.init(),this.config.navbar&&(this.container.classList.add("psv--has-navbar"),this.navbar.show()),"always"===this.config.keyboard&&this.startKeyboardControl(),this.resetIdleTimer(),this.state.ready=!0,this.dispatchEvent(new Kd)}resetIdleTimer(){this.state.idleTime=performance.now()}disableIdleTimer(){this.state.idleTime=-1}getPlugin(n){if("string"==typeof n)return this.plugins[n];{const e=Qw(n);return e?this.plugins[e.id]:null}}getPosition(){return this.dataHelper.cleanPosition(this.dynamics.position.current)}getZoomLevel(){return this.dynamics.zoom.current}getSize(){return{...this.state.size}}isFullscreenEnabled(){return aN(this.parent)}needsUpdate(){this.state.needsUpdate=!0}needsContinuousUpdate(n){n?this.state.continuousUpdateCount++:this.state.continuousUpdateCount>0&&this.state.continuousUpdateCount--}autoSize(){(this.container.clientWidth!==this.state.size.width||this.container.clientHeight!==this.state.size.height)&&(this.state.size.width=Math.round(this.container.clientWidth),this.state.size.height=Math.round(this.container.clientHeight),this.state.aspect=this.state.size.width/this.state.size.height,this.state.hFov=this.dataHelper.vFovToHFov(this.state.vFov),this.dispatchEvent(new Qd(this.getSize())),this.onResize())}setPanorama(n,e={}){this.textureLoader.abortLoading(),this.state.transitionAnimation?.cancel(),this.state.ready||["sphereCorrection","panoData","overlay","overlayOpacity"].forEach(o=>{o in e||(e[o]=this.config[o])}),ng(e)&&(Yt("PanoramaOptions.yaw and PanoramaOptions.pitch are deprecated, use PanoramaOptions.position instead"),e.position=this.dataHelper.cleanPosition(e)),"number"==typeof e.transition&&(Yt("Use PanoramaOptions.speed to define the speed/duration of the transition"),e.speed=e.transition,e.transition=!0),void 0===e.transition&&(e.transition=!0),void 0===e.speed&&(e.speed=qL),void 0===e.showLoader&&(e.showLoader=!0),void 0===e.caption&&(e.caption=this.config.caption),void 0===e.description&&(e.description=this.config.description),!e.panoData&&"function"==typeof this.config.panoData&&(e.panoData=this.config.panoData);const t=!Rr(e.position),i=!Rr(e.zoom);(t||i)&&this.stopAll(),this.hideError(),this.resetIdleTimer(),this.config.panorama=n,this.config.caption=e.caption,this.config.description=e.description;const r=o=>{if(this.loader.hide(),this.state.loadingPromise=null,pN(o))return!1;if(o)throw this.navbar.setCaption(""),this.showError(this.config.lang.loadError),console.error(o),this.dispatchEvent(new XN(n,o)),o;return this.setOverlay(e.overlay,e.overlayOpacity),this.navbar.setCaption(this.config.caption),!0};this.navbar.setCaption(`<em>${this.config.loadingTxt||""}</em>`),(e.showLoader||!this.state.ready)&&this.loader.show();const s=this.adapter.loadTexture(this.config.panorama,e.panoData).then(o=>{if(o.panorama!==this.config.panorama)throw this.adapter.disposeTexture(o),Gw();return o});return this.state.loadingPromise=e.transition&&this.state.ready&&this.adapter.supportsTransition(this.config.panorama)?s.then(o=>(this.loader.hide(),this.dispatchEvent(new Yw(o)),this.state.transitionAnimation=this.renderer.transition(o,e),this.state.transitionAnimation)).then(o=>{if(this.state.transitionAnimation=null,!o)throw Gw()}).then(()=>r(),o=>r(o)):s.then(o=>{this.renderer.show(),this.renderer.setTexture(o),this.renderer.setPanoramaPose(o.panoData),this.renderer.setSphereCorrection(e.sphereCorrection),this.state.ready||this.init(),this.dispatchEvent(new Yw(o)),i&&this.zoom(e.zoom),t&&this.rotate(e.position)}).then(()=>r(),o=>r(o)),this.state.loadingPromise}setOverlay(n,e=this.config.overlayOpacity){const t=this.adapter.constructor.supportsOverlay;return n?t?this.adapter.loadTexture(n,i=>{const r=this.state.panoData,s=i.width/r.croppedWidth;return{fullWidth:s*r.fullWidth,fullHeight:s*r.fullHeight,croppedWidth:s*r.croppedWidth,croppedHeight:s*r.croppedHeight,croppedX:s*r.croppedX,croppedY:s*r.croppedY}},!1).then(i=>{this.renderer.setOverlay(i,e)}):Promise.reject(new Pt("Current adapter does not supports overlay")):(t&&this.renderer.setOverlay(null,0),Promise.resolve())}setOptions(n){const e={...this.config,...n};for(let[t,i]of Object.entries(n))if(t in Fa)if(t in SO)Yt(SO[t]);else switch(t in ex&&(i=ex[t](i,{rawConfig:e,defValue:Fa[t]})),this.config[t]=i,t){case"mousemove":this.state.cursorOverride||this.setCursor(null);break;case"caption":this.navbar.setCaption(this.config.caption);break;case"size":this.resize(this.config.size);break;case"sphereCorrection":this.renderer.setSphereCorrection(this.config.sphereCorrection);break;case"navbar":case"lang":this.navbar.setButtons(this.config.navbar);break;case"moveSpeed":case"zoomSpeed":this.dynamics.updateSpeeds();break;case"minFov":case"maxFov":this.dynamics.zoom.setValue(this.dataHelper.fovToZoomLevel(this.state.vFov)),this.dispatchEvent(new qs(this.getZoomLevel()));break;case"keyboard":"always"===this.config.keyboard?this.startKeyboardControl():this.stopKeyboardControl()}else Yt(`Unknown option ${t}`);this.needsUpdate(),this.dispatchEvent(new Di(Object.keys(n)))}setOption(n,e){this.setOptions({[n]:e})}showError(n){this.overlay.show({id:qn.ERROR,image:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="15 15 70 70"><path fill="currentColor" d="M50,16.2c-18.6,0-33.8,15.1-33.8,33.8S31.4,83.7,50,83.7S83.8,68.6,83.8,50S68.6,16.2,50,16.2z M50,80.2c-16.7,0-30.2-13.6-30.2-30.2S33.3,19.7,50,19.7S80.3,33.3,80.3,50S66.7,80.2,50,80.2z"/><rect fill="currentColor" x="48" y="31.7" width="4" height="28"/><rect fill="currentColor" x="48" y="63.2" width="4" height="5"/>\x3c!--Created by Shastry from the Noun Project--\x3e</svg>\n',title:n,dissmisable:!1})}hideError(){this.overlay.hide(qn.ERROR)}rotate(n){const e=new IN(this.dataHelper.cleanPosition(n));this.dispatchEvent(e),!e.defaultPrevented&&this.dynamics.position.setValue(e.position)}zoom(n){this.dynamics.zoom.setValue(n)}zoomIn(n=1){this.dynamics.zoom.step(n)}zoomOut(n=1){this.dynamics.zoom.step(-n)}animate(n){const e=ng(n),t=!Rr(n.zoom),i=new Xw(e?this.dataHelper.cleanPosition(n):void 0,n.zoom);if(this.dispatchEvent(i),i.defaultPrevented)return;this.stopAll();const{duration:r,properties:s}=this.dataHelper.getAnimationProperties(n.speed,i.position,i.zoomLevel);return r?(this.state.animation=new qd({properties:s,duration:r,easing:"inOutSine",onTick:o=>{e&&this.dynamics.position.setValue({yaw:o.yaw,pitch:o.pitch}),t&&this.dynamics.zoom.setValue(o.zoom)}}),this.state.animation.then(()=>{this.state.animation=null,this.resetIdleTimer()}),this.state.animation):(e&&this.rotate(i.position),t&&this.zoom(i.zoomLevel),new qd(null))}stopAnimation(){return this.state.animation?(this.state.animation.cancel(),this.state.animation):Promise.resolve()}resize(n){const e=n;["width","height"].forEach(t=>{n&&e[t]&&(/^[0-9.]+$/.test(e[t])&&(e[t]+="px"),this.parent.style[t]=e[t])}),this.autoSize()}enterFullscreen(){this.isFullscreenEnabled()||cN(this.parent)}exitFullscreen(){this.isFullscreenEnabled()&&lN()}toggleFullscreen(){this.isFullscreenEnabled()?this.exitFullscreen():this.enterFullscreen()}startKeyboardControl(){this.state.keyboardEnabled=!0}stopKeyboardControl(){this.state.keyboardEnabled=!1}createTooltip(n){return new RQ(this,n)}setCursor(n){this.state.cursorOverride=n,this.container.style.cursor=n||(this.config.mousemove?"move":"default")}observeObjects(n){this.state.objectsObservers[n]||(this.state.objectsObservers[n]=null)}unobserveObjects(n){delete this.state.objectsObservers[n]}stopAll(){return this.dispatchEvent(new aO),this.disableIdleTimer(),this.stopAnimation()}};Ws.enabled=!1,sr.enabled=!1;var HQ=Object.defineProperty;((n,e)=>{for(var t in e)HQ(n,t,{get:e[t],enumerable:!0})})({},{GyroscopeUpdatedEvent:()=>Bl});var CO=class ok extends EN{constructor(e){super(ok.type),this.gyroscopeEnabled=e}};CO.type="gyroscope-updated";var Bl=CO,ix=class extends Ii{constructor(n){super(n,{className:"psv-gyroscope-button",icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M50 0a50 50 0 1 0 0 100A50 50 0 0 0 50 0zm0 88.81a38.86 38.86 0 0 1-38.81-38.8 38.86 38.86 0 0 1 38.8-38.82A38.86 38.86 0 0 1 88.82 50 38.87 38.87 0 0 1 50 88.81z"/><path fill="currentColor" d="M72.07 25.9L40.25 41.06 27.92 74.12l31.82-15.18v-.01l12.32-33.03zM57.84 54.4L44.9 42.58l21.1-10.06-8.17 21.9z"/>\x3c!--Created by iconoci from the Noun Project--\x3e</svg>',hoverScale:!0,collapsable:!0,tabbable:!0}),this.plugin=this.viewer.getPlugin("gyroscope"),this.plugin&&this.plugin.addEventListener(Bl.type,this)}destroy(){this.plugin&&this.plugin.removeEventListener(Bl.type,this),super.destroy()}isSupported(){return!!this.plugin&&{initial:!1,promise:this.plugin.isSupported()}}handleEvent(n){n instanceof Bl&&this.toggleActive(n.gyroscopeEnabled)}onClick(){this.plugin.toggle()}};ix.id="gyroscope";var $Q=new C(0,0,1),AO=new Tb,qQ=new jn,XQ=new jn(-Math.sqrt(.5),0,0,Math.sqrt(.5)),ZQ=Na.getConfigParser({touchmove:!0,absolutePosition:!1,moveMode:"smooth"},{moveMode:(n,{defValue:e})=>"smooth"!==n&&"fast"!==n?(Na.logWarn("GyroscopePlugin: invalid moveMode"),e):n}),mg=new C,rx=class extends EO{constructor(n,e){super(n,e),this.state={isSupported:this.__checkSupport(),alphaOffset:0,enabled:!1,config_moveInertia:!0,moveMode:this.config.moveMode}}init(){super.init(),this.viewer.addEventListener(os.StopAllEvent.type,this),this.viewer.addEventListener(os.BeforeRotateEvent.type,this),this.viewer.addEventListener(os.BeforeRenderEvent.type,this)}destroy(){this.viewer.removeEventListener(os.StopAllEvent.type,this),this.viewer.removeEventListener(os.BeforeRotateEvent.type,this),this.viewer.removeEventListener(os.BeforeRenderEvent.type,this),this.stop(),delete this.controls,super.destroy()}handleEvent(n){n instanceof os.StopAllEvent?this.stop():n instanceof os.BeforeRenderEvent?this.__onBeforeRender():n instanceof os.BeforeRotateEvent&&this.__onBeforeRotate(n)}isSupported(){return this.state.isSupported}isEnabled(){return this.state.enabled}start(n=this.config.moveMode){return this.state.isSupported.then(e=>e?this.__requestPermission():(Na.logWarn("gyroscope not available"),Promise.reject())).then(e=>e?Promise.resolve():(Na.logWarn("gyroscope not allowed"),Promise.reject())).then(()=>{this.viewer.stopAll(),this.state.moveMode=n,this.state.config_moveInertia=this.viewer.config.moveInertia,this.viewer.config.moveInertia=!1,this.controls?this.controls.connect():this.controls=new class{constructor(n){!1===window.isSecureContext&&console.error("THREE.DeviceOrientationControls: DeviceOrientationEvent is only available in secure contexts (https)");const e=this,i=new jn;this.object=n,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;const r=function(a){e.deviceOrientation=a},s=function(){e.screenOrientation=window.orientation||0};this.connect=function(){s(),void 0!==window.DeviceOrientationEvent&&"function"==typeof window.DeviceOrientationEvent.requestPermission?window.DeviceOrientationEvent.requestPermission().then(function(a){"granted"==a&&(window.addEventListener("orientationchange",s),window.addEventListener("deviceorientation",r))}).catch(function(a){console.error("THREE.DeviceOrientationControls: Unable to use DeviceOrientation API:",a)}):(window.addEventListener("orientationchange",s),window.addEventListener("deviceorientation",r)),e.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",s),window.removeEventListener("deviceorientation",r),e.enabled=!1},this.update=function(){if(!1===e.enabled)return;const a=e.deviceOrientation;if(a){const c=a.alpha?qt.degToRad(a.alpha)+e.alphaOffset:0,l=a.beta?qt.degToRad(a.beta):0,u=a.gamma?qt.degToRad(a.gamma):0,d=e.screenOrientation?qt.degToRad(e.screenOrientation):0;(function(a,c,l,u,d){AO.set(l,c,-u,"YXZ"),a.setFromEuler(AO),a.multiply(XQ),a.multiply(qQ.setFromAxisAngle($Q,-d))})(e.object.quaternion,c,l,u,d),8*(1-i.dot(e.object.quaternion))>1e-6&&i.copy(e.object.quaternion)}},this.dispose=function(){e.disconnect()},this.connect()}}(new Gi),this.controls.deviceOrientation=null,this.controls.screenOrientation=0,this.controls.alphaOffset=0,this.state.alphaOffset=this.config.absolutePosition?0:null,this.state.enabled=!0,this.dispatchEvent(new Bl(!0))})}stop(){this.isEnabled()&&(this.controls.disconnect(),this.state.enabled=!1,this.viewer.config.moveInertia=this.state.config_moveInertia,this.dispatchEvent(new Bl(!1)),this.viewer.resetIdleTimer())}toggle(){this.isEnabled()?this.stop():this.start()}__onBeforeRender(){if(!this.isEnabled()||!this.controls.deviceOrientation)return;const n=this.viewer.getPosition();if(null===this.state.alphaOffset){this.controls.update(),this.controls.object.getWorldDirection(mg);const e=this.viewer.dataHelper.vector3ToSphericalCoords(mg);this.state.alphaOffset=e.yaw-n.yaw}else{this.controls.alphaOffset=this.state.alphaOffset,this.controls.update(),this.controls.object.getWorldDirection(mg);const e=this.viewer.dataHelper.vector3ToSphericalCoords(mg),t={yaw:e.yaw,pitch:-e.pitch},i="smooth"===this.state.moveMode?3:10;this.viewer.dynamics.position.goto(t,Na.getAngle(n,t)<.01?1:i)}}__onBeforeRotate(n){this.isEnabled()&&(n.preventDefault(),this.config.touchmove&&(this.state.alphaOffset-=n.position.yaw-this.viewer.getPosition().pitch))}__checkSupport(){return"DeviceOrientationEvent"in window&&"function"==typeof DeviceOrientationEvent.requestPermission?Promise.resolve(!0):"DeviceOrientationEvent"in window?new Promise(n=>{const e=t=>{n(!!t&&!Na.isNil(t.alpha)&&!isNaN(t.alpha)),window.removeEventListener("deviceorientation",e)};window.addEventListener("deviceorientation",e,!1),setTimeout(e,1e4)}):Promise.resolve(!1)}__requestPermission(){return"function"==typeof DeviceOrientationEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(n=>"granted"===n).catch(()=>!1):Promise.resolve(!0)}};rx.id="gyroscope",rx.configParser=ZQ,Fa.lang[ix.id]="Gyroscope",TO(ix,"caption:right");let KQ=(()=>{class n{constructor(){this.imagePath=""}ngOnInit(){""!=this.imagePath&&(this.viewer=new zQ({container:document.querySelector("#viewer"),panorama:"assets/"+this.imagePath,plugins:[rx]}))}ngOnChanges(t){this.viewer&&(this.viewer.destroy(),this.ngOnInit())}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Pi({type:n,selectors:[["app-single-sphere"]],inputs:{imagePath:"imagePath"},features:[io],decls:1,vars:0,consts:[["id","viewer",2,"width","100%","height","95vh"]],template:function(t,i){1&t&&ao(0,"div",0)}}),n})();function JQ(n,e){if(1&n&&ao(0,"app-single-sphere",1),2&n){const t=Ui();Mi("imagePath",t.room+"/"+t.imageName)}}const DO=[{path:"",redirectTo:"/room?room=Hof&imageName=PXL_20230413_164228630.PHOTOSPHERE.jpg",pathMatch:"full"},{path:"room",component:(()=>{class n{constructor(){this.room="",this.imageName=""}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Pi({type:n,selectors:[["app-room"]],inputs:{room:"room",imageName:"imageName"},decls:1,vars:1,consts:[[3,"imagePath",4,"ngIf"],[3,"imagePath"]],template:function(t,i){1&t&&_r(0,JQ,1,1,"app-single-sphere",0),2&t&&Mi("ngIf",""!=i.room&&""!=i.imageName)},dependencies:[Zu,KQ]}),n})()}];let QQ=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=zn({providers:[u9(DO,GI())],imports:[jI.forRoot(DO,{bindToComponentInputs:!0,onSameUrlNavigation:"reload"}),jI]}),n})();function Xs(n){return null!=n&&"false"!=`${n}`}function IO(n,e=0){return function eee(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):e}function RO(n){return Array.isArray(n)?n:[n]}function Vl(n){return n instanceof On?n.nativeElement:n}const tee=["addListener","removeListener"],nee=["addEventListener","removeEventListener"],iee=["on","off"];function sh(n,e,t,i){if(vt(t)&&(i=t,t=void 0),i)return sh(n,e,t).pipe(C0(i));const[r,s]=function oee(n){return vt(n.addEventListener)&&vt(n.removeEventListener)}(n)?nee.map(o=>a=>n[o](e,a,t)):function ree(n){return vt(n.addListener)&&vt(n.removeListener)}(n)?tee.map(PO(n,e)):function see(n){return vt(n.on)&&vt(n.off)}(n)?iee.map(PO(n,e)):[];if(!r&&i_(n))return Rn(o=>sh(o,e,t))(ii(n));if(!r)throw new TypeError("Invalid event target");return new Nt(o=>{const a=(...c)=>o.next(1<c.length?c:c[0]);return r(a),()=>s(a)})}function PO(n,e){return t=>i=>n[t](e,i)}class aee extends ni{constructor(e,t){super()}schedule(e,t=0){return this}}const gg={setInterval(n,e,...t){const{delegate:i}=gg;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=gg;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};class sx extends aee{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,i=0){return gg.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&gg.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,ja(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const oh={schedule(n){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:i}=oh;i&&(e=i.requestAnimationFrame,t=i.cancelAnimationFrame);const r=e(s=>{t=void 0,n(s)});return new ni(()=>t?.(r))},requestAnimationFrame(...n){const{delegate:e}=oh;return(e?.requestAnimationFrame||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:e}=oh;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...n)},delegate:void 0},LO={now:()=>(LO.delegate||Date).now(),delegate:void 0};class ah{constructor(e,t=ah.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}ah.now=LO.now;class ox extends ah{constructor(e,t=ah.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}new class lee extends ox{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class cee extends sx{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=oh.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(oh.cancelAnimationFrame(t),e._scheduled=void 0)}});let ax,dee=1;const _g={};function NO(n){return n in _g&&(delete _g[n],!0)}const hee={setImmediate(n){const e=dee++;return _g[e]=!0,ax||(ax=Promise.resolve()),ax.then(()=>NO(e)&&n()),e},clearImmediate(n){NO(n)}},{setImmediate:fee,clearImmediate:pee}=hee,vg={setImmediate(...n){const{delegate:e}=vg;return(e?.setImmediate||fee)(...n)},clearImmediate(n){const{delegate:e}=vg;return(e?.clearImmediate||pee)(n)},delegate:void 0},cx=(new class gee extends ox{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class mee extends sx{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=vg.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(vg.clearImmediate(t),e._scheduled===t&&(e._scheduled=void 0))}}),new ox(sx)),vee=cx;function OO(n,e=cx){return function yee(n){return sn((e,t)=>{let i=!1,r=null,s=null,o=!1;const a=()=>{if(s?.unsubscribe(),s=null,i){i=!1;const l=r;r=null,t.next(l)}o&&t.complete()},c=()=>{s=null,o&&t.complete()};e.subscribe(Gt(t,l=>{i=!0,r=l,s||ii(n(l)).subscribe(s=Gt(t,a,c))},()=>{o=!0,(!i||!s||s.closed)&&t.complete()}))})}(()=>function wee(n=0,e,t=vee){let i=-1;return null!=e&&(gM(e)?t=e:i=e),new Nt(r=>{let s=function bee(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}(n,e))}function lr(n){return sn((e,t)=>{ii(n).subscribe(Gt(t,()=>t.complete(),qg)),!t.closed&&e.subscribe(t)})}let lx;try{lx=typeof Intl<"u"&&Intl.v8BreakIterator}catch{lx=!1}let ch,bg,ka,ux,Lr=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?function j8(n){return n===f1}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!lx)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(t){return new(t||n)(re(oo))},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function yg(n){return function xee(){if(null==ch&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>ch=!0}))}finally{ch=ch||!1}return ch}()?n:!!n.capture}function lh(){if("object"!=typeof document||!document)return 0;if(null==bg){const n=document.createElement("div"),e=n.style;n.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";const t=document.createElement("div"),i=t.style;i.width="2px",i.height="1px",n.appendChild(t),document.body.appendChild(n),bg=0,0===n.scrollLeft&&(n.scrollLeft=1,bg=0===n.scrollLeft?1:2),n.remove()}return bg}function Hl(n){return n.composedPath?n.composedPath()[0]:n.target}const Cee=new pe("cdk-dir-doc",{providedIn:"root",factory:function Aee(){return _e(Ct)}}),Dee=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let kO=(()=>{class n{constructor(t){this.value="ltr",this.change=new Tn,t&&(this.value=function Iee(n){const e=n?.toLowerCase()||"";return"auto"===e&&typeof navigator<"u"&&navigator?.language?Dee.test(navigator.language)?"rtl":"ltr":"rtl"===e?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}}return n.\u0275fac=function(t){return new(t||n)(re(Cee,8))},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),UO=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=zn({}),n})(),dx=(()=>{class n{constructor(t,i,r){this._ngZone=t,this._platform=i,this._scrolled=new Kt,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new Nt(i=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(OO(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Oe()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){const r=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe(Wn(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(t){const i=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,t)&&i.push(s)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let r=Vl(i),s=t.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>sh(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return n.\u0275fac=function(t){return new(t||n)(re(at),re(Lr),re(Ct,8))},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),uh=(()=>{class n{constructor(t,i,r,s){this.elementRef=t,this.scrollDispatcher=i,this.ngZone=r,this.dir=s,this._destroyed=new Kt,this._elementScrolled=new Nt(o=>this.ngZone.runOutsideAngular(()=>sh(this.elementRef.nativeElement,"scroll").pipe(lr(this._destroyed)).subscribe(o)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const i=this.elementRef.nativeElement,r=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=r?t.end:t.start),null==t.right&&(t.right=r?t.start:t.end),null!=t.bottom&&(t.top=i.scrollHeight-i.clientHeight-t.bottom),r&&0!=lh()?(null!=t.left&&(t.right=i.scrollWidth-i.clientWidth-t.left),2==lh()?t.left=t.right:1==lh()&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=i.scrollWidth-i.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const i=this.elementRef.nativeElement;!function Mee(){if(null==ka){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return ka=!1,ka;if("scrollBehavior"in document.documentElement.style)ka=!0;else{const n=Element.prototype.scrollTo;ka=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return ka}()?(null!=t.top&&(i.scrollTop=t.top),null!=t.left&&(i.scrollLeft=t.left)):i.scrollTo(t)}measureScrollOffset(t){const i="left",r="right",s=this.elementRef.nativeElement;if("top"==t)return s.scrollTop;if("bottom"==t)return s.scrollHeight-s.clientHeight-s.scrollTop;const o=this.dir&&"rtl"==this.dir.value;return"start"==t?t=o?r:i:"end"==t&&(t=o?i:r),o&&2==lh()?t==i?s.scrollWidth-s.clientWidth-s.scrollLeft:s.scrollLeft:o&&1==lh()?t==i?s.scrollLeft+s.scrollWidth-s.clientWidth:-s.scrollLeft:t==i?s.scrollLeft:s.scrollWidth-s.clientWidth-s.scrollLeft}}return n.\u0275fac=function(t){return new(t||n)(oe(On),oe(dx),oe(at),oe(kO,8))},n.\u0275dir=Ln({type:n,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0}),n})(),Lee=(()=>{class n{constructor(t,i,r){this._platform=t,this._change=new Kt,this._changeListener=s=>{this._change.next(s)},this._document=r,i.runOutsideAngular(()=>{if(t.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,i=this._getWindow(),r=t.documentElement,s=r.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||i.scrollY||r.scrollTop||0,left:-s.left||t.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(OO(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return n.\u0275fac=function(t){return new(t||n)(re(Lr),re(at),re(Ct,8))},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),BO=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=zn({}),n})();function VO(n){return Wn((e,t)=>n<=t)}function zO(n,e=Js){return n=n??zee,sn((t,i)=>{let r,s=!0;t.subscribe(Gt(i,o=>{const a=e(o);(s||!n(r,a))&&(s=!1,r=a,i.next(o))}))})}function zee(n,e){return n===e}function HO(n,e=cx){return sn((t,i)=>{let r=null,s=null,o=null;const a=()=>{if(r){r.unsubscribe(),r=null;const l=s;s=null,i.next(l)}};function c(){const l=o+n,u=e.now();if(u<l)return r=this.schedule(void 0,l-u),void i.add(r);a()}t.subscribe(Gt(i,l=>{s=l,o=e.now(),r||(r=e.schedule(c,n),i.add(r))},()=>{a(),i.complete()},void 0,()=>{s=r=null}))})}const GO=new Set;let Ua,Hee=(()=>{class n{constructor(t,i){this._platform=t,this._nonce=i,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Wee}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function Gee(n,e){if(!GO.has(n))try{Ua||(Ua=document.createElement("style"),e&&(Ua.nonce=e),Ua.setAttribute("type","text/css"),document.head.appendChild(Ua)),Ua.sheet&&(Ua.sheet.insertRule(`@media ${n} {body{ }}`,0),GO.add(n))}catch(t){console.error(t)}}(t,this._nonce),this._matchMedia(t)}}return n.\u0275fac=function(t){return new(t||n)(re(Lr),re(bv,8))},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Wee(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let jee=(()=>{class n{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new Kt}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return WO(RO(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let s=yp(WO(RO(t)).map(o=>this._registerQuery(o).observable));return s=wp(s.pipe(Er(1)),s.pipe(VO(1),HO(0))),s.pipe(ut(o=>{const a={matches:!1,breakpoints:{}};return o.forEach(({matches:c,query:l})=>{a.matches=a.matches||c,a.breakpoints[l]=c}),a}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const i=this._mediaMatcher.matchMedia(t),s={observable:new Nt(o=>{const a=c=>this._zone.run(()=>o.next(c));return i.addListener(a),()=>{i.removeListener(a)}}).pipe(xp(i),ut(({matches:o})=>({query:t,matches:o})),lr(this._destroySubject)),mql:i};return this._queries.set(t,s),s}}return n.\u0275fac=function(t){return new(t||n)(re(Hee),re(at))},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function WO(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}let qO=(()=>{class n{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function Yee(n){return!!(n.offsetWidth||n.offsetHeight||"function"==typeof n.getClientRects&&n.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const i=function Xee(n){try{return n.frameElement}catch{return null}}(function ite(n){return n.ownerDocument&&n.ownerDocument.defaultView||window}(t));if(i&&(-1===YO(i)||!this.isVisible(i)))return!1;let r=t.nodeName.toLowerCase(),s=YO(t);return t.hasAttribute("contenteditable")?-1!==s:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function tte(n){let e=n.nodeName.toLowerCase(),t="input"===e&&n.type;return"text"===t||"password"===t||"select"===e||"textarea"===e}(t))&&("audio"===r?!!t.hasAttribute("controls")&&-1!==s:"video"===r?-1!==s&&(null!==s||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,i){return function nte(n){return!function Kee(n){return function Qee(n){return"input"==n.nodeName.toLowerCase()}(n)&&"hidden"==n.type}(n)&&(function Zee(n){let e=n.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(n)||function Jee(n){return function ete(n){return"a"==n.nodeName.toLowerCase()}(n)&&n.hasAttribute("href")}(n)||n.hasAttribute("contenteditable")||XO(n))}(t)&&!this.isDisabled(t)&&(i?.ignoreVisibility||this.isVisible(t))}}return n.\u0275fac=function(t){return new(t||n)(re(Lr))},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function XO(n){if(!n.hasAttribute("tabindex")||void 0===n.tabIndex)return!1;let e=n.getAttribute("tabindex");return!(!e||isNaN(parseInt(e,10)))}function YO(n){if(!XO(n))return null;const e=parseInt(n.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class rte{get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}constructor(e,t,i,r,s=!1){this._element=e,this._checker=t,this._ngZone=i,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}destroy(){const e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),t&&(t.removeEventListener("focus",this.endAnchorListener),t.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){const t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(!this._checker.isFocusable(t)){const i=this._getFirstTabbableElement(t);return i?.focus(e),!!i}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){const t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){const t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let i=0;i<t.length;i++){const r=t[i].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[i]):null;if(r)return r}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let i=t.length-1;i>=0;i--){const r=t[i].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[i]):null;if(r)return r}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._ngZone.isStable?e():this._ngZone.onStable.pipe(Er(1)).subscribe(e)}}let ste=(()=>{class n{constructor(t,i,r){this._checker=t,this._ngZone=i,this._document=r}create(t,i=!1){return new rte(t,this._checker,this._ngZone,this._document,i)}}return n.\u0275fac=function(t){return new(t||n)(re(qO),re(at),re(Ct))},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function ZO(n){return 0===n.buttons||0===n.offsetX&&0===n.offsetY}function KO(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}const ote=new pe("cdk-input-modality-detector-options"),ate={ignoreKeys:[18,17,224,91,16]},Gl=yg({passive:!0,capture:!0});let cte=(()=>{class n{get mostRecentModality(){return this._modality.value}constructor(t,i,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new ir(null),this._lastTouchMs=0,this._onKeydown=o=>{this._options?.ignoreKeys?.some(a=>a===o.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Hl(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(ZO(o)?"keyboard":"mouse"),this._mostRecentTarget=Hl(o))},this._onTouchstart=o=>{KO(o)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Hl(o))},this._options={...ate,...s},this.modalityDetected=this._modality.pipe(VO(1)),this.modalityChanged=this.modalityDetected.pipe(zO()),t.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,Gl),r.addEventListener("mousedown",this._onMousedown,Gl),r.addEventListener("touchstart",this._onTouchstart,Gl)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Gl),document.removeEventListener("mousedown",this._onMousedown,Gl),document.removeEventListener("touchstart",this._onTouchstart,Gl))}}return n.\u0275fac=function(t){return new(t||n)(re(Lr),re(at),re(Ct),re(ote,8))},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const ute=new pe("cdk-focus-monitor-default-options"),wg=yg({passive:!0,capture:!0});let QO=(()=>{class n{constructor(t,i,r,s,o){this._ngZone=t,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Kt,this._rootNodeFocusAndBlurListener=a=>{for(let l=Hl(a);l;l=l.parentElement)"focus"===a.type?this._onFocus(a,l):this._onBlur(a,l)},this._document=s,this._detectionMode=o?.detectionMode||0}monitor(t,i=!1){const r=Vl(t);if(!this._platform.isBrowser||1!==r.nodeType)return Oe(null);const s=function See(n){if(function Eee(){if(null==ux){const n=typeof document<"u"?document.head:null;ux=!(!n||!n.createShadowRoot&&!n.attachShadow)}return ux}()){const e=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(r)||this._getDocument(),o=this._elementInfo.get(r);if(o)return i&&(o.checkChildren=!0),o.subject;const a={checkChildren:i,subject:new Kt,rootNode:s};return this._elementInfo.set(r,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(t){const i=Vl(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){const s=Vl(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([a,c])=>this._originChanged(a,i,c)):(this._setOrigin(i),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,i){t.classList.toggle("cdk-focused",!!i),t.classList.toggle("cdk-touch-focused","touch"===i),t.classList.toggle("cdk-keyboard-focused","keyboard"===i),t.classList.toggle("cdk-mouse-focused","mouse"===i),t.classList.toggle("cdk-program-focused","program"===i)}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&i,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,i){const r=this._elementInfo.get(i),s=Hl(t);!r||!r.checkChildren&&i!==s||this._originChanged(i,this._getFocusOrigin(s),r)}_onBlur(t,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r,null))}_emitOrigin(t,i){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,wg),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,wg)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(lr(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,wg),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,wg),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){const i=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&i.push([s,r])}),i}_isLastInteractionFromInputLabel(t){const{_mostRecentTarget:i,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!i||i===t||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName||t.disabled)return!1;const s=t.labels;if(s)for(let o=0;o<s.length;o++)if(s[o].contains(i))return!0;return!1}}return n.\u0275fac=function(t){return new(t||n)(re(at),re(Lr),re(cte),re(Ct,8),re(ute,8))},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const eF="cdk-high-contrast-black-on-white",tF="cdk-high-contrast-white-on-black",hx="cdk-high-contrast-active";let dte=(()=>{class n{constructor(t,i){this._platform=t,this._document=i,this._breakpointSubscription=_e(jee).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(hx,eF,tF),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?t.add(hx,eF):2===i&&t.add(hx,tF)}}}return n.\u0275fac=function(t){return new(t||n)(re(Lr),re(Ct))},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const fte=new pe("mat-sanity-checks",{providedIn:"root",factory:function hte(){return!0}});let Oo=(()=>{class n{constructor(t,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!function Tee(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}}return n.\u0275fac=function(t){return new(t||n)(re(dte),re(fte,8),re(Ct))},n.\u0275mod=Yn({type:n}),n.\u0275inj=zn({imports:[UO,UO]}),n})();function pte(n){return class extends n{get disabled(){return this._disabled}set disabled(e){this._disabled=Xs(e)}constructor(...e){super(...e),this._disabled=!1}}}function rF(n,e){return class extends n{get color(){return this._color}set color(t){const i=t||this.defaultColor;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),i&&this._elementRef.nativeElement.classList.add(`mat-${i}`),this._color=i)}constructor(...t){super(...t),this.defaultColor=e,this.color=e}}}function mte(n){return class extends n{get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=Xs(e)}constructor(...e){super(...e),this._disableRipple=!1}}}class _te{constructor(e,t,i,r=!1){this._renderer=e,this.element=t,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const sF=yg({passive:!0,capture:!0});class vte{constructor(){this._events=new Map,this._delegateEventHandler=e=>{const t=Hl(e);t&&this._events.get(e.type)?.forEach((i,r)=>{(r===t||r.contains(t))&&i.forEach(s=>s.handleEvent(e))})}}addHandler(e,t,i,r){const s=this._events.get(t);if(s){const o=s.get(i);o?o.add(r):s.set(i,new Set([r]))}else this._events.set(t,new Map([[i,new Set([r])]])),e.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,sF)})}removeHandler(e,t,i){const r=this._events.get(e);if(!r)return;const s=r.get(t);s&&(s.delete(i),0===s.size&&r.delete(t),0===r.size&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,sF)))}}const oF={enterDuration:225,exitDuration:150},aF=yg({passive:!0,capture:!0}),cF=["mousedown","touchstart"],lF=["mouseup","mouseleave","touchend","touchcancel"];class Wl{constructor(e,t,i,r){this._target=e,this._ngZone=t,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=Vl(i))}fadeInRipple(e,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s={...oF,...i.animation};i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const o=i.radius||function bte(n,e,t){const i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+r*r)}(e,t,r),a=e-r.left,c=t-r.top,l=s.enterDuration,u=document.createElement("div");u.classList.add("mat-ripple-element"),u.style.left=a-o+"px",u.style.top=c-o+"px",u.style.height=2*o+"px",u.style.width=2*o+"px",null!=i.color&&(u.style.backgroundColor=i.color),u.style.transitionDuration=`${l}ms`,this._containerElement.appendChild(u);const d=window.getComputedStyle(u),f=d.transitionDuration,p="none"===d.transitionProperty||"0s"===f||"0s, 0s"===f||0===r.width&&0===r.height,_=new _te(this,u,i,p);u.style.transform="scale3d(1, 1, 1)",_.state=0,i.persistent||(this._mostRecentTransientRipple=_);let g=null;return!p&&(l||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const m=()=>this._finishRippleTransition(_),y=()=>this._destroyRipple(_);u.addEventListener("transitionend",m),u.addEventListener("transitioncancel",y),g={onTransitionEnd:m,onTransitionCancel:y}}),this._activeRipples.set(_,g),(p||!l)&&this._finishRippleTransition(_),_}fadeOutRipple(e){if(2===e.state||3===e.state)return;const t=e.element,i={...oF,...e.config.animation};t.style.transitionDuration=`${i.exitDuration}ms`,t.style.opacity="0",e.state=2,(e._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=Vl(e);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,cF.forEach(i=>{Wl._eventManager.addHandler(this._ngZone,i,t,this)}))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{lF.forEach(t=>{this._triggerElement.addEventListener(t,this,aF)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){0===e.state?this._startFadeOutTransition(e):2===e.state&&this._destroyRipple(e)}_startFadeOutTransition(e){const t=e===this._mostRecentTransientRipple,{persistent:i}=e.config;e.state=1,!i&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){const t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=3,null!==t&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel)),e.element.remove()}_onMousedown(e){const t=ZO(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!KO(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const e=this._triggerElement;e&&(cF.forEach(t=>Wl._eventManager.removeHandler(t,e,this)),this._pointerUpEventsRegistered&&lF.forEach(t=>e.removeEventListener(t,this,aF)))}}Wl._eventManager=new vte;const uF=new pe("mat-ripple-global-options");let wte=(()=>{class n{get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}constructor(t,i,r,s,o){this._elementRef=t,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new Wl(this,i,t,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,i,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...t})}}return n.\u0275fac=function(t){return new(t||n)(oe(On),oe(at),oe(Lr),oe(uF,8),oe(_c,8))},n.\u0275dir=Ln({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,i){2&t&&er("mat-ripple-unbounded",i.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),n})(),xte=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=zn({imports:[Oo,Oo]}),n})();class dF{}class Mte{}const Ys="*";function Ete(n,e){return{type:7,name:n,definitions:e,options:{}}}function hF(n,e=null){return{type:4,styles:e,timings:n}}function fF(n,e=null){return{type:2,steps:n,options:e}}function xg(n){return{type:6,styles:n,offset:null}}function pF(n,e,t){return{type:0,name:n,styles:e,options:t}}function mF(n,e,t=null){return{type:1,expr:n,animation:e,options:t}}function gF(n){Promise.resolve().then(n)}class hh{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){gF(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class _F{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,i=0,r=0;const s=this.players.length;0==s?gF(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++i==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const e=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}const fx="!",Mg=["*"],Ste=["content"];function Tte(n,e){if(1&n){const t=Rc();fn(0,"div",2),co("click",function(){return nc(t),ic(Ui()._onBackdropClicked())}),Fn()}2&n&&er("mat-drawer-shown",Ui()._isShowingBackdrop())}function Cte(n,e){1&n&&(fn(0,"mat-drawer-content"),oi(1,2),Fn())}const Ate=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],Dte=["mat-drawer","mat-drawer-content","*"];function Ite(n,e){if(1&n){const t=Rc();fn(0,"div",2),co("click",function(){return nc(t),ic(Ui()._onBackdropClicked())}),Fn()}2&n&&er("mat-drawer-shown",Ui()._isShowingBackdrop())}function Rte(n,e){1&n&&(fn(0,"mat-sidenav-content"),oi(1,2),Fn())}const Pte=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],Lte=["mat-sidenav","mat-sidenav-content","*"],vF={transformDrawer:Ete("transform",[pF("open, open-instant",xg({transform:"none",visibility:"visible"})),pF("void",xg({"box-shadow":"none",visibility:"hidden"})),mF("void => open-instant",hF("0ms")),mF("void <=> open, open-instant => void",hF("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},Ote=new pe("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function Fte(){return!1}}),px=new pe("MAT_DRAWER_CONTAINER");let Eg=(()=>{class n extends uh{constructor(t,i,r,s,o){super(r,s,o),this._changeDetectorRef=t,this._container=i}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return n.\u0275fac=function(t){return new(t||n)(oe(Bc),oe(Kl(()=>bF)),oe(On),oe(dx),oe(at))},n.\u0275cmp=Pi({type:n,selectors:[["mat-drawer-content"]],hostAttrs:["ngSkipHydration","true",1,"mat-drawer-content"],hostVars:4,hostBindings:function(t,i){2&t&&Fu("margin-left",i._container._contentMargins.left,"px")("margin-right",i._container._contentMargins.right,"px")},features:[Gu([{provide:uh,useExisting:n}]),bs],ngContentSelectors:Mg,decls:1,vars:0,template:function(t,i){1&t&&(ws(),oi(0))},encapsulation:2,changeDetection:0}),n})(),yF=(()=>{class n{get position(){return this._position}set position(t){(t="end"===t?"end":"start")!==this._position&&(this._isAttached&&this._updatePositionInParent(t),this._position=t,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(t){this._mode=t,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(t){this._disableClose=Xs(t)}get autoFocus(){return this._autoFocus??("side"===this.mode?"dialog":"first-tabbable")}set autoFocus(t){("true"===t||"false"===t||null==t)&&(t=Xs(t)),this._autoFocus=t}get opened(){return this._opened}set opened(t){this.toggle(Xs(t))}constructor(t,i,r,s,o,a,c,l){this._elementRef=t,this._focusTrapFactory=i,this._focusMonitor=r,this._platform=s,this._ngZone=o,this._interactivityChecker=a,this._doc=c,this._container=l,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new Kt,this._animationEnd=new Kt,this._animationState="void",this.openedChange=new Tn(!0),this._openedStream=this.openedChange.pipe(Wn(u=>u),ut(()=>{})),this.openedStart=this._animationStarted.pipe(Wn(u=>u.fromState!==u.toState&&0===u.toState.indexOf("open")),I0(void 0)),this._closedStream=this.openedChange.pipe(Wn(u=>!u),ut(()=>{})),this.closedStart=this._animationStarted.pipe(Wn(u=>u.fromState!==u.toState&&"void"===u.toState),I0(void 0)),this._destroyed=new Kt,this.onPositionChanged=new Tn,this._modeChanged=new Kt,this.openedChange.subscribe(u=>{u?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{sh(this._elementRef.nativeElement,"keydown").pipe(Wn(u=>27===u.keyCode&&!this.disableClose&&!function Vee(n,...e){return e.length?e.some(t=>n[t]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}(u)),lr(this._destroyed)).subscribe(u=>this._ngZone.run(()=>{this.close(),u.stopPropagation(),u.preventDefault()}))}),this._animationEnd.pipe(zO((u,d)=>u.fromState===d.fromState&&u.toState===d.toState)).subscribe(u=>{const{fromState:d,toState:h}=u;(0===h.indexOf("open")&&"void"===d||"void"===h&&0===d.indexOf("open"))&&this.openedChange.emit(this._opened)})}_forceFocus(t,i){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{t.removeEventListener("blur",r),t.removeEventListener("mousedown",r),t.removeAttribute("tabindex")};t.addEventListener("blur",r),t.addEventListener("mousedown",r)})),t.focus(i)}_focusByCssSelector(t,i){let r=this._elementRef.nativeElement.querySelector(t);r&&this._forceFocus(r,i)}_takeFocus(){if(!this._focusTrap)return;const t=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(i=>{!i&&"function"==typeof this._elementRef.nativeElement.focus&&t.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus)}}_restoreFocus(t){"dialog"!==this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,t):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){const t=this._doc.activeElement;return!!t&&this._elementRef.nativeElement.contains(t)}ngAfterViewInit(){this._isAttached=!0,this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState(),"end"===this._position&&this._updatePositionInParent("end")}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap&&this._focusTrap.destroy(),this._anchor?.remove(),this._anchor=null,this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(t){return this.toggle(!0,t)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(t=!this.opened,i){t&&i&&(this._openedVia=i);const r=this._setOpen(t,!t&&this._isFocusWithinDrawer(),this._openedVia||"program");return t||(this._openedVia=null),r}_setOpen(t,i,r){return this._opened=t,t?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",i&&this._restoreFocus(r)),this._updateFocusTrapState(),new Promise(s=>{this.openedChange.pipe(Er(1)).subscribe(o=>s(o?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}_updatePositionInParent(t){const i=this._elementRef.nativeElement,r=i.parentNode;"end"===t?(this._anchor||(this._anchor=this._doc.createComment("mat-drawer-anchor"),r.insertBefore(this._anchor,i)),r.appendChild(i)):this._anchor&&this._anchor.parentNode.insertBefore(i,this._anchor)}}return n.\u0275fac=function(t){return new(t||n)(oe(On),oe(ste),oe(QO),oe(Lr),oe(at),oe(qO),oe(Ct,8),oe(px,8))},n.\u0275cmp=Pi({type:n,selectors:[["mat-drawer"]],viewQuery:function(t,i){if(1&t&&Kf(Ste,5),2&t){let r;Ms(r=Es())&&(i._content=r.first)}},hostAttrs:["tabIndex","-1","ngSkipHydration","true",1,"mat-drawer"],hostVars:12,hostBindings:function(t,i){1&t&&ny("@transform.start",function(s){return i._animationStarted.next(s)})("@transform.done",function(s){return i._animationEnd.next(s)}),2&t&&(Qo("align",null),ly("@transform",i._animationState),er("mat-drawer-end","end"===i.position)("mat-drawer-over","over"===i.mode)("mat-drawer-push","push"===i.mode)("mat-drawer-side","side"===i.mode)("mat-drawer-opened",i.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:Mg,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(t,i){1&t&&(ws(),fn(0,"div",0,1),oi(2),Fn())},dependencies:[uh],encapsulation:2,data:{animation:[vF.transformDrawer]},changeDetection:0}),n})(),bF=(()=>{class n{get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(t){this._autosize=Xs(t)}get hasBackdrop(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride}set hasBackdrop(t){this._backdropOverride=null==t?null:Xs(t)}get scrollable(){return this._userContent||this._content}constructor(t,i,r,s,o,a=!1,c){this._dir=t,this._element=i,this._ngZone=r,this._changeDetectorRef=s,this._animationMode=c,this._drawers=new Yf,this.backdropClick=new Tn,this._destroyed=new Kt,this._doCheckSubject=new Kt,this._contentMargins={left:null,right:null},this._contentMarginChanges=new Kt,t&&t.change.pipe(lr(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),o.change().pipe(lr(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=a}ngAfterContentInit(){this._allDrawers.changes.pipe(xp(this._allDrawers),lr(this._destroyed)).subscribe(t=>{this._drawers.reset(t.filter(i=>!i._container||i._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(xp(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(t=>{this._watchDrawerToggle(t),this._watchDrawerPosition(t),this._watchDrawerMode(t)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe(HO(10),lr(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(t=>t.open())}close(){this._drawers.forEach(t=>t.close())}updateContentMargins(){let t=0,i=0;if(this._left&&this._left.opened)if("side"==this._left.mode)t+=this._left._getWidth();else if("push"==this._left.mode){const r=this._left._getWidth();t+=r,i-=r}if(this._right&&this._right.opened)if("side"==this._right.mode)i+=this._right._getWidth();else if("push"==this._right.mode){const r=this._right._getWidth();i+=r,t-=r}t=t||null,i=i||null,(t!==this._contentMargins.left||i!==this._contentMargins.right)&&(this._contentMargins={left:t,right:i},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(t){t._animationStarted.pipe(Wn(i=>i.fromState!==i.toState),lr(this._drawers.changes)).subscribe(i=>{"open-instant"!==i.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==t.mode&&t.openedChange.pipe(lr(this._drawers.changes)).subscribe(()=>this._setContainerClass(t.opened))}_watchDrawerPosition(t){t&&t.onPositionChanged.pipe(lr(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe(Er(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(t){t&&t._modeChanged.pipe(lr(wM(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(t){const i=this._element.nativeElement.classList,r="mat-drawer-container-has-open";t?i.add(r):i.remove(r)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(t=>{"end"==t.position?this._end=t:this._start=t}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(t=>t&&!t.disableClose&&this._canHaveBackdrop(t)).forEach(t=>t._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(t){return"side"!==t.mode||!!this._backdropOverride}_isDrawerOpen(t){return null!=t&&t.opened}}return n.\u0275fac=function(t){return new(t||n)(oe(kO,8),oe(On),oe(at),oe(Bc),oe(Lee),oe(Ote),oe(_c,8))},n.\u0275cmp=Pi({type:n,selectors:[["mat-drawer-container"]],contentQueries:function(t,i,r){if(1&t&&(Fc(r,Eg,5),Fc(r,yF,5)),2&t){let s;Ms(s=Es())&&(i._content=s.first),Ms(s=Es())&&(i._allDrawers=s)}},viewQuery:function(t,i){if(1&t&&Kf(Eg,5),2&t){let r;Ms(r=Es())&&(i._userContent=r.first)}},hostAttrs:["ngSkipHydration","true",1,"mat-drawer-container"],hostVars:2,hostBindings:function(t,i){2&t&&er("mat-drawer-container-explicit-backdrop",i._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[Gu([{provide:px,useExisting:n}])],ngContentSelectors:Dte,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,i){1&t&&(ws(Ate),_r(0,Tte,1,2,"div",0),oi(1),oi(2,1),_r(3,Cte,2,0,"mat-drawer-content",1)),2&t&&(Mi("ngIf",i.hasBackdrop),gr(3),Mi("ngIf",!i._content))},dependencies:[Zu,Eg],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),n})(),mx=(()=>{class n extends Eg{constructor(t,i,r,s,o){super(t,i,r,s,o)}}return n.\u0275fac=function(t){return new(t||n)(oe(Bc),oe(Kl(()=>wF)),oe(On),oe(dx),oe(at))},n.\u0275cmp=Pi({type:n,selectors:[["mat-sidenav-content"]],hostAttrs:["ngSkipHydration","true",1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(t,i){2&t&&Fu("margin-left",i._container._contentMargins.left,"px")("margin-right",i._container._contentMargins.right,"px")},features:[Gu([{provide:uh,useExisting:n}]),bs],ngContentSelectors:Mg,decls:1,vars:0,template:function(t,i){1&t&&(ws(),oi(0))},encapsulation:2,changeDetection:0}),n})(),gx=(()=>{class n extends yF{constructor(){super(...arguments),this._fixedInViewport=!1,this._fixedTopGap=0,this._fixedBottomGap=0}get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(t){this._fixedInViewport=Xs(t)}get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(t){this._fixedTopGap=IO(t)}get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(t){this._fixedBottomGap=IO(t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=Qh(n)))(i||n)}}(),n.\u0275cmp=Pi({type:n,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1","ngSkipHydration","true",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(t,i){2&t&&(Qo("align",null),Fu("top",i.fixedInViewport?i.fixedTopGap:null,"px")("bottom",i.fixedInViewport?i.fixedBottomGap:null,"px"),er("mat-drawer-end","end"===i.position)("mat-drawer-over","over"===i.mode)("mat-drawer-push","push"===i.mode)("mat-drawer-side","side"===i.mode)("mat-drawer-opened",i.opened)("mat-sidenav-fixed",i.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[bs],ngContentSelectors:Mg,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(t,i){1&t&&(ws(),fn(0,"div",0,1),oi(2),Fn())},dependencies:[uh],encapsulation:2,data:{animation:[vF.transformDrawer]},changeDetection:0}),n})(),wF=(()=>{class n extends bF{constructor(){super(...arguments),this._allDrawers=void 0,this._content=void 0}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=Qh(n)))(i||n)}}(),n.\u0275cmp=Pi({type:n,selectors:[["mat-sidenav-container"]],contentQueries:function(t,i,r){if(1&t&&(Fc(r,mx,5),Fc(r,gx,5)),2&t){let s;Ms(s=Es())&&(i._content=s.first),Ms(s=Es())&&(i._allDrawers=s)}},hostAttrs:["ngSkipHydration","true",1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(t,i){2&t&&er("mat-drawer-container-explicit-backdrop",i._backdropOverride)},exportAs:["matSidenavContainer"],features:[Gu([{provide:px,useExisting:n}]),bs],ngContentSelectors:Lte,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,i){1&t&&(ws(Pte),_r(0,Ite,1,2,"div",0),oi(1),oi(2,1),_r(3,Rte,2,0,"mat-sidenav-content",1)),2&t&&(Mi("ngIf",i.hasBackdrop),gr(3),Mi("ngIf",!i._content))},dependencies:[Zu,mx],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),n})(),kte=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=zn({imports:[h1,Oo,BO,BO,Oo]}),n})();class Sg{}class _x{}class as{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),o=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{let r;if(r="string"==typeof i?[i]:"number"==typeof i?[i.toString()]:i.map(s=>s.toString()),r.length>0){const s=t.toLowerCase();this.headers.set(s,r),this.maybeSetNormalizedName(t,s)}})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof as?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new as;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof as?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class Ute{encodeKey(e){return xF(e)}encodeValue(e){return xF(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const Vte=/%(\d[a-f0-9])/gi,zte={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function xF(n){return encodeURIComponent(n).replace(Vte,(e,t)=>zte[t]??e)}function Tg(n){return`${n}`}class Fo{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Ute,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Bte(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],c=t.get(o)||[];c.push(a),t.set(o,c)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t],r=Array.isArray(i)?i.map(Tg):[Tg(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Fo({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(Tg(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(Tg(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class Hte{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function MF(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function EF(n){return typeof Blob<"u"&&n instanceof Blob}function SF(n){return typeof FormData<"u"&&n instanceof FormData}class fh{constructor(e,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function Gte(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new as),this.context||(this.context=new Hte),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new Fo,this.urlWithParams=t}serializeBody(){return null===this.body?null:MF(this.body)||EF(this.body)||SF(this.body)||function Wte(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Fo?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||SF(this.body)?null:EF(this.body)?this.body.type||null:MF(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Fo?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let c=e.headers||this.headers,l=e.params||this.params;const u=e.context??this.context;return void 0!==e.setHeaders&&(c=Object.keys(e.setHeaders).reduce((d,h)=>d.set(h,e.setHeaders[h]),c)),e.setParams&&(l=Object.keys(e.setParams).reduce((d,h)=>d.set(h,e.setParams[h]),l)),new fh(t,i,s,{params:l,headers:c,context:u,reportProgress:a,responseType:r,withCredentials:o})}}var vn=(()=>((vn=vn||{})[vn.Sent=0]="Sent",vn[vn.UploadProgress=1]="UploadProgress",vn[vn.ResponseHeader=2]="ResponseHeader",vn[vn.DownloadProgress=3]="DownloadProgress",vn[vn.Response=4]="Response",vn[vn.User=5]="User",vn))();class vx{constructor(e,t=200,i="OK"){this.headers=e.headers||new as,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class yx extends vx{constructor(e={}){super(e),this.type=vn.ResponseHeader}clone(e={}){return new yx({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class jl extends vx{constructor(e={}){super(e),this.type=vn.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new jl({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class TF extends vx{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function bx(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let Cg=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof fh)s=t;else{let c,l;c=r.headers instanceof as?r.headers:new as(r.headers),r.params&&(l=r.params instanceof Fo?r.params:new Fo({fromObject:r.params})),s=new fh(t,i,void 0!==r.body?r.body:null,{headers:c,context:r.context,params:l,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const o=Oe(s).pipe(Hc(c=>this.handler.handle(c)));if(t instanceof fh||"events"===r.observe)return o;const a=o.pipe(Wn(c=>c instanceof jl));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(ut(c=>{if(null!==c.body&&!(c.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return c.body}));case"blob":return a.pipe(ut(c=>{if(null!==c.body&&!(c.body instanceof Blob))throw new Error("Response is not a Blob.");return c.body}));case"text":return a.pipe(ut(c=>{if(null!==c.body&&"string"!=typeof c.body)throw new Error("Response is not a string.");return c.body}));default:return a.pipe(ut(c=>c.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new Fo).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,bx(r,i))}post(t,i,r={}){return this.request("POST",t,bx(r,i))}put(t,i,r={}){return this.request("PUT",t,bx(r,i))}}return n.\u0275fac=function(t){return new(t||n)(re(Sg))},n.\u0275prov=xe({token:n,factory:n.\u0275fac}),n})();function CF(n,e){return e(n)}function jte(n,e){return(t,i)=>e.intercept(t,{handle:r=>n(r,i)})}const qte=new pe(""),ph=new pe(""),AF=new pe("");function Xte(){let n=null;return(e,t)=>(null===n&&(n=(_e(qte,{optional:!0})??[]).reduceRight(jte,CF)),n(e,t))}let DF=(()=>{class n extends Sg{constructor(t,i){super(),this.backend=t,this.injector=i,this.chain=null}handle(t){if(null===this.chain){const i=Array.from(new Set([...this.injector.get(ph),...this.injector.get(AF,[])]));this.chain=i.reduceRight((r,s)=>function $te(n,e,t){return(i,r)=>t.runInContext(()=>e(i,s=>n(s,r)))}(r,s,this.injector),CF)}return this.chain(t,i=>this.backend.handle(i))}}return n.\u0275fac=function(t){return new(t||n)(re(_x),re(Gr))},n.\u0275prov=xe({token:n,factory:n.\u0275fac}),n})();const Jte=/^\)\]\}',?\n/;let RF=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");const i=this.xhrFactory;return(i.\u0275loadImpl?Pn(i.\u0275loadImpl()):Oe(null)).pipe(Kr(()=>new Nt(s=>{const o=i.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((y,v)=>o.setRequestHeader(y,v.join(","))),t.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const y=t.detectContentTypeHeader();null!==y&&o.setRequestHeader("Content-Type",y)}if(t.responseType){const y=t.responseType.toLowerCase();o.responseType="json"!==y?y:"text"}const a=t.serializeBody();let c=null;const l=()=>{if(null!==c)return c;const y=o.statusText||"OK",v=new as(o.getAllResponseHeaders()),b=function Qte(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(o)||t.url;return c=new yx({headers:v,status:o.status,statusText:y,url:b}),c},u=()=>{let{headers:y,status:v,statusText:b,url:x}=l(),E=null;204!==v&&(E=typeof o.response>"u"?o.responseText:o.response),0===v&&(v=E?200:0);let T=v>=200&&v<300;if("json"===t.responseType&&"string"==typeof E){const P=E;E=E.replace(Jte,"");try{E=""!==E?JSON.parse(E):null}catch(w){E=P,T&&(T=!1,E={error:w,text:E})}}T?(s.next(new jl({body:E,headers:y,status:v,statusText:b,url:x||void 0})),s.complete()):s.error(new TF({error:E,headers:y,status:v,statusText:b,url:x||void 0}))},d=y=>{const{url:v}=l(),b=new TF({error:y,status:o.status||0,statusText:o.statusText||"Unknown Error",url:v||void 0});s.error(b)};let h=!1;const f=y=>{h||(s.next(l()),h=!0);let v={type:vn.DownloadProgress,loaded:y.loaded};y.lengthComputable&&(v.total=y.total),"text"===t.responseType&&o.responseText&&(v.partialText=o.responseText),s.next(v)},p=y=>{let v={type:vn.UploadProgress,loaded:y.loaded};y.lengthComputable&&(v.total=y.total),s.next(v)};let _;o.addEventListener("load",u),o.addEventListener("error",d),o.addEventListener("timeout",d),o.addEventListener("abort",d),t.reportProgress&&(o.addEventListener("progress",f),null!==a&&o.upload&&o.upload.addEventListener("progress",p));const g=()=>{_??=function tne(){const n=setTimeout(()=>{},ene);return()=>clearTimeout(n)}()},m=()=>{_?.()};return o.addEventListener("loadstart",g),o.addEventListener("loadend",m),o.send(a),s.next({type:vn.Sent}),()=>{o.removeEventListener("loadstart",g),o.removeEventListener("loadend",m),o.removeEventListener("error",d),o.removeEventListener("abort",d),o.removeEventListener("load",u),o.removeEventListener("timeout",d),_?.(),t.reportProgress&&(o.removeEventListener("progress",f),null!==a&&o.upload&&o.upload.removeEventListener("progress",p)),o.readyState!==o.DONE&&o.abort()}})))}}return n.\u0275fac=function(t){return new(t||n)(re(g1))},n.\u0275prov=xe({token:n,factory:n.\u0275fac}),n})();const ene=2147483647,wx=new pe("XSRF_ENABLED"),PF=new pe("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),LF=new pe("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class NF{}let rne=(()=>{class n{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=n1(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return n.\u0275fac=function(t){return new(t||n)(re(Ct),re(oo),re(PF))},n.\u0275prov=xe({token:n,factory:n.\u0275fac}),n})();function sne(n,e){const t=n.url.toLowerCase();if(!_e(wx)||"GET"===n.method||"HEAD"===n.method||t.startsWith("http://")||t.startsWith("https://"))return e(n);const i=_e(NF).getToken(),r=_e(LF);return null!=i&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,i)})),e(n)}var un=(()=>((un=un||{})[un.Interceptors=0]="Interceptors",un[un.LegacyInterceptors=1]="LegacyInterceptors",un[un.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",un[un.NoXsrfProtection=3]="NoXsrfProtection",un[un.JsonpSupport=4]="JsonpSupport",un[un.RequestsMadeViaParent=5]="RequestsMadeViaParent",un))();function $l(n,e){return{\u0275kind:n,\u0275providers:e}}function one(...n){const e=[Cg,RF,DF,{provide:Sg,useExisting:DF},{provide:_x,useExisting:RF},{provide:ph,useValue:sne,multi:!0},{provide:wx,useValue:!0},{provide:NF,useClass:rne}];for(const t of n)e.push(...t.\u0275providers);return vf(e)}const OF=new pe("LEGACY_INTERCEPTOR_FN");let cne=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=zn({providers:[one($l(un.LegacyInterceptors,[{provide:OF,useFactory:Xte},{provide:ph,useExisting:OF,multi:!0}]))]}),n})();const pne=["mat-button",""],mne=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],gne=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],FF={capture:!0},kF=["focus","click","mouseenter","touchstart"],gh="mat-button-ripple-uninitialized";let _ne=(()=>{class n{constructor(){this._document=_e(Ct,{optional:!0}),this._animationMode=_e(_c,{optional:!0}),this._globalRippleOptions=_e(uF,{optional:!0}),this._platform=_e(Lr),this._ngZone=_e(at),this._onInteraction=t=>{if(t.target===this._document)return;const r=t.target.closest(`[${gh}]`);r&&(r.removeAttribute(gh),this._appendRipple(r))},this._ngZone.runOutsideAngular(()=>{for(const t of kF)this._document?.addEventListener(t,this._onInteraction,FF)})}ngOnDestroy(){for(const t of kF)this._document?.removeEventListener(t,this._onInteraction,FF)}_appendRipple(t){if(!this._document)return;const i=this._document.createElement("span");i.classList.add("mat-mdc-button-ripple");const r=new vne(t,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);r.rippleConfig.centered=t.hasAttribute("mat-icon-button"),new Wl(r,this._ngZone,i,this._platform).setupTriggerEvents(t),t.append(i)}_createMatRipple(t){if(!this._document)return;t.querySelector(".mat-mdc-button-ripple")?.remove(),t.removeAttribute(gh);const i=this._document.createElement("span");i.classList.add("mat-mdc-button-ripple");const r=new wte(new On(i),this._ngZone,this._platform,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);return r._isInitialized=!0,r.trigger=t,t.append(i),r}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class vne{constructor(e,t,i){this._button=e,this._globalRippleOptions=t,this._setRippleConfig(t,i)}_setRippleConfig(e,t){this.rippleConfig=e||{},"NoopAnimations"===t&&(this.rippleConfig.animation={enterDuration:0,exitDuration:0})}get rippleDisabled(){return this._button.hasAttribute("disabled")||!!this._globalRippleOptions?.disabled}}const yne=[{selector:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{selector:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{selector:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{selector:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{selector:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{selector:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{selector:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],bne=rF(pte(mte(class{constructor(n){this._elementRef=n}})));let wne=(()=>{class n extends bne{get ripple(){return!this._ripple&&this._rippleLoader&&(this._ripple=this._rippleLoader._createMatRipple(this._elementRef.nativeElement)),this._ripple}set ripple(t){this._ripple=t}constructor(t,i,r,s){super(t),this._platform=i,this._ngZone=r,this._animationMode=s,this._focusMonitor=_e(QO),this._rippleLoader=_e(_ne),this._isFab=!1;const o=t.nativeElement.classList;for(const a of yne)this._hasHostAttributes(a.selector)&&a.mdcClasses.forEach(c=>{o.add(c)})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(t="program",i){t?this._focusMonitor.focusVia(this._elementRef.nativeElement,t,i):this._elementRef.nativeElement.focus(i)}_hasHostAttributes(...t){return t.some(i=>this._elementRef.nativeElement.hasAttribute(i))}_isRippleDisabled(){this._ripple&&(this._ripple.disabled=this.disableRipple||this.disabled)}}return n.\u0275fac=function(t){Lv()},n.\u0275dir=Ln({type:n,features:[bs]}),n})(),Mne=(()=>{class n extends wne{constructor(t,i,r,s){super(t,i,r,s)}}return n.\u0275fac=function(t){return new(t||n)(oe(On),oe(Lr),oe(at),oe(_c,8))},n.\u0275cmp=Pi({type:n,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostAttrs:["mat-button-ripple-uninitialized",""],hostVars:9,hostBindings:function(t,i){2&t&&(Qo("disabled",i.disabled||null)("mat-button-disabled",i._isRippleDisabled())("mat-button-is-fab",i._isFab),er("_mat-animation-noopable","NoopAnimations"===i._animationMode)("mat-unthemed",!i.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[bs],attrs:pne,ngContentSelectors:gne,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(t,i){1&t&&(ws(mne),ao(0,"span",0),oi(1),fn(2,"span",1),oi(3,1),Fn(),oi(4,2),ao(5,"span",2)(6,"span",3)),2&t&&er("mdc-button__ripple",!i._isFab)("mdc-fab__ripple",i._isFab)},styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(\n      100% + 4px\n    );width:calc(\n      100% + 4px\n    );display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{height:var(--mdc-text-button-container-height, 36px);border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, inherit)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button{height:var(--mdc-filled-button-container-height, 36px);border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color, transparent)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, inherit)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button{height:var(--mdc-protected-button-container-height, 36px);border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px));box-shadow:var(--mdc-protected-button-container-elevation, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color, transparent)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, inherit)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button.mdc-ripple-upgraded--background-focused,.mat-mdc-raised-button:not(.mdc-ripple-upgraded):focus{box-shadow:var(--mdc-protected-button-focus-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled):active{box-shadow:var(--mdc-protected-button-pressed-container-elevation, 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation, 0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button{height:var(--mdc-outlined-button-container-height, 36px);border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px));padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, inherit)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width, 1px));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width, 1px))}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-button .mat-ripple-element,.mat-mdc-unelevated-button .mat-ripple-element,.mat-mdc-raised-button .mat-ripple-element,.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button[disabled],.mat-mdc-unelevated-button[disabled],.mat-mdc-raised-button[disabled],.mat-mdc-outlined-button[disabled]{cursor:default;pointer-events:none}.mat-mdc-button .mat-mdc-button-touch-target,.mat-mdc-unelevated-button .mat-mdc-button-touch-target,.mat-mdc-raised-button .mat-mdc-button-touch-target,.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}[dir=rtl] .mat-mdc-button>.mat-icon,.mat-mdc-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}.mat-mdc-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon,.mat-mdc-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:0;margin-right:8px}.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem;margin-left:-4px;margin-right:8px}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:-4px}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon,.mat-mdc-raised-button .mdc-button__label+.mat-icon,.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:-4px}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon,.mat-mdc-unelevated-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-raised-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-outlined-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:-4px;margin-right:8px}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px) * -1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),n})(),Sne=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=zn({imports:[Oo,xte,Oo]}),n})();const Cne=["*"];let Ag;function _h(n){return function Ane(){if(void 0===Ag&&(Ag=null,typeof window<"u")){const n=window;void 0!==n.trustedTypes&&(Ag=n.trustedTypes.createPolicy("angular#components",{createHTML:e=>e}))}return Ag}()?.createHTML(n)||n}function UF(n){return Error(`Unable to find icon with the name "${n}"`)}function BF(n){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${n}".`)}function VF(n){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${n}".`)}class Ba{constructor(e,t,i){this.url=e,this.svgText=t,this.options=i}}let Dg=(()=>{class n{constructor(t,i,r,s){this._httpClient=t,this._sanitizer=i,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=r}addSvgIcon(t,i,r){return this.addSvgIconInNamespace("",t,i,r)}addSvgIconLiteral(t,i,r){return this.addSvgIconLiteralInNamespace("",t,i,r)}addSvgIconInNamespace(t,i,r,s){return this._addSvgIconConfig(t,i,new Ba(r,null,s))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,i,r,s){const o=this._sanitizer.sanitize(Et.HTML,r);if(!o)throw VF(r);const a=_h(o);return this._addSvgIconConfig(t,i,new Ba("",a,s))}addSvgIconSet(t,i){return this.addSvgIconSetInNamespace("",t,i)}addSvgIconSetLiteral(t,i){return this.addSvgIconSetLiteralInNamespace("",t,i)}addSvgIconSetInNamespace(t,i,r){return this._addSvgIconSetConfig(t,new Ba(i,null,r))}addSvgIconSetLiteralInNamespace(t,i,r){const s=this._sanitizer.sanitize(Et.HTML,i);if(!s)throw VF(i);const o=_h(s);return this._addSvgIconSetConfig(t,new Ba("",o,r))}registerFontClassAlias(t,i=t){return this._fontCssClassesByAlias.set(t,i),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(...t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const i=this._sanitizer.sanitize(Et.RESOURCE_URL,t);if(!i)throw BF(t);const r=this._cachedIconsByUrl.get(i);return r?Oe(Ig(r)):this._loadSvgIconFromConfig(new Ba(t,null)).pipe(kn(s=>this._cachedIconsByUrl.set(i,s)),ut(s=>Ig(s)))}getNamedSvgIcon(t,i=""){const r=zF(i,t);let s=this._svgIconConfigs.get(r);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(i,t),s)return this._svgIconConfigs.set(r,s),this._getSvgFromConfig(s);const o=this._iconSetConfigs.get(i);return o?this._getSvgFromIconSetConfigs(t,o):zc(UF(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?Oe(Ig(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe(ut(i=>Ig(i)))}_getSvgFromIconSetConfigs(t,i){const r=this._extractIconWithNameFromAnySet(t,i);return r?Oe(r):function Tne(...n){const e=_M(n),{args:t,keys:i}=B1(n),r=new Nt(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let c=o,l=o;for(let u=0;u<o;u++){let d=!1;ii(t[u]).subscribe(Gt(s,h=>{d||(d=!0,l--),a[u]=h},()=>c--,void 0,()=>{(!c||!d)&&(l||s.next(i?V1(i,a):a),s.complete())}))}});return e?r.pipe(C0(e)):r}(i.filter(o=>!o.svgText).map(o=>this._loadSvgIconSetFromConfig(o).pipe(fo(a=>{const l=`Loading icon set URL: ${this._sanitizer.sanitize(Et.RESOURCE_URL,o.url)} failed: ${a.message}`;return this._errorHandler.handleError(new Error(l)),Oe(null)})))).pipe(ut(()=>{const o=this._extractIconWithNameFromAnySet(t,i);if(!o)throw UF(t);return o}))}_extractIconWithNameFromAnySet(t,i){for(let r=i.length-1;r>=0;r--){const s=i[r];if(s.svgText&&s.svgText.toString().indexOf(t)>-1){const o=this._svgElementFromConfig(s),a=this._extractSvgIconFromSet(o,t,s.options);if(a)return a}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(kn(i=>t.svgText=i),ut(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?Oe(null):this._fetchIcon(t).pipe(kn(i=>t.svgText=i))}_extractSvgIconFromSet(t,i,r){const s=t.querySelector(`[id="${i}"]`);if(!s)return null;const o=s.cloneNode(!0);if(o.removeAttribute("id"),"svg"===o.nodeName.toLowerCase())return this._setSvgAttributes(o,r);if("symbol"===o.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(o),r);const a=this._svgElementFromString(_h("<svg></svg>"));return a.appendChild(o),this._setSvgAttributes(a,r)}_svgElementFromString(t){const i=this._document.createElement("DIV");i.innerHTML=t;const r=i.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(t){const i=this._svgElementFromString(_h("<svg></svg>")),r=t.attributes;for(let s=0;s<r.length;s++){const{name:o,value:a}=r[s];"id"!==o&&i.setAttribute(o,a)}for(let s=0;s<t.childNodes.length;s++)t.childNodes[s].nodeType===this._document.ELEMENT_NODE&&i.appendChild(t.childNodes[s].cloneNode(!0));return i}_setSvgAttributes(t,i){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),i&&i.viewBox&&t.setAttribute("viewBox",i.viewBox),t}_fetchIcon(t){const{url:i,options:r}=t,s=r?.withCredentials??!1;if(!this._httpClient)throw function Dne(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==i)throw Error(`Cannot fetch icon from URL "${i}".`);const o=this._sanitizer.sanitize(Et.RESOURCE_URL,i);if(!o)throw BF(i);const a=this._inProgressUrlFetches.get(o);if(a)return a;const c=this._httpClient.get(o,{responseType:"text",withCredentials:s}).pipe(ut(l=>_h(l)),Ep(()=>this._inProgressUrlFetches.delete(o)),xM());return this._inProgressUrlFetches.set(o,c),c}_addSvgIconConfig(t,i,r){return this._svgIconConfigs.set(zF(t,i),r),this}_addSvgIconSetConfig(t,i){const r=this._iconSetConfigs.get(t);return r?r.push(i):this._iconSetConfigs.set(t,[i]),this}_svgElementFromConfig(t){if(!t.svgElement){const i=this._svgElementFromString(t.svgText);this._setSvgAttributes(i,t.options),t.svgElement=i}return t.svgElement}_getIconConfigFromResolvers(t,i){for(let r=0;r<this._resolvers.length;r++){const s=this._resolvers[r](i,t);if(s)return Rne(s)?new Ba(s.url,null,s.options):new Ba(s,null)}}}return n.\u0275fac=function(t){return new(t||n)(re(Cg,8),re(T0),re(Ct,8),re(Wr))},n.\u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Ig(n){return n.cloneNode(!0)}function zF(n,e){return n+":"+e}function Rne(n){return!(!n.url||!n.options)}const Pne=rF(class{constructor(n){this._elementRef=n}}),Lne=new pe("MAT_ICON_DEFAULT_OPTIONS"),Nne=new pe("mat-icon-location",{providedIn:"root",factory:function One(){const n=_e(Ct),e=n?n.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}}),HF=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],Fne=HF.map(n=>`[${n}]`).join(", "),kne=/^url\(['"]?#(.*?)['"]?\)$/;let Une=(()=>{class n extends Pne{get inline(){return this._inline}set inline(t){this._inline=Xs(t)}get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}get fontSet(){return this._fontSet}set fontSet(t){const i=this._cleanupFontValue(t);i!==this._fontSet&&(this._fontSet=i,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(t){const i=this._cleanupFontValue(t);i!==this._fontIcon&&(this._fontIcon=i,this._updateFontIconClasses())}constructor(t,i,r,s,o,a){super(t),this._iconRegistry=i,this._location=s,this._errorHandler=o,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=ni.EMPTY,a&&(a.color&&(this.color=this.defaultColor=a.color),a.fontSet&&(this.fontSet=a.fontSet)),r||t.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(t){if(!t)return["",""];const i=t.split(":");switch(i.length){case 1:return["",i[0]];case 2:return i;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const i=this._location.getPathname();i!==this._previousPath&&(this._previousPath=i,this._prependPathToReferences(i))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const i=this._location.getPathname();this._previousPath=i,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(i),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let i=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();i--;){const r=t.childNodes[i];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,i=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>t.classList.remove(r)),i.forEach(r=>t.classList.add(r)),this._previousFontSetClass=i,this.fontIcon!==this._previousFontIconClass&&!i.includes("mat-ligature-font")&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const i=this._elementsWithExternalReferences;i&&i.forEach((r,s)=>{r.forEach(o=>{s.setAttribute(o.name,`url('${t}#${o.value}')`)})})}_cacheChildrenWithExternalReferences(t){const i=t.querySelectorAll(Fne),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<i.length;s++)HF.forEach(o=>{const a=i[s],c=a.getAttribute(o),l=c?c.match(kne):null;if(l){let u=r.get(a);u||(u=[],r.set(a,u)),u.push({name:o,value:l[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){const[i,r]=this._splitIconName(t);i&&(this._svgNamespace=i),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,i).pipe(Er(1)).subscribe(s=>this._setSvgElement(s),s=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${i}:${r}! ${s.message}`))})}}}return n.\u0275fac=function(t){return new(t||n)(oe(On),oe(Dg),function cu(n){return function I3(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const s=t[r];if(NM(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(Gn(),n)}("aria-hidden"),oe(Nne),oe(Wr),oe(Lne,8))},n.\u0275cmp=Pi({type:n,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(t,i){2&t&&(Qo("data-mat-icon-type",i._usingFontIcon()?"font":"svg")("data-mat-icon-name",i._svgName||i.fontIcon)("data-mat-icon-namespace",i._svgNamespace||i.fontSet)("fontIcon",i._usingFontIcon()?i.fontIcon:null),er("mat-icon-inline",i.inline)("mat-icon-no-color","primary"!==i.color&&"accent"!==i.color&&"warn"!==i.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[bs],ngContentSelectors:Cne,decls:1,vars:0,template:function(t,i){1&t&&(ws(),oi(0))},styles:[".mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0}),n})(),Bne=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=zn({imports:[Oo,Oo]}),n})();function Vne(n,e){if(1&n){const t=Rc();fn(0,"div")(1,"button",8),co("click",function(){nc(t);const r=Ui().$implicit,s=Ui();return ic(s.navigateToRoom(r.key,s.roomImages.get(r.key)[0]))}),fn(2,"b"),Gf(3),Fn()()()}if(2&n){const t=Ui().$implicit;gr(3),cy(t.value)}}function zne(n,e){if(1&n){const t=Rc();fn(0,"div")(1,"button",9),co("click",function(){const s=nc(t).$implicit,o=Ui(2).$implicit;return ic(Ui().navigateToRoom(o.key,s))}),Gf(2),Fn()()}if(2&n){const t=e.$implicit;gr(2),Wf(" ",t," ")}}function Hne(n,e){if(1&n&&(fn(0,"div"),_r(1,zne,3,1,"div",4),Fn()),2&n){const t=Ui(2);gr(1),Mi("ngForOf",t.roomImages.get(t.room))}}function Gne(n,e){if(1&n&&(fn(0,"div"),_r(1,Vne,4,1,"div",7),_r(2,Hne,2,1,"div",7),Fn()),2&n){const t=e.$implicit,i=Ui();gr(1),Mi("ngIf",i.roomImages.has(t.key)),gr(1),Mi("ngIf",""!=i.room&&t.key==i.room)}}function Wne(n,e){1&n&&(fn(0,"div",10),ao(1,"router-outlet"),Fn())}let jne=(()=>{class n{constructor(t,i,r){this.http=t,this.router=i,this.route=r,this.title="Mandelring 10",this.roomList={Hof:"Hof",Scheune_Hof:"Verbindung zwischen Scheune und Haus",Scheune_EG:"Scheune Erdgeschoss",Scheune_DG:"Scheune Dachgeschoss",EG_F:"Erdgeschoss Flur und Waschk\xfcsche",EG_K:"Erdgeschoss K\xfcche",EG_W:"Erdgeschoss Wohnzimmer","1OG_B":"1.OG Zimmer hinten rechts","1OG_F":"1.OG Flur","1OG_L":"1.OG Zimmer links","1OG_S":"1.OG Zimmer vorne rechts",DG_B:"2. OG Bad",DG_F:"2. OG Flur",DG_L:"2. OG Zimmer links",DG_R:"2. OG Zimmer rechts"},this.room="",this.imageName="",this.roomImages=new Map}ngOnInit(){this.http.get("https://matmig42.github.io/photosphere_viewer/assets/image_list.json").subscribe(i=>{this.file_list=i,this.roomImages=new Map;for(const[r,s]of Object.entries(this.file_list))this.roomImages.has(s)?this.roomImages.get(s)?.push(r):this.roomImages.set(s,[r])});let t=new URLSearchParams(window.location.search);this.room=t.get("room"),this.imageName=t.get("imageName")}navigateToRoom(t,i){this.router.navigate(["/room/"],{relativeTo:this.route,queryParams:{room:t,imageName:i}}),this.room=t,this.imageName=i}toggleSideNav(){this.sidenav.toggle()}}return n.\u0275fac=function(t){return new(t||n)(oe(Cg),oe(Vi),oe(la))},n.\u0275cmp=Pi({type:n,selectors:[["app-root"]],viewQuery:function(t,i){if(1&t&&Kf(gx,5),2&t){let r;Ms(r=Es())&&(i.sidenav=r.first)}},decls:12,vars:5,consts:[["mat-button","",3,"click"],["color","primary"],["mode","side",3,"opened"],["sidenav",""],[4,"ngFor","ngForOf"],[1,"container",2,"height","100vh"],["class","row","style","padding-left: 10px; padding-top: 10px",4,"ngIf"],[4,"ngIf"],["mat-button","","color","primary",1,"nav-link",3,"click"],["mat-button","","color","secondary",1,"nav-link",2,"padding-left","25px",3,"click"],[1,"row",2,"padding-left","10px","padding-top","10px"]],template:function(t,i){if(1&t){const r=Rc();fn(0,"div")(1,"button",0),co("click",function(){return nc(r),ic(function jT(n){return ec(function d3(){return $e.lFrame.contextLView}(),gt+n)}(6).toggle())}),fn(2,"mat-icon"),Gf(3,"menu"),Fn()()(),fn(4,"mat-sidenav-container",1)(5,"mat-sidenav",2,3),_r(7,Gne,3,2,"div",4),function AA(n,e){const t=bt();let i;const r=n+gt;t.firstCreatePass?(i=function U5(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}}(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];const s=i.factory||(i.factory=jo(i.type)),o=pi(oe);try{const a=Zh(!1),c=s();return Zh(a),function bH(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,ne(),r,c),c}finally{pi(o)}}(8,"keyvalue"),Fn(),fn(9,"mat-sidenav-content",1)(10,"div",5),_r(11,Wne,2,0,"div",6),Fn()()()}2&t&&(gr(5),Mi("opened",i.roomImages.size>0),gr(2),Mi("ngForOf",DA(8,3,i.roomList)),gr(4),Mi("ngIf",i.room))},dependencies:[o1,Zu,G0,gx,wF,mx,Mne,Une,u1]}),n})();function GF(n){return new J(3e3,!1)}function ko(n){switch(n.length){case 0:return new hh;case 1:return n[0];default:return new _F(n)}}function WF(n,e,t=new Map,i=new Map){const r=[],s=[];let o=-1,a=null;if(e.forEach(c=>{const l=c.get("offset"),u=l==o,d=u&&a||new Map;c.forEach((h,f)=>{let p=f,_=h;if("offset"!==f)switch(p=n.normalizePropertyName(p,r),_){case fx:_=t.get(f);break;case Ys:_=i.get(f);break;default:_=n.normalizeStyleValue(f,p,_,r)}d.set(p,_)}),u||s.push(d),a=d,o=l}),r.length)throw function pie(n){return new J(3502,!1)}();return s}function xx(n,e,t,i){switch(e){case"start":n.onStart(()=>i(t&&Mx(t,"start",n)));break;case"done":n.onDone(()=>i(t&&Mx(t,"done",n)));break;case"destroy":n.onDestroy(()=>i(t&&Mx(t,"destroy",n)))}}function Mx(n,e,t){const s=Ex(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,t.totalTime??n.totalTime,!!t.disabled),o=n._data;return null!=o&&(s._data=o),s}function Ex(n,e,t,i,r="",s=0,o){return{element:n,triggerName:e,fromState:t,toState:i,phaseName:r,totalTime:s,disabled:!!o}}function qi(n,e,t){let i=n.get(e);return i||n.set(e,i=t),i}function jF(n){const e=n.indexOf(":");return[n.substring(1,e),n.slice(e+1)]}const Tie=(()=>typeof document>"u"?null:document.documentElement)();function Sx(n){const e=n.parentNode||n.host||null;return e===Tie?null:e}let Va=null,$F=!1;function qF(n,e){for(;e;){if(e===n)return!0;e=Sx(e)}return!1}function XF(n,e,t){if(t)return Array.from(n.querySelectorAll(e));const i=n.querySelector(e);return i?[i]:[]}let YF=(()=>{class n{validateStyleProperty(t){return function Aie(n){Va||(Va=function Die(){return typeof document<"u"?document.body:null}()||{},$F=!!Va.style&&"WebkitAppearance"in Va.style);let e=!0;return Va.style&&!function Cie(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in Va.style,!e&&$F&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in Va.style)),e}(t)}matchesElement(t,i){return!1}containsElement(t,i){return qF(t,i)}getParentElement(t){return Sx(t)}query(t,i,r){return XF(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,o,a=[],c){return new hh(r,s)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=xe({token:n,factory:n.\u0275fac}),n})(),Tx=(()=>{class n{}return n.NOOP=new YF,n})();const Iie=1e3,Cx="ng-enter",Rg="ng-leave",Pg="ng-trigger",Lg=".ng-trigger",KF="ng-animating",Ax=".ng-animating";function Zs(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:Dx(parseFloat(e[1]),e[2])}function Dx(n,e){return"s"===e?n*Iie:n}function Ng(n,e,t){return n.hasOwnProperty("duration")?n:function Pie(n,e,t){let r,s=0,o="";if("string"==typeof n){const a=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(GF()),{duration:0,delay:0,easing:""};r=Dx(parseFloat(a[1]),a[2]);const c=a[3];null!=c&&(s=Dx(parseFloat(c),a[4]));const l=a[5];l&&(o=l)}else r=n;if(!t){let a=!1,c=e.length;r<0&&(e.push(function $ne(){return new J(3100,!1)}()),a=!0),s<0&&(e.push(function qne(){return new J(3101,!1)}()),a=!0),a&&e.splice(c,0,GF())}return{duration:r,delay:s,easing:o}}(n,e,t)}function vh(n,e={}){return Object.keys(n).forEach(t=>{e[t]=n[t]}),e}function JF(n){const e=new Map;return Object.keys(n).forEach(t=>{e.set(t,n[t])}),e}function Uo(n,e=new Map,t){if(t)for(let[i,r]of t)e.set(i,r);for(let[i,r]of n)e.set(i,r);return e}function cs(n,e,t){e.forEach((i,r)=>{const s=Rx(r);t&&!t.has(r)&&t.set(r,n.style[s]),n.style[s]=i})}function za(n,e){e.forEach((t,i)=>{const r=Rx(i);n.style[r]=""})}function yh(n){return Array.isArray(n)?1==n.length?n[0]:fF(n):n}const Ix=new RegExp("{{\\s*(.+?)\\s*}}","g");function e2(n){let e=[];if("string"==typeof n){let t;for(;t=Ix.exec(n);)e.push(t[1]);Ix.lastIndex=0}return e}function bh(n,e,t){const i=n.toString(),r=i.replace(Ix,(s,o)=>{let a=e[o];return null==a&&(t.push(function Yne(n){return new J(3003,!1)}()),a=""),a.toString()});return r==i?n:r}function Og(n){const e=[];let t=n.next();for(;!t.done;)e.push(t.value),t=n.next();return e}const Oie=/-+([a-z0-9])/g;function Rx(n){return n.replace(Oie,(...e)=>e[1].toUpperCase())}function Xi(n,e,t){switch(e.type){case 7:return n.visitTrigger(e,t);case 0:return n.visitState(e,t);case 1:return n.visitTransition(e,t);case 2:return n.visitSequence(e,t);case 3:return n.visitGroup(e,t);case 4:return n.visitAnimate(e,t);case 5:return n.visitKeyframes(e,t);case 6:return n.visitStyle(e,t);case 8:return n.visitReference(e,t);case 9:return n.visitAnimateChild(e,t);case 10:return n.visitAnimateRef(e,t);case 11:return n.visitQuery(e,t);case 12:return n.visitStagger(e,t);default:throw function Zne(n){return new J(3004,!1)}()}}function t2(n,e){return window.getComputedStyle(n)[e]}const Fg="*";function Uie(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function Bie(n,e,t){if(":"==n[0]){const c=function Vie(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return e.push(function uie(n){return new J(3016,!1)}()),"* => *"}}(n,t);if("function"==typeof c)return void e.push(c);n=c}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function lie(n){return new J(3015,!1)}()),e;const r=i[1],s=i[2],o=i[3];e.push(n2(r,o));"<"==s[0]&&!(r==Fg&&o==Fg)&&e.push(n2(o,r))}(i,t,e)):t.push(n),t}const kg=new Set(["true","1"]),Ug=new Set(["false","0"]);function n2(n,e){const t=kg.has(n)||Ug.has(n),i=kg.has(e)||Ug.has(e);return(r,s)=>{let o=n==Fg||n==r,a=e==Fg||e==s;return!o&&t&&"boolean"==typeof r&&(o=r?kg.has(n):Ug.has(n)),!a&&i&&"boolean"==typeof s&&(a=s?kg.has(e):Ug.has(e)),o&&a}}const zie=new RegExp("s*:selfs*,?","g");function Px(n,e,t,i){return new Hie(n).build(e,t,i)}class Hie{constructor(e){this._driver=e}build(e,t,i){const r=new jie(t);return this._resetContextStyleTimingState(r),Xi(this,yh(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,r=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function Jne(){return new J(3006,!1)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const c=a,l=c.name;l.toString().split(/\s*,\s*/).forEach(u=>{c.name=u,s.push(this.visitState(c,t))}),c.name=l}else if(1==a.type){const c=this.visitTransition(a,t);i+=c.queryCount,r+=c.depCount,o.push(c)}else t.errors.push(function Qne(){return new J(3007,!1)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:i,depCount:r,options:null}}visitState(e,t){const i=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(i.containsDynamicStyles){const s=new Set,o=r||{};i.styles.forEach(a=>{a instanceof Map&&a.forEach(c=>{e2(c).forEach(l=>{o.hasOwnProperty(l)||s.add(l)})})}),s.size&&(Og(s.values()),t.errors.push(function eie(n,e){return new J(3008,!1)}()))}return{type:0,name:e.name,style:i,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const i=Xi(this,yh(e.animation),t);return{type:1,matchers:Uie(e.expr,t.errors),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:Ha(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(i=>Xi(this,i,t)),options:Ha(e.options)}}visitGroup(e,t){const i=t.currentTime;let r=0;const s=e.steps.map(o=>{t.currentTime=i;const a=Xi(this,o,t);return r=Math.max(r,t.currentTime),a});return t.currentTime=r,{type:3,steps:s,options:Ha(e.options)}}visitAnimate(e,t){const i=function qie(n,e){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return Lx(Ng(n,e).duration,0,"");const t=n;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=Lx(0,0,"");return s.dynamic=!0,s.strValue=t,s}const r=Ng(t,e);return Lx(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;let r,s=e.styles?e.styles:xg({});if(5==s.type)r=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;const l={};i.easing&&(l.easing=i.easing),o=xg(l)}t.currentTime+=i.duration+i.delay;const c=this.visitStyle(o,t);c.isEmptyStep=a,r=c}return t.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(e,t){const i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){const i=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of r)"string"==typeof a?a===Ys?i.push(a):t.errors.push(new J(3002,!1)):i.push(JF(a));let s=!1,o=null;return i.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!s))for(let c of a.values())if(c.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:i,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const i=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;i&&s>0&&(s-=i.duration+i.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,c)=>{const l=t.collectedStyles.get(t.currentQuerySelector),u=l.get(c);let d=!0;u&&(s!=r&&s>=u.startTime&&r<=u.endTime&&(t.errors.push(function nie(n,e,t,i,r){return new J(3010,!1)}()),d=!1),s=u.startTime),d&&l.set(c,{startTime:s,endTime:r}),t.options&&function Nie(n,e,t){const i=e.params||{},r=e2(n);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||t.push(function Xne(n){return new J(3001,!1)}())})}(a,t.options,t.errors)})})}visitKeyframes(e,t){const i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function iie(){return new J(3011,!1)}()),i;let s=0;const o=[];let a=!1,c=!1,l=0;const u=e.steps.map(m=>{const y=this._makeStyleAst(m,t);let v=null!=y.offset?y.offset:function $ie(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;e=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(y.styles),b=0;return null!=v&&(s++,b=y.offset=v),c=c||b<0||b>1,a=a||b<l,l=b,o.push(b),y});c&&t.errors.push(function rie(){return new J(3012,!1)}()),a&&t.errors.push(function sie(){return new J(3200,!1)}());const d=e.steps.length;let h=0;s>0&&s<d?t.errors.push(function oie(){return new J(3202,!1)}()):0==s&&(h=1/(d-1));const f=d-1,p=t.currentTime,_=t.currentAnimateTimings,g=_.duration;return u.forEach((m,y)=>{const v=h>0?y==f?1:h*y:o[y],b=v*g;t.currentTime=p+_.delay+b,_.duration=b,this._validateStyleAst(m,t),m.offset=v,i.styles.push(m)}),i}visitReference(e,t){return{type:8,animation:Xi(this,yh(e.animation),t),options:Ha(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:Ha(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:Ha(e.options)}}visitQuery(e,t){const i=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function Gie(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(zie,"")),n=n.replace(/@\*/g,Lg).replace(/@\w+/g,t=>Lg+"-"+t.slice(1)).replace(/:animating/g,Ax),[n,e]}(e.selector);t.currentQuerySelector=i.length?i+" "+s:s,qi(t.collectedStyles,t.currentQuerySelector,new Map);const a=Xi(this,yh(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:Ha(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function aie(){return new J(3013,!1)}());const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:Ng(e.timings,t.errors,!0);return{type:12,animation:Xi(this,yh(e.animation),t),timings:i,options:null}}}class jie{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Ha(n){return n?(n=vh(n)).params&&(n.params=function Wie(n){return n?vh(n):null}(n.params)):n={},n}function Lx(n,e,t){return{duration:n,delay:e,easing:t}}function Nx(n,e,t,i,r,s,o=null,a=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class Bg{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const Zie=new RegExp(":enter","g"),Jie=new RegExp(":leave","g");function Ox(n,e,t,i,r,s=new Map,o=new Map,a,c,l=[]){return(new Qie).buildKeyframes(n,e,t,i,r,s,o,a,c,l)}class Qie{buildKeyframes(e,t,i,r,s,o,a,c,l,u=[]){l=l||new Bg;const d=new Fx(e,t,l,r,s,u,[]);d.options=c;const h=c.delay?Zs(c.delay):0;d.currentTimeline.delayNextStep(h),d.currentTimeline.setStyles([o],null,d.errors,c),Xi(this,i,d);const f=d.timelines.filter(p=>p.containsAnimation());if(f.length&&a.size){let p;for(let _=f.length-1;_>=0;_--){const g=f[_];if(g.element===t){p=g;break}}p&&!p.allowOnlyTimelineStyles()&&p.setStyles([a],null,d.errors,c)}return f.length?f.map(p=>p.buildKeyframes()):[Nx(t,[],[],[],0,h,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(i,r,r.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,i),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,i){for(const r of e){const s=r?.delay;if(s){const o="number"==typeof s?s:Zs(bh(s,r?.params??{},t.errors));i.delayNextStep(o)}}}_visitSubInstructions(e,t,i){let s=t.currentTimeline.currentTime;const o=null!=i.duration?Zs(i.duration):null,a=null!=i.delay?Zs(i.delay):null;return 0!==o&&e.forEach(c=>{const l=t.appendInstructionToTimeline(c,o,a);s=Math.max(s,l.duration+l.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),Xi(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const i=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Vg);const o=Zs(s.delay);r.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>Xi(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const i=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?Zs(e.options.delay):0;e.steps.forEach(o=>{const a=t.createSubContext(e.options);s&&a.delayNextStep(s),Xi(this,o,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const i=e.strValue;return Ng(t.params?bh(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const i=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(i.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(s):i.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,s=i.duration,a=t.createSubContext().currentTimeline;a.easing=i.easing,e.styles.forEach(c=>{a.forwardTime((c.offset||0)*s),a.setStyles(c.styles,c.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const i=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?Zs(r.delay):0;s&&(6===t.previousNode.type||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=Vg);let o=i;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=a.length;let c=null;a.forEach((l,u)=>{t.currentQueryIndex=u;const d=t.createSubContext(e.options,l);s&&d.delayNextStep(s),l===t.element&&(c=d.currentTimeline),Xi(this,e.animation,d),d.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,d.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),c&&(t.currentTimeline.mergeTimelineCollectedStyles(c),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const i=t.parentContext,r=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1);let c=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":c=a-c;break;case"full":c=i.currentStaggerTime}const u=t.currentTimeline;c&&u.delayNextStep(c);const d=u.currentTime;Xi(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=r.currentTime-d+(r.startTime-i.currentTimeline.startTime)}}const Vg={};class Fx{constructor(e,t,i,r,s,o,a,c){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Vg,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=c||new zg(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const i=e;let r=this.options;null!=i.duration&&(r.duration=Zs(i.duration)),null!=i.delay&&(r.delay=Zs(i.delay));const s=i.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=bh(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const i=e.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return e}createSubContext(e=null,t,i){const r=t||this.element,s=new Fx(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=Vg,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(i??0)+e.delay,easing:""},s=new ere(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,r,s,o){let a=[];if(r&&a.push(this.element),e.length>0){e=(e=e.replace(Zie,"."+this._enterClassName)).replace(Jie,"."+this._leaveClassName);let l=this._driver.query(this.element,e,1!=i);0!==i&&(l=i<0?l.slice(l.length+i,l.length):l.slice(0,i)),a.push(...l)}return!s&&0==a.length&&o.push(function cie(n){return new J(3014,!1)}()),a}}class zg{constructor(e,t,i,r){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new zg(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||Ys),this._currentKeyframe.set(t,Ys);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,r){t&&this._previousKeyframe.set("easing",t);const s=r&&r.params||{},o=function tre(n,e){const t=new Map;let i;return n.forEach(r=>{if("*"===r){i=i||e.keys();for(let s of i)t.set(s,Ys)}else Uo(r,t)}),t}(e,this._globalTimelineStyles);for(let[a,c]of o){const l=bh(c,s,i);this._pendingStyles.set(a,l),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??Ys),this._updateStyle(a,l)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,i)=>{const r=this._styleSummary.get(i);(!r||t.time>r.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,c)=>{const l=Uo(a,new Map,this._backFill);l.forEach((u,d)=>{u===fx?e.add(d):u===Ys&&t.add(d)}),i||l.set("offset",c/this.duration),r.push(l)});const s=e.size?Og(e.values()):[],o=t.size?Og(t.values()):[];if(i){const a=r[0],c=new Map(a);a.set("offset",0),c.set("offset",1),r=[a,c]}return Nx(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class ere extends zg{constructor(e,t,i,r,s,o,a=!1){super(e,t,o.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=i+t,a=t/o,c=Uo(e[0]);c.set("offset",0),s.push(c);const l=Uo(e[0]);l.set("offset",o2(a)),s.push(l);const u=e.length-1;for(let d=1;d<=u;d++){let h=Uo(e[d]);const f=h.get("offset");h.set("offset",o2((t+f*i)/o)),s.push(h)}i=o,t=0,r="",e=s}return Nx(this.element,e,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function o2(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}class kx{}const nre=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class ire extends kx{normalizePropertyName(e,t){return Rx(e)}normalizeStyleValue(e,t,i,r){let s="";const o=i.toString().trim();if(nre.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function Kne(n,e){return new J(3005,!1)}())}return o+s}}function a2(n,e,t,i,r,s,o,a,c,l,u,d,h){return{type:0,element:n,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:i,toStyles:o,timelines:a,queriedElements:c,preStyleProps:l,postStyleProps:u,totalTime:d,errors:h}}const Ux={};class c2{constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,r){return function rre(n,e,t,i,r){return n.some(s=>s(e,t,i,r))}(this.ast.matchers,e,t,i,r)}buildStyles(e,t,i){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,i):new Map}build(e,t,i,r,s,o,a,c,l,u){const d=[],h=this.ast.options&&this.ast.options.params||Ux,p=this.buildStyles(i,a&&a.params||Ux,d),_=c&&c.params||Ux,g=this.buildStyles(r,_,d),m=new Set,y=new Map,v=new Map,b="void"===r,x={params:sre(_,h),delay:this.ast.options?.delay},E=u?[]:Ox(e,t,this.ast.animation,s,o,p,g,x,l,d);let T=0;if(E.forEach(w=>{T=Math.max(w.duration+w.delay,T)}),d.length)return a2(t,this._triggerName,i,r,b,p,g,[],[],y,v,T,d);E.forEach(w=>{const S=w.element,W=qi(y,S,new Set);w.preStyleProps.forEach(U=>W.add(U));const te=qi(v,S,new Set);w.postStyleProps.forEach(U=>te.add(U)),S!==t&&m.add(S)});const P=Og(m.values());return a2(t,this._triggerName,i,r,b,p,g,E,P,y,v,T)}}function sre(n,e){const t=vh(e);for(const i in n)n.hasOwnProperty(i)&&null!=n[i]&&(t[i]=n[i]);return t}class ore{constructor(e,t,i){this.styles=e,this.defaultParams=t,this.normalizer=i}buildStyles(e,t){const i=new Map,r=vh(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!==o&&(r[s]=o)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,a)=>{o&&(o=bh(o,r,t));const c=this.normalizer.normalizePropertyName(a,t);o=this.normalizer.normalizeStyleValue(a,c,o,t),i.set(a,o)})}),i}}class cre{constructor(e,t,i){this.name=e,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new ore(r.style,r.options&&r.options.params||{},i))}),l2(this.states,"true","1"),l2(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new c2(e,r,this.states))}),this.fallbackTransition=function lre(n,e,t){return new c2(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,r){return this.transitionFactories.find(o=>o.match(e,t,i,r))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}function l2(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}const ure=new Bg;class dre{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const i=[],s=Px(this._driver,t,i,[]);if(i.length)throw function mie(n){return new J(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,i){const r=e.element,s=WF(this._normalizer,e.keyframes,t,i);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){const r=[],s=this._animations.get(e);let o;const a=new Map;if(s?(o=Ox(this._driver,t,s,Cx,Rg,new Map,new Map,i,ure,r),o.forEach(u=>{const d=qi(a,u.element,new Map);u.postStyleProps.forEach(h=>d.set(h,null))})):(r.push(function gie(){return new J(3300,!1)}()),o=[]),r.length)throw function _ie(n){return new J(3504,!1)}();a.forEach((u,d)=>{u.forEach((h,f)=>{u.set(f,this._driver.computeStyle(d,f,Ys))})});const l=ko(o.map(u=>{const d=a.get(u.element);return this._buildPlayer(u,new Map,d)}));return this._playersById.set(e,l),l.onDestroy(()=>this.destroy(e)),this.players.push(l),l}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function vie(n){return new J(3301,!1)}();return t}listen(e,t,i,r){const s=Ex(t,"","","");return xx(this._getPlayer(e),i,s,r),()=>{}}command(e,t,i,r){if("register"==i)return void this.register(e,r[0]);if("create"==i)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const u2="ng-animate-queued",Bx="ng-animate-disabled",gre=[],d2={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},_re={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},ur="__ng_removed";class Vx{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const i=e&&e.hasOwnProperty("value");if(this.value=function wre(n){return n??null}(i?e.value:e),i){const s=vh(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const wh="void",zx=new Vx(wh);class vre{constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,dr(t,this._hostClassName)}listen(e,t,i,r){if(!this._triggers.has(t))throw function yie(n,e){return new J(3302,!1)}();if(null==i||0==i.length)throw function bie(n){return new J(3303,!1)}();if(!function xre(n){return"start"==n||"done"==n}(i))throw function wie(n,e){return new J(3400,!1)}();const s=qi(this._elementListeners,e,[]),o={name:t,phase:i,callback:r};s.push(o);const a=qi(this._engine.statesByElement,e,new Map);return a.has(t)||(dr(e,Pg),dr(e,Pg+"-"+t),a.set(t,zx)),()=>{this._engine.afterFlush(()=>{const c=s.indexOf(o);c>=0&&s.splice(c,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function xie(n){return new J(3401,!1)}();return t}trigger(e,t,i,r=!0){const s=this._getTrigger(t),o=new Hx(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(dr(e,Pg),dr(e,Pg+"-"+t),this._engine.statesByElement.set(e,a=new Map));let c=a.get(t);const l=new Vx(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&c&&l.absorbOptions(c.options),a.set(t,l),c||(c=zx),l.value!==wh&&c.value===l.value){if(!function Sre(n,e){const t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||n[s]!==e[s])return!1}return!0}(c.params,l.params)){const _=[],g=s.matchStyles(c.value,c.params,_),m=s.matchStyles(l.value,l.params,_);_.length?this._engine.reportError(_):this._engine.afterFlush(()=>{za(e,g),cs(e,m)})}return}const h=qi(this._engine.playersByElement,e,[]);h.forEach(_=>{_.namespaceId==this.id&&_.triggerName==t&&_.queued&&_.destroy()});let f=s.matchTransition(c.value,l.value,e,l.params),p=!1;if(!f){if(!r)return;f=s.fallbackTransition,p=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:f,fromState:c,toState:l,player:o,isFallbackTransition:p}),p||(dr(e,u2),o.onStart(()=>{ql(e,u2)})),o.onDone(()=>{let _=this.players.indexOf(o);_>=0&&this.players.splice(_,1);const g=this._engine.playersByElement.get(e);if(g){let m=g.indexOf(o);m>=0&&g.splice(m,1)}}),this.players.push(o),h.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const i=this._engine.driver.query(e,Lg,!0);i.forEach(r=>{if(r[ur])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,i,r){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(s.forEach((c,l)=>{if(o.set(l,c.value),this._triggers.has(l)){const u=this.trigger(e,l,wh,r);u&&a.push(u)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),i&&ko(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(t&&i){const r=new Set;t.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const c=this._triggers.get(o).fallbackTransition,l=i.get(o)||zx,u=new Vx(wh),d=new Hx(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:c,fromState:l,toState:u,player:d,isFallbackTransition:!0})})}}removeNode(e,t){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let o=e;for(;o=o.parentNode;)if(i.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)i.markElementAsRemoved(this.id,e,!1,t);else{const s=e[ur];(!s||s===d2)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){dr(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==i.triggerName){const c=Ex(s,i.triggerName,i.fromState.value,i.toState.value);c._data=e,xx(i.player,a.phase,c,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const s=i.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(i=>i.element===e)||t,t}}class yre{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,i){this.bodyNode=e,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&e.push(i)})}),e}createNamespace(e,t){const i=new vre(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let o=!1,a=this.driver.getParentElement(t);for(;a;){const c=r.get(a);if(c){const l=i.indexOf(c);i.splice(l+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}o||i.unshift(e)}else i.push(e);return r.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let r=this._namespaceLookup[e];r&&r.register(t,i)&&this.totalAnimations++}destroy(e,t){if(!e)return;const i=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[e];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,i=this.statesByElement.get(e);if(i)for(let r of i.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&t.add(s)}return t}trigger(e,t,i,r){if(Hg(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,i,r),!0}return!1}insertNode(e,t,i,r){if(!Hg(t))return;const s=t[ur];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),dr(e,Bx)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),ql(e,Bx))}removeNode(e,t,i,r){if(Hg(t)){const s=e?this._fetchNamespace(e):null;if(s?s.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),i){const o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,r)}}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,i,r,s){this.collectedLeaveElements.push(t),t[ur]={namespaceId:e,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,i,r,s){return Hg(t)?this._fetchNamespace(e).listen(t,i,r,s):()=>{}}_buildInstruction(e,t,i,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,Lg,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,Ax,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return ko(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[ur];if(t&&t.setForRemoval){if(e[ur]=d2,t.namespaceId){this.destroyInnerAnimations(e);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(Bx)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)dr(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,e)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?ko(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(e){throw function Mie(n){return new J(3402,!1)}()}_flushAnimations(e,t){const i=new Bg,r=[],s=new Map,o=[],a=new Map,c=new Map,l=new Map,u=new Set;this.disabledNodes.forEach(O=>{u.add(O);const N=this.driver.query(O,".ng-animate-queued",!0);for(let F=0;F<N.length;F++)u.add(N[F])});const d=this.bodyNode,h=Array.from(this.statesByElement.keys()),f=p2(h,this.collectedEnterElements),p=new Map;let _=0;f.forEach((O,N)=>{const F=Cx+_++;p.set(N,F),O.forEach($=>dr($,F))});const g=[],m=new Set,y=new Set;for(let O=0;O<this.collectedLeaveElements.length;O++){const N=this.collectedLeaveElements[O],F=N[ur];F&&F.setForRemoval&&(g.push(N),m.add(N),F.hasAnimation?this.driver.query(N,".ng-star-inserted",!0).forEach($=>m.add($)):y.add(N))}const v=new Map,b=p2(h,Array.from(m));b.forEach((O,N)=>{const F=Rg+_++;v.set(N,F),O.forEach($=>dr($,F))}),e.push(()=>{f.forEach((O,N)=>{const F=p.get(N);O.forEach($=>ql($,F))}),b.forEach((O,N)=>{const F=v.get(N);O.forEach($=>ql($,F))}),g.forEach(O=>{this.processLeaveNode(O)})});const x=[],E=[];for(let O=this._namespaceList.length-1;O>=0;O--)this._namespaceList[O].drainQueuedTransitions(t).forEach(F=>{const $=F.player,Q=F.element;if(x.push($),this.collectedEnterElements.length){const Me=Q[ur];if(Me&&Me.setForMove){if(Me.previousTriggersValues&&Me.previousTriggersValues.has(F.triggerName)){const Re=Me.previousTriggersValues.get(F.triggerName),Ze=this.statesByElement.get(F.element);if(Ze&&Ze.has(F.triggerName)){const It=Ze.get(F.triggerName);It.value=Re,Ze.set(F.triggerName,It)}}return void $.destroy()}}const k=!d||!this.driver.containsElement(d,Q),X=v.get(Q),he=p.get(Q),ce=this._buildInstruction(F,i,he,X,k);if(ce.errors&&ce.errors.length)return void E.push(ce);if(k)return $.onStart(()=>za(Q,ce.fromStyles)),$.onDestroy(()=>cs(Q,ce.toStyles)),void r.push($);if(F.isFallbackTransition)return $.onStart(()=>za(Q,ce.fromStyles)),$.onDestroy(()=>cs(Q,ce.toStyles)),void r.push($);const Se=[];ce.timelines.forEach(Me=>{Me.stretchStartingKeyframe=!0,this.disabledNodes.has(Me.element)||Se.push(Me)}),ce.timelines=Se,i.append(Q,ce.timelines),o.push({instruction:ce,player:$,element:Q}),ce.queriedElements.forEach(Me=>qi(a,Me,[]).push($)),ce.preStyleProps.forEach((Me,Re)=>{if(Me.size){let Ze=c.get(Re);Ze||c.set(Re,Ze=new Set),Me.forEach((It,Be)=>Ze.add(Be))}}),ce.postStyleProps.forEach((Me,Re)=>{let Ze=l.get(Re);Ze||l.set(Re,Ze=new Set),Me.forEach((It,Be)=>Ze.add(Be))})});if(E.length){const O=[];E.forEach(N=>{O.push(function Eie(n,e){return new J(3505,!1)}())}),x.forEach(N=>N.destroy()),this.reportError(O)}const T=new Map,P=new Map;o.forEach(O=>{const N=O.element;i.has(N)&&(P.set(N,N),this._beforeAnimationBuild(O.player.namespaceId,O.instruction,T))}),r.forEach(O=>{const N=O.element;this._getPreviousPlayers(N,!1,O.namespaceId,O.triggerName,null).forEach($=>{qi(T,N,[]).push($),$.destroy()})});const w=g.filter(O=>g2(O,c,l)),S=new Map;f2(S,this.driver,y,l,Ys).forEach(O=>{g2(O,c,l)&&w.push(O)});const te=new Map;f.forEach((O,N)=>{f2(te,this.driver,new Set(O),c,fx)}),w.forEach(O=>{const N=S.get(O),F=te.get(O);S.set(O,new Map([...Array.from(N?.entries()??[]),...Array.from(F?.entries()??[])]))});const U=[],V=[],G={};o.forEach(O=>{const{element:N,player:F,instruction:$}=O;if(i.has(N)){if(u.has(N))return F.onDestroy(()=>cs(N,$.toStyles)),F.disabled=!0,F.overrideTotalTime($.totalTime),void r.push(F);let Q=G;if(P.size>1){let X=N;const he=[];for(;X=X.parentNode;){const ce=P.get(X);if(ce){Q=ce;break}he.push(X)}he.forEach(ce=>P.set(ce,Q))}const k=this._buildAnimation(F.namespaceId,$,T,s,te,S);if(F.setRealPlayer(k),Q===G)U.push(F);else{const X=this.playersByElement.get(Q);X&&X.length&&(F.parentPlayer=ko(X)),r.push(F)}}else za(N,$.fromStyles),F.onDestroy(()=>cs(N,$.toStyles)),V.push(F),u.has(N)&&r.push(F)}),V.forEach(O=>{const N=s.get(O.element);if(N&&N.length){const F=ko(N);O.setRealPlayer(F)}}),r.forEach(O=>{O.parentPlayer?O.syncPlayerEvents(O.parentPlayer):O.destroy()});for(let O=0;O<g.length;O++){const N=g[O],F=N[ur];if(ql(N,Rg),F&&F.hasAnimation)continue;let $=[];if(a.size){let k=a.get(N);k&&k.length&&$.push(...k);let X=this.driver.query(N,Ax,!0);for(let he=0;he<X.length;he++){let ce=a.get(X[he]);ce&&ce.length&&$.push(...ce)}}const Q=$.filter(k=>!k.destroyed);Q.length?Mre(this,N,Q):this.processLeaveNode(N)}return g.length=0,U.forEach(O=>{this.players.push(O),O.onDone(()=>{O.destroy();const N=this.players.indexOf(O);this.players.splice(N,1)}),O.play()}),U}elementContainsData(e,t){let i=!1;const r=t[ur];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(t)&&(i=!0),this.playersByQueriedElement.has(t)&&(i=!0),this.statesByElement.has(t)&&(i=!0),this._fetchNamespace(e).elementContainsData(t)||i}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,r,s){let o=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const c=!s||s==wh;a.forEach(l=>{l.queued||!c&&l.triggerName!=r||o.push(l)})}}return(i||r)&&(o=o.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),o}_beforeAnimationBuild(e,t,i){const s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const c of t.timelines){const l=c.element,u=l!==s,d=qi(i,l,[]);this._getPreviousPlayers(l,u,o,a,t.toState).forEach(f=>{const p=f.getRealPlayer();p.beforeDestroy&&p.beforeDestroy(),f.destroy(),d.push(f)})}za(s,t.fromStyles)}_buildAnimation(e,t,i,r,s,o){const a=t.triggerName,c=t.element,l=[],u=new Set,d=new Set,h=t.timelines.map(p=>{const _=p.element;u.add(_);const g=_[ur];if(g&&g.removedBeforeQueried)return new hh(p.duration,p.delay);const m=_!==c,y=function Ere(n){const e=[];return m2(n,e),e}((i.get(_)||gre).map(T=>T.getRealPlayer())).filter(T=>!!T.element&&T.element===_),v=s.get(_),b=o.get(_),x=WF(this._normalizer,p.keyframes,v,b),E=this._buildPlayer(p,x,y);if(p.subTimeline&&r&&d.add(_),m){const T=new Hx(e,a,_);T.setRealPlayer(E),l.push(T)}return E});l.forEach(p=>{qi(this.playersByQueriedElement,p.element,[]).push(p),p.onDone(()=>function bre(n,e,t){let i=n.get(e);if(i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&n.delete(e)}return i}(this.playersByQueriedElement,p.element,p))}),u.forEach(p=>dr(p,KF));const f=ko(h);return f.onDestroy(()=>{u.forEach(p=>ql(p,KF)),cs(c,t.toStyles)}),d.forEach(p=>{qi(r,p,[]).push(f)}),f}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new hh(e.duration,e.delay)}}class Hx{constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i,this._player=new hh,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,i)=>{t.forEach(r=>xx(e,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){qi(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function Hg(n){return n&&1===n.nodeType}function h2(n,e){const t=n.style.display;return n.style.display=e??"none",t}function f2(n,e,t,i,r){const s=[];t.forEach(c=>s.push(h2(c)));const o=[];i.forEach((c,l)=>{const u=new Map;c.forEach(d=>{const h=e.computeStyle(l,d,r);u.set(d,h),(!h||0==h.length)&&(l[ur]=_re,o.push(l))}),n.set(l,u)});let a=0;return t.forEach(c=>h2(c,s[a++])),o}function p2(n,e){const t=new Map;if(n.forEach(a=>t.set(a,[])),0==e.length)return t;const i=1,r=new Set(e),s=new Map;function o(a){if(!a)return i;let c=s.get(a);if(c)return c;const l=a.parentNode;return c=t.has(l)?l:r.has(l)?i:o(l),s.set(a,c),c}return e.forEach(a=>{const c=o(a);c!==i&&t.get(c).push(a)}),t}function dr(n,e){n.classList?.add(e)}function ql(n,e){n.classList?.remove(e)}function Mre(n,e,t){ko(t).onDone(()=>n.processLeaveNode(e))}function m2(n,e){for(let t=0;t<n.length;t++){const i=n[t];i instanceof _F?m2(i.players,e):e.push(i)}}function g2(n,e,t){const i=t.get(n);if(!i)return!1;let r=e.get(n);return r?i.forEach(s=>r.add(s)):e.set(n,i),t.delete(n),!0}class Gg{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new yre(e,t,i),this._timelineEngine=new dre(e,t,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(e,t,i,r,s){const o=e+"-"+r;let a=this._triggerCache[o];if(!a){const c=[],u=Px(this._driver,s,c,[]);if(c.length)throw function fie(n,e){return new J(3404,!1)}();a=function are(n,e,t){return new cre(n,e,t)}(r,u,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,r,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,r){this._transitionEngine.insertNode(e,t,i,r)}onRemove(e,t,i,r){this._transitionEngine.removeNode(e,t,r||!1,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,r){if("@"==i.charAt(0)){const[s,o]=jF(i);this._timelineEngine.command(s,t,o,r)}else this._transitionEngine.trigger(e,t,i,r)}listen(e,t,i,r,s){if("@"==i.charAt(0)){const[o,a]=jF(i);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,i,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let Cre=(()=>{class n{constructor(t,i,r){this._element=t,this._startStyles=i,this._endStyles=r,this._state=0;let s=n.initialStylesByElement.get(t);s||n.initialStylesByElement.set(t,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&cs(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(cs(this._element,this._initialStyles),this._endStyles&&(cs(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(za(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(za(this._element,this._endStyles),this._endStyles=null),cs(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function Gx(n){let e=null;return n.forEach((t,i)=>{(function Are(n){return"display"===n||"position"===n})(i)&&(e=e||new Map,e.set(i,t))}),e}class _2{constructor(e,t,i,r){this.element=e,this.keyframes=t,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(e,t,i){return e.animate(this._convertKeyframesToObject(t),i)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&e.set(r,this._finished?i:t2(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class Dre{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return qF(e,t)}getParentElement(e){return Sx(e)}query(e,t,i){return XF(e,t,i)}computeStyle(e,t,i){return window.getComputedStyle(e)[t]}animate(e,t,i,r,s,o=[]){const c={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&(c.easing=s);const l=new Map,u=o.filter(f=>f instanceof _2);(function Fie(n,e){return 0===n||0===e})(i,r)&&u.forEach(f=>{f.currentSnapshot.forEach((p,_)=>l.set(_,p))});let d=function Lie(n){return n.length?n[0]instanceof Map?n:n.map(e=>JF(e)):[]}(t).map(f=>Uo(f));d=function kie(n,e,t){if(t.size&&e.length){let i=e[0],r=[];if(t.forEach((s,o)=>{i.has(o)||r.push(o),i.set(o,s)}),r.length)for(let s=1;s<e.length;s++){let o=e[s];r.forEach(a=>o.set(a,t2(n,a)))}}return e}(e,d,l);const h=function Tre(n,e){let t=null,i=null;return Array.isArray(e)&&e.length?(t=Gx(e[0]),e.length>1&&(i=Gx(e[e.length-1]))):e instanceof Map&&(t=Gx(e)),t||i?new Cre(n,t,i):null}(e,d);return new _2(e,d,c,h)}}let Ire=(()=>{class n extends dF{constructor(t,i){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(i.body,{id:"0",encapsulation:mi.None,styles:[],data:{animation:[]}})}build(t){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?fF(t):t;return v2(this._renderer,null,i,"register",[r]),new Rre(i,this._renderer)}}return n.\u0275fac=function(t){return new(t||n)(re(Tu),re(Ct))},n.\u0275prov=xe({token:n,factory:n.\u0275fac}),n})();class Rre extends Mte{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new Pre(this._id,e,t||{},this._renderer)}}class Pre{constructor(e,t,i,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return v2(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function v2(n,e,t,i,r){return n.setProperty(e,`@@${t}:${i}`,r)}const y2="@.disabled";let Lre=(()=>{class n{constructor(t,i,r){this.delegate=t,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(s,o)=>{const a=o?.parentNode(s);a&&o.removeChild(a,s)}}createRenderer(t,i){const s=this.delegate.createRenderer(t,i);if(!(t&&i&&i.data&&i.data.animation)){let u=this._rendererCache.get(s);return u||(u=new b2("",s,this.engine,()=>this._rendererCache.delete(s)),this._rendererCache.set(s,u)),u}const o=i.id,a=i.id+"-"+this._currentId;this._currentId++,this.engine.register(a,t);const c=u=>{Array.isArray(u)?u.forEach(c):this.engine.registerTrigger(o,a,t,u.name,u)};return i.data.animation.forEach(c),new Nre(this,a,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,i,r){t>=0&&t<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(t){return new(t||n)(re(Tu),re(Gg),re(at))},n.\u0275prov=xe({token:n,factory:n.\u0275fac}),n})();class b2{constructor(e,t,i,r){this.namespaceId=e,this.delegate=t,this.engine=i,this._onDestroy=r,this.destroyNode=this.delegate.destroyNode?s=>t.destroyNode(s):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i,r=!0){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate,i)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,r){this.delegate.setAttribute(e,t,i,r)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,r){this.delegate.setStyle(e,t,i,r)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){"@"==t.charAt(0)&&t==y2?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.delegate.listen(e,t,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class Nre extends b2{constructor(e,t,i,r,s){super(t,i,r,s),this.factory=e,this.namespaceId=t}setProperty(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==y2?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.slice(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i){if("@"==t.charAt(0)){const r=function Ore(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let s=t.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function Fre(n){const e=n.indexOf(".");return[n.substring(0,e),n.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(e,t,i)}}const w2=[{provide:dF,useClass:Ire},{provide:kx,useFactory:function Ure(){return new ire}},{provide:Gg,useClass:(()=>{class n extends Gg{constructor(t,i,r,s){super(t.body,i,r)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(t){return new(t||n)(re(Ct),re(Tx),re(kx),re(na))},n.\u0275prov=xe({token:n,factory:n.\u0275fac}),n})()},{provide:Tu,useFactory:function Bre(n,e,t){return new Lre(n,e,t)},deps:[x0,Gg,at]}],Wx=[{provide:Tx,useFactory:()=>new Dre},{provide:_c,useValue:"BrowserAnimations"},...w2],x2=[{provide:Tx,useClass:YF},{provide:_c,useValue:"NoopAnimations"},...w2];let Vre=(()=>{class n{static withConfig(t){return{ngModule:n,providers:t.disableAnimations?x2:Wx}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=zn({providers:Wx,imports:[L1]}),n})(),zre=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n,bootstrap:[jne]}),n.\u0275inj=zn({imports:[L1,QQ,Vre,kte,Sne,Bne,cne]}),n})();zj().bootstrapModule(zre).catch(n=>console.error(n))}},vt=>{vt(vt.s=988)}]);